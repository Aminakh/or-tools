<!-- Good morning, Mr. Phelps. -->
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <title>or-tools/constraint_solver/constraint_solver.cc Source File - Doxy</title>
    <link rel="shortcut icon" href="../../favicon.ico">
    <!-- Both stylesheets are supplied by Doxygen, with maybe minor tweaks from Google. -->
    <link href="../../doxygen.css" rel="stylesheet" type="text/css">
    <link href="../../tabs.css" rel="stylesheet" type="text/css">
  </head>

  <body topmargin=0 leftmargin=20 bottommargin=0 rightmargin=20 marginwidth=20 marginheight=0>
  <!-- Second part of the secret behind Doxy logo always having the word "Doxy" with the color of the day. -->
  <style>
    a.doxy_logo:hover {
      background-color: #785251
    }
  </style>

  <table width=100% cellpadding=0 cellspacing=0 border=0>
    <!-- Top horizontal line with the color of the day. -->
    <tr valign=top>
      <td colspan=3 bgcolor=#785251 height=3></td>
    </tr>

    <!-- Header row with the links at the right. -->
    <tr valign=top>
      <td colspan=3 align=right>
        <font size=-1>
          Generated on: <font color=#785251><b>Thu Nov  3 05:40:09 PDT 2011</b></font>
            for <b>custom file set</b>
        </font>
      </td>
    </tr>

    <!-- Header row with the logo and the search form. -->
    <tr valign=top>
      <!-- Logo. -->
      <td align=left width=150>
        <table width=150 height=54 cellpadding=0 cellspacing=0 border=0>
          <tr valign=top>
            <!-- First part of the secret behind Doxy logo always having the word "Doxy" with the color of the day. -->
            <td bgcolor=#785251>
              <a class="doxy_logo" href="../../index.html"><img src="../../doxy_logo.png" alt="Doxy" border=0></a>
            </td>
          </tr>
        </table>
      </td>
    </tr>

    <!-- Tiny vertical space below the form. -->
    <tr valign=top>
      <td colspan=3 height=3></td>
    </tr>
  </table>

  <!-- Header navigation row. -->
  <div class="memproto">
    <table width=100% cellpadding=0 cellspacing=0 border=0>
      <tr>
        <td align=left style="padding-left: 20px"><font size=+1><b><tt><font color=#333333>//
            <a href="../../index.html"><font color=#785251>doxy</font></a>/</font>
            <a href="../../or-tools/index.html">or-tools</a>/
            <a href="../../or-tools/constraint_solver/index.html">constraint_solver</a>/
            </tt></b></font>
        </td>
      </tr>
    </table>
  </div>
  <br />
    <!-- No subdirs found. -->
  <!-- End of header. -->
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<h1>or-tools/constraint_solver/constraint_solver.cc</h1><a href="constraint__solver_8cc.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// Copyright 2010-2011 Google</span>
<a name="l00002"></a>00002 <span class="comment">// Licensed under the Apache License, Version 2.0 (the "License");</span>
<a name="l00003"></a>00003 <span class="comment">// you may not use this file except in compliance with the License.</span>
<a name="l00004"></a>00004 <span class="comment">// You may obtain a copy of the License at</span>
<a name="l00005"></a>00005 <span class="comment">//</span>
<a name="l00006"></a>00006 <span class="comment">//     http://www.apache.org/licenses/LICENSE-2.0</span>
<a name="l00007"></a>00007 <span class="comment">//</span>
<a name="l00008"></a>00008 <span class="comment">// Unless required by applicable law or agreed to in writing, software</span>
<a name="l00009"></a>00009 <span class="comment">// distributed under the License is distributed on an "AS IS" BASIS,</span>
<a name="l00010"></a>00010 <span class="comment">// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<a name="l00011"></a>00011 <span class="comment">// See the License for the specific language governing permissions and</span>
<a name="l00012"></a>00012 <span class="comment">// limitations under the License.</span>
<a name="l00013"></a>00013 <span class="comment">//</span>
<a name="l00014"></a>00014 <span class="comment">// This file implements the core objects of the constraint solver:</span>
<a name="l00015"></a>00015 <span class="comment">// Solver, Search, Queue, ... along with the main resolution loop.</span>
<a name="l00016"></a>00016 
<a name="l00017"></a>00017 <span class="preprocessor">#include "<a class="code" href="constraint__solver_8h.html">constraint_solver/constraint_solver.h</a>"</span>
<a name="l00018"></a>00018 
<a name="l00019"></a>00019 <span class="preprocessor">#include &lt;setjmp.h&gt;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &lt;iosfwd&gt;</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include "base/callback.h"</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include "base/commandlineflags.h"</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include "base/integral_types.h"</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include "base/logging.h"</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include "base/macros.h"</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include "base/scoped_ptr.h"</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include "base/stringprintf.h"</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include "base/file.h"</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include "base/recordio.h"</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include "base/stringpiece.h"</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include "zlib.h"</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include "base/concise_iterator.h"</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include "base/map-util.h"</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include "<a class="code" href="constraint__solveri_8h.html">constraint_solver/constraint_solveri.h</a>"</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include "constraint_solver/model.pb.h"</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include "util/const_int_array.h"</span>
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 <a class="code" href="constraint__solver_8cc.html#0bc4cb4a7755f6e45514113e6d9f393f" title="Licensed under the Apache License, Version 2.0 (the &amp;quot;License&amp;quot;); you may...">DEFINE_bool</a>(cp_trace_demons, <span class="keyword">false</span>, <span class="stringliteral">"trace all demon executions."</span>);
<a name="l00041"></a>00041 <a class="code" href="constraint__solver_8cc.html#0bc4cb4a7755f6e45514113e6d9f393f" title="Licensed under the Apache License, Version 2.0 (the &amp;quot;License&amp;quot;); you may...">DEFINE_bool</a>(cp_show_constraints, <span class="keyword">false</span>,
<a name="l00042"></a>00042             <span class="stringliteral">"show all constraints added to the solver."</span>);
<a name="l00043"></a>00043 <a class="code" href="constraint__solver_8cc.html#0bc4cb4a7755f6e45514113e6d9f393f" title="Licensed under the Apache License, Version 2.0 (the &amp;quot;License&amp;quot;); you may...">DEFINE_bool</a>(cp_print_model, <span class="keyword">false</span>,
<a name="l00044"></a>00044             <span class="stringliteral">"use PrintModelVisitor on model before solving."</span>);
<a name="l00045"></a>00045 <a class="code" href="constraint__solver_8cc.html#0bc4cb4a7755f6e45514113e6d9f393f" title="Licensed under the Apache License, Version 2.0 (the &amp;quot;License&amp;quot;); you may...">DEFINE_bool</a>(cp_model_stats, <span class="keyword">false</span>,
<a name="l00046"></a>00046             <span class="stringliteral">"use StatisticsModelVisitor on model before solving."</span>);
<a name="l00047"></a>00047 <a class="code" href="constraint__solver_8cc.html#fdb7c9c90654efc5e495f1b1cd3aa7ac">DEFINE_string</a>(cp_export_file, <span class="stringliteral">""</span>, <span class="stringliteral">"Export model to file using CPModelProto."</span>);
<a name="l00048"></a>00048 <a class="code" href="constraint__solver_8cc.html#0bc4cb4a7755f6e45514113e6d9f393f" title="Licensed under the Apache License, Version 2.0 (the &amp;quot;License&amp;quot;); you may...">DEFINE_bool</a>(cp_no_solve, <span class="keyword">false</span>, <span class="stringliteral">"Force failure at the beginning of a search."</span>);
<a name="l00049"></a>00049 <a class="code" href="constraint__solver_8cc.html#fdb7c9c90654efc5e495f1b1cd3aa7ac">DEFINE_string</a>(cp_profile_file, <span class="stringliteral">""</span>, <span class="stringliteral">"Export profiling overview to file."</span>);
<a name="l00050"></a>00050 <a class="code" href="constraint__solver_8cc.html#0bc4cb4a7755f6e45514113e6d9f393f" title="Licensed under the Apache License, Version 2.0 (the &amp;quot;License&amp;quot;); you may...">DEFINE_bool</a>(cp_verbose_fail, <span class="keyword">false</span>, <span class="stringliteral">"Verbose output when failing"</span>);
<a name="l00051"></a>00051 
<a name="l00052"></a><a class="code" href="constraint__solver_8cc.html#c13a1be8287ff935b4a93be3cc716e79">00052</a> <span class="keywordtype">void</span> <a class="code" href="constraint__solver_8cc.html#c13a1be8287ff935b4a93be3cc716e79">ConstraintSolverFailsHere</a>() {
<a name="l00053"></a>00053   VLOG(3) &lt;&lt; <span class="stringliteral">"Fail"</span>;
<a name="l00054"></a>00054 }
<a name="l00055"></a>00055 
<a name="l00056"></a>00056 <span class="preprocessor">#if defined(_MSC_VER)  // WINDOWS</span>
<a name="l00057"></a>00057 <span class="preprocessor"></span><span class="preprocessor">#pragma warning(disable : 4351 4355)</span>
<a name="l00058"></a>00058 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00059"></a>00059 <span class="preprocessor"></span>
<a name="l00060"></a>00060 <span class="keyword">namespace </span>operations_research {
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 <span class="comment">// ----- SolverParameters -----</span>
<a name="l00063"></a>00063 
<a name="l00064"></a><a class="code" href="structoperations__research_1_1SolverParameters.html#96250ef7c8113b78cc680d7cc66cd3d0">00064</a> <a class="code" href="structoperations__research_1_1SolverParameters.html#96250ef7c8113b78cc680d7cc66cd3d0" title="SolverParameters.">SolverParameters::SolverParameters</a>()
<a name="l00065"></a>00065     : compress_trail(kDefaultTrailCompression),
<a name="l00066"></a>00066       trail_block_size(kDefaultTrailBlockSize),
<a name="l00067"></a>00067       array_split_size(kDefaultArraySplitSize),
<a name="l00068"></a>00068       store_names(kDefaultNameStoring),
<a name="l00069"></a>00069       profile_level(kDefaultProfileLevel) {}
<a name="l00070"></a>00070 
<a name="l00071"></a>00071 <span class="comment">// ----- Forward Declarations and Profiling Support -----</span>
<a name="l00072"></a>00072 <span class="keyword">extern</span> <a class="code" href="classoperations__research_1_1DemonMonitor.html" title="DemonMonitor manages the profiling of demons and allows access to gathered data.">DemonMonitor</a>* <a class="code" href="namespaceoperations__research.html#c0839cdc9649d88a73060cfde2038b3e" title="Forward Declarations and Profiling Support.">BuildDemonMonitor</a>(<a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> solver);
<a name="l00073"></a>00073 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="namespaceoperations__research.html#c7e3e4722c51d781636e24d843c0e542">DeleteDemonMonitor</a>(<a class="code" href="classoperations__research_1_1DemonMonitor.html" title="DemonMonitor manages the profiling of demons and allows access to gathered data.">DemonMonitor</a>* <span class="keyword">const</span> monitor);
<a name="l00074"></a>00074 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="namespaceoperations__research.html#b5240e8c0ba682f97baea46641082c70">DemonMonitorStartInitialPropagation</a>(
<a name="l00075"></a>00075     <a class="code" href="classoperations__research_1_1DemonMonitor.html" title="DemonMonitor manages the profiling of demons and allows access to gathered data.">DemonMonitor</a>* <span class="keyword">const</span> monitor, <span class="keyword">const</span> <a class="code" href="classoperations__research_1_1Constraint.html" title="A constraint is the main modeling object.">Constraint</a>* <span class="keyword">const</span> constraint);
<a name="l00076"></a>00076 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="namespaceoperations__research.html#aa11d663f99a1dda5d5228aaf3014602">DemonMonitorEndInitialPropagation</a>(
<a name="l00077"></a>00077     <a class="code" href="classoperations__research_1_1DemonMonitor.html" title="DemonMonitor manages the profiling of demons and allows access to gathered data.">DemonMonitor</a>* <span class="keyword">const</span> monitor, <span class="keyword">const</span> <a class="code" href="classoperations__research_1_1Constraint.html" title="A constraint is the main modeling object.">Constraint</a>* <span class="keyword">const</span> constraint);
<a name="l00078"></a>00078 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="namespaceoperations__research.html#2d60edc96e40e663962f32ffa4685ec6">DemonMonitorRestartSearch</a>(<a class="code" href="classoperations__research_1_1DemonMonitor.html" title="DemonMonitor manages the profiling of demons and allows access to gathered data.">DemonMonitor</a>* <span class="keyword">const</span> monitor);
<a name="l00079"></a>00079 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="namespaceoperations__research.html#70ceefb1ec146ec849dc8babf6fc7286">DemonMonitorStartInitialNestedPropagation</a>(
<a name="l00080"></a>00080     <a class="code" href="classoperations__research_1_1DemonMonitor.html" title="DemonMonitor manages the profiling of demons and allows access to gathered data.">DemonMonitor</a>* <span class="keyword">const</span> monitor,
<a name="l00081"></a>00081     <span class="keyword">const</span> <a class="code" href="classoperations__research_1_1Constraint.html" title="A constraint is the main modeling object.">Constraint</a>* <span class="keyword">const</span> parent,
<a name="l00082"></a>00082     <span class="keyword">const</span> <a class="code" href="classoperations__research_1_1Constraint.html" title="A constraint is the main modeling object.">Constraint</a>* <span class="keyword">const</span> nested);
<a name="l00083"></a>00083 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="namespaceoperations__research.html#ae54e5a5cdc80f0f8d63675197f99665">DemonMonitorEndInitialNestedPropagation</a>(
<a name="l00084"></a>00084     <a class="code" href="classoperations__research_1_1DemonMonitor.html" title="DemonMonitor manages the profiling of demons and allows access to gathered data.">DemonMonitor</a>* <span class="keyword">const</span> monitor,
<a name="l00085"></a>00085     <span class="keyword">const</span> <a class="code" href="classoperations__research_1_1Constraint.html" title="A constraint is the main modeling object.">Constraint</a>* <span class="keyword">const</span> parent,
<a name="l00086"></a>00086     <span class="keyword">const</span> <a class="code" href="classoperations__research_1_1Constraint.html" title="A constraint is the main modeling object.">Constraint</a>* <span class="keyword">const</span> nested);
<a name="l00087"></a>00087 
<a name="l00088"></a><a class="code" href="classoperations__research_1_1Solver.html#156b32cc07fa9ae5fde5e3a9ee907a4d">00088</a> <span class="keywordtype">bool</span> Solver::Profile()<span class="keyword"> const </span>{
<a name="l00089"></a>00089   <span class="keywordflow">return</span> parameters_.<a class="code" href="structoperations__research_1_1SolverParameters.html#8fe1248f3b6a31d68cb718a961ea4a06" title="Support for profiling propagation.">profile_level</a> != <a class="code" href="structoperations__research_1_1SolverParameters.html#bb1b746ad99155bea2d44ba46db0718723a03d3fac4ba780d9caa8ae38f5dea9">SolverParameters::NO_PROFILING</a> ||
<a name="l00090"></a>00090       !FLAGS_cp_profile_file.empty();
<a name="l00091"></a>00091 }
<a name="l00092"></a>00092 
<a name="l00093"></a>00093 <span class="comment">// ------------------ Demon class ----------------</span>
<a name="l00094"></a>00094 
<a name="l00095"></a><a class="code" href="classoperations__research_1_1Demon.html#b7daa02f7052c9a43c64561c9d291605">00095</a> <a class="code" href="classoperations__research_1_1Solver.html#4b0972c731faf884eba5acab99ebb2b4">Solver::DemonPriority</a> <a class="code" href="classoperations__research_1_1Demon.html#b7daa02f7052c9a43c64561c9d291605" title="This method returns the priority of the demon.">Demon::priority</a>()<span class="keyword"> const </span>{
<a name="l00096"></a>00096   <span class="keywordflow">return</span> <a class="code" href="classoperations__research_1_1Solver.html#4b0972c731faf884eba5acab99ebb2b44f432957a8b27277538d5ee856201a4c">Solver::NORMAL_PRIORITY</a>;
<a name="l00097"></a>00097 }
<a name="l00098"></a>00098 
<a name="l00099"></a><a class="code" href="classoperations__research_1_1Demon.html#d426e69437928dfa0096525369aead1c">00099</a> <span class="keywordtype">string</span> <a class="code" href="classoperations__research_1_1Demon.html#d426e69437928dfa0096525369aead1c">Demon::DebugString</a>()<span class="keyword"> const </span>{
<a name="l00100"></a>00100   <span class="keywordflow">return</span> <span class="stringliteral">"Demon"</span>;
<a name="l00101"></a>00101 }
<a name="l00102"></a>00102 
<a name="l00103"></a><a class="code" href="classoperations__research_1_1Demon.html#4e51b1b49f9a937b335cd9381f95614d">00103</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Demon.html#4e51b1b49f9a937b335cd9381f95614d" title="This method inhibits the demon in the search tree below the current position.">Demon::inhibit</a>(<a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> s) {
<a name="l00104"></a>00104   <span class="keywordflow">if</span> (stamp_ &lt; kuint64max) {
<a name="l00105"></a>00105     s-&gt;<a class="code" href="classoperations__research_1_1Solver.html#fca376d8b0abd52b94534112442f1614" title="All-in-one SaveAndSetValue.">SaveAndSetValue</a>(&amp;stamp_, kuint64max);
<a name="l00106"></a>00106   }
<a name="l00107"></a>00107 }
<a name="l00108"></a>00108 
<a name="l00109"></a><a class="code" href="classoperations__research_1_1Demon.html#e63a7d849eb2b518ac708c736c670f9c">00109</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Demon.html#e63a7d849eb2b518ac708c736c670f9c" title="This method un-inhibit the demon that was inhibited.">Demon::desinhibit</a>(<a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> s) {
<a name="l00110"></a>00110   <span class="keywordflow">if</span> (stamp_ == kuint64max) {
<a name="l00111"></a>00111     s-&gt;<a class="code" href="classoperations__research_1_1Solver.html#fca376d8b0abd52b94534112442f1614" title="All-in-one SaveAndSetValue.">SaveAndSetValue</a>(&amp;stamp_, s-&gt;<a class="code" href="classoperations__research_1_1Solver.html#f17dc31a0a12a7c6c9c09a8a8e2d94e4" title="The stamp indicates how many moves in the search tree we have performed.">stamp</a>() - 1);
<a name="l00112"></a>00112   }
<a name="l00113"></a>00113 }
<a name="l00114"></a>00114 
<a name="l00115"></a>00115 <span class="comment">// ------------------ Action class ------------------</span>
<a name="l00116"></a>00116 
<a name="l00117"></a><a class="code" href="classoperations__research_1_1Action.html#47ea9f9072ca2eb9861b92858c38e11f">00117</a> <span class="keywordtype">string</span> <a class="code" href="classoperations__research_1_1Action.html#47ea9f9072ca2eb9861b92858c38e11f" title="Action class.">Action::DebugString</a>()<span class="keyword"> const </span>{
<a name="l00118"></a>00118   <span class="keywordflow">return</span> <span class="stringliteral">"Action"</span>;
<a name="l00119"></a>00119 }
<a name="l00120"></a>00120 
<a name="l00121"></a>00121 <span class="comment">// ------------------ Queue class ------------------</span>
<a name="l00122"></a>00122 
<a name="l00123"></a>00123 <span class="keyword">namespace </span>{
<a name="l00124"></a>00124 <span class="keyword">class </span>SinglePriorityQueue {
<a name="l00125"></a>00125  <span class="keyword">public</span>:
<a name="l00126"></a>00126   <span class="keyword">virtual</span> ~SinglePriorityQueue() {}
<a name="l00127"></a>00127   <span class="keyword">virtual</span> Demon* NextDemon() = 0;
<a name="l00128"></a>00128   <span class="keyword">virtual</span> <span class="keywordtype">void</span> Enqueue(Demon* <span class="keyword">const</span> d) = 0;
<a name="l00129"></a>00129   <span class="keyword">virtual</span> <span class="keywordtype">void</span> AfterFailure() = 0;
<a name="l00130"></a>00130   <span class="keyword">virtual</span> <span class="keywordtype">void</span> Init() = 0;
<a name="l00131"></a>00131   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> Empty() <span class="keyword">const</span> = 0;
<a name="l00132"></a>00132 };
<a name="l00133"></a>00133 
<a name="l00134"></a>00134 <span class="keyword">class </span>FifoPriorityQueue : <span class="keyword">public</span> SinglePriorityQueue {
<a name="l00135"></a>00135  <span class="keyword">public</span>:
<a name="l00136"></a>00136   <span class="keyword">struct </span>Cell {
<a name="l00137"></a>00137     <span class="keyword">explicit</span> Cell(Demon* <span class="keyword">const</span> d) : <a class="code" href="constraint__solver_8cc.html#f800ac63ce2b6285ec62408b0f17acc3">demon</a>(d), <a class="code" href="constraint__solver_8cc.html#395f613555f398dd389670bb4c2a4599">next</a>(NULL) {}
<a name="l00138"></a><a class="code" href="constraint__solver_8cc.html#f800ac63ce2b6285ec62408b0f17acc3">00138</a>     Demon* <a class="code" href="constraint__solver_8cc.html#f800ac63ce2b6285ec62408b0f17acc3">demon</a>;
<a name="l00139"></a><a class="code" href="constraint__solver_8cc.html#395f613555f398dd389670bb4c2a4599">00139</a>     Cell* <a class="code" href="constraint__solver_8cc.html#395f613555f398dd389670bb4c2a4599">next</a>;
<a name="l00140"></a>00140   };
<a name="l00141"></a>00141 
<a name="l00142"></a>00142   FifoPriorityQueue() : <a class="code" href="constraint__solver_8cc.html#521cf1d39e05e38857d52dca43a9270e">first_</a>(NULL), <a class="code" href="constraint__solver_8cc.html#4a265269d82faeacc90eef4f9668cdbb">last_</a>(NULL), <a class="code" href="constraint__solver_8cc.html#cdc8f06d37bf2c6c4e92039b36813918">free_cells_</a>(NULL) {}
<a name="l00143"></a>00143 
<a name="l00144"></a>00144   <span class="keyword">virtual</span> ~FifoPriorityQueue() {
<a name="l00145"></a>00145     <span class="keywordflow">while</span> (<a class="code" href="constraint__solver_8cc.html#521cf1d39e05e38857d52dca43a9270e">first_</a> != NULL) {
<a name="l00146"></a>00146       Cell* <span class="keyword">const</span> tmp = <a class="code" href="constraint__solver_8cc.html#521cf1d39e05e38857d52dca43a9270e">first_</a>;
<a name="l00147"></a>00147       <a class="code" href="constraint__solver_8cc.html#521cf1d39e05e38857d52dca43a9270e">first_</a> = tmp-&gt;next;
<a name="l00148"></a>00148       <span class="keyword">delete</span> tmp;
<a name="l00149"></a>00149     }
<a name="l00150"></a>00150     <span class="keywordflow">while</span> (<a class="code" href="constraint__solver_8cc.html#cdc8f06d37bf2c6c4e92039b36813918">free_cells_</a> != NULL) {
<a name="l00151"></a>00151       Cell* <span class="keyword">const</span> tmp = <a class="code" href="constraint__solver_8cc.html#cdc8f06d37bf2c6c4e92039b36813918">free_cells_</a>;
<a name="l00152"></a>00152       <a class="code" href="constraint__solver_8cc.html#cdc8f06d37bf2c6c4e92039b36813918">free_cells_</a> = tmp-&gt;next;
<a name="l00153"></a>00153       <span class="keyword">delete</span> tmp;
<a name="l00154"></a>00154     }
<a name="l00155"></a>00155   }
<a name="l00156"></a>00156 
<a name="l00157"></a>00157   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> Empty()<span class="keyword"> const </span>{
<a name="l00158"></a>00158     <span class="keywordflow">return</span> <a class="code" href="constraint__solver_8cc.html#521cf1d39e05e38857d52dca43a9270e">first_</a> == NULL;
<a name="l00159"></a>00159   }
<a name="l00160"></a>00160 
<a name="l00161"></a>00161   <span class="keyword">virtual</span> Demon* NextDemon() {
<a name="l00162"></a>00162     <span class="keywordflow">if</span> (<a class="code" href="constraint__solver_8cc.html#521cf1d39e05e38857d52dca43a9270e">first_</a> != NULL) {
<a name="l00163"></a>00163       DCHECK(<a class="code" href="constraint__solver_8cc.html#4a265269d82faeacc90eef4f9668cdbb">last_</a> != NULL);
<a name="l00164"></a>00164       Cell* <span class="keyword">const</span> tmp_cell = <a class="code" href="constraint__solver_8cc.html#521cf1d39e05e38857d52dca43a9270e">first_</a>;
<a name="l00165"></a>00165       Demon* <span class="keyword">const</span> <a class="code" href="constraint__solver_8cc.html#f800ac63ce2b6285ec62408b0f17acc3">demon</a> = tmp_cell-&gt;demon;
<a name="l00166"></a>00166       <a class="code" href="constraint__solver_8cc.html#521cf1d39e05e38857d52dca43a9270e">first_</a> = tmp_cell-&gt;next;
<a name="l00167"></a>00167       <span class="keywordflow">if</span> (<a class="code" href="constraint__solver_8cc.html#521cf1d39e05e38857d52dca43a9270e">first_</a> == NULL) {
<a name="l00168"></a>00168         <a class="code" href="constraint__solver_8cc.html#4a265269d82faeacc90eef4f9668cdbb">last_</a> = NULL;
<a name="l00169"></a>00169       }
<a name="l00170"></a>00170       tmp_cell-&gt;next = <a class="code" href="constraint__solver_8cc.html#cdc8f06d37bf2c6c4e92039b36813918">free_cells_</a>;
<a name="l00171"></a>00171       <a class="code" href="constraint__solver_8cc.html#cdc8f06d37bf2c6c4e92039b36813918">free_cells_</a> = tmp_cell;
<a name="l00172"></a>00172       <span class="keywordflow">return</span> demon;
<a name="l00173"></a>00173     }
<a name="l00174"></a>00174     <span class="keywordflow">return</span> NULL;
<a name="l00175"></a>00175   }
<a name="l00176"></a>00176 
<a name="l00177"></a>00177   <span class="keyword">virtual</span> <span class="keywordtype">void</span> Enqueue(Demon* <span class="keyword">const</span> d) {
<a name="l00178"></a>00178     Cell* cell = <a class="code" href="constraint__solver_8cc.html#cdc8f06d37bf2c6c4e92039b36813918">free_cells_</a>;
<a name="l00179"></a>00179     <span class="keywordflow">if</span> (cell != NULL) {
<a name="l00180"></a>00180       cell-&gt;demon = d;
<a name="l00181"></a>00181       <a class="code" href="constraint__solver_8cc.html#cdc8f06d37bf2c6c4e92039b36813918">free_cells_</a> = cell-&gt;next;
<a name="l00182"></a>00182       cell-&gt;next = NULL;
<a name="l00183"></a>00183     } <span class="keywordflow">else</span> {
<a name="l00184"></a>00184       cell = <span class="keyword">new</span> Cell(d);
<a name="l00185"></a>00185     }
<a name="l00186"></a>00186     <span class="keywordflow">if</span> (<a class="code" href="constraint__solver_8cc.html#4a265269d82faeacc90eef4f9668cdbb">last_</a> != NULL) {
<a name="l00187"></a>00187       <a class="code" href="constraint__solver_8cc.html#4a265269d82faeacc90eef4f9668cdbb">last_</a>-&gt;next = cell;
<a name="l00188"></a>00188       <a class="code" href="constraint__solver_8cc.html#4a265269d82faeacc90eef4f9668cdbb">last_</a> = cell;
<a name="l00189"></a>00189     } <span class="keywordflow">else</span> {
<a name="l00190"></a>00190       <a class="code" href="constraint__solver_8cc.html#521cf1d39e05e38857d52dca43a9270e">first_</a> = cell;
<a name="l00191"></a>00191       <a class="code" href="constraint__solver_8cc.html#4a265269d82faeacc90eef4f9668cdbb">last_</a> = cell;
<a name="l00192"></a>00192     }
<a name="l00193"></a>00193   }
<a name="l00194"></a>00194 
<a name="l00195"></a>00195   <span class="keyword">virtual</span> <span class="keywordtype">void</span> AfterFailure() {
<a name="l00196"></a>00196     <span class="keywordflow">if</span> (<a class="code" href="constraint__solver_8cc.html#521cf1d39e05e38857d52dca43a9270e">first_</a> != NULL) {
<a name="l00197"></a>00197       <a class="code" href="constraint__solver_8cc.html#4a265269d82faeacc90eef4f9668cdbb">last_</a>-&gt;next = <a class="code" href="constraint__solver_8cc.html#cdc8f06d37bf2c6c4e92039b36813918">free_cells_</a>;
<a name="l00198"></a>00198       <a class="code" href="constraint__solver_8cc.html#cdc8f06d37bf2c6c4e92039b36813918">free_cells_</a> = <a class="code" href="constraint__solver_8cc.html#521cf1d39e05e38857d52dca43a9270e">first_</a>;
<a name="l00199"></a>00199       <a class="code" href="constraint__solver_8cc.html#521cf1d39e05e38857d52dca43a9270e">first_</a> = NULL;
<a name="l00200"></a>00200       <a class="code" href="constraint__solver_8cc.html#4a265269d82faeacc90eef4f9668cdbb">last_</a> = NULL;
<a name="l00201"></a>00201     }
<a name="l00202"></a>00202   }
<a name="l00203"></a>00203 
<a name="l00204"></a>00204   <span class="keyword">virtual</span> <span class="keywordtype">void</span> Init() {}
<a name="l00205"></a>00205 
<a name="l00206"></a>00206  <span class="keyword">private</span>:
<a name="l00207"></a><a class="code" href="constraint__solver_8cc.html#521cf1d39e05e38857d52dca43a9270e">00207</a>   Cell* <a class="code" href="constraint__solver_8cc.html#521cf1d39e05e38857d52dca43a9270e">first_</a>;
<a name="l00208"></a><a class="code" href="constraint__solver_8cc.html#4a265269d82faeacc90eef4f9668cdbb">00208</a>   Cell* <a class="code" href="constraint__solver_8cc.html#4a265269d82faeacc90eef4f9668cdbb">last_</a>;
<a name="l00209"></a><a class="code" href="constraint__solver_8cc.html#cdc8f06d37bf2c6c4e92039b36813918">00209</a>   Cell* <a class="code" href="constraint__solver_8cc.html#cdc8f06d37bf2c6c4e92039b36813918">free_cells_</a>;
<a name="l00210"></a>00210 };
<a name="l00211"></a>00211 }  <span class="comment">// namespace</span>
<a name="l00212"></a>00212 
<a name="l00213"></a><a class="code" href="classoperations__research_1_1Queue.html">00213</a> <span class="keyword">class </span><a class="code" href="classoperations__research_1_1Queue.html" title="namespace">Queue</a> {
<a name="l00214"></a>00214  <span class="keyword">public</span>:
<a name="l00215"></a><a class="code" href="classoperations__research_1_1Queue.html#79c358dddeddaa821396f96cab72a07b">00215</a>   <span class="keyword">explicit</span> <a class="code" href="classoperations__research_1_1Queue.html" title="namespace">Queue</a>(<a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> s)
<a name="l00216"></a>00216       : <a class="code" href="dependency__graph_8cc.html#bd6bfbf6753a5deb0ce273fad6408e1e">solver_</a>(s),
<a name="l00217"></a>00217         <a class="code" href="alldiff__cst_8cc.html#1ab3854946bf086fbb0971cc82516104">stamp_</a>(1),
<a name="l00218"></a>00218         freeze_level_(0),
<a name="l00219"></a>00219         <a class="code" href="dependency__graph_8cc.html#3c556bc2d9f39f48c121b6222892ef2f">in_process_</a>(false),
<a name="l00220"></a>00220         clear_action_(NULL),
<a name="l00221"></a>00221         in_add_(false) {
<a name="l00222"></a>00222     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classoperations__research_1_1Solver.html#d4faf53cefb2c2cdb8892b978a4b93a9" title="Number of priorities for demons.">Solver::kNumPriorities</a>; ++i) {
<a name="l00223"></a>00223       containers_[i] = <span class="keyword">new</span> FifoPriorityQueue();
<a name="l00224"></a>00224       containers_[i]-&gt;Init();
<a name="l00225"></a>00225     }
<a name="l00226"></a>00226   }
<a name="l00227"></a>00227 
<a name="l00228"></a><a class="code" href="classoperations__research_1_1Queue.html#8701f7d8435259101fcb47741387dfd5">00228</a>   ~<a class="code" href="classoperations__research_1_1Queue.html" title="namespace">Queue</a>() {
<a name="l00229"></a>00229     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classoperations__research_1_1Solver.html#d4faf53cefb2c2cdb8892b978a4b93a9" title="Number of priorities for demons.">Solver::kNumPriorities</a>; ++i) {
<a name="l00230"></a>00230       <span class="keyword">delete</span> containers_[i];
<a name="l00231"></a>00231       containers_[i] = NULL;
<a name="l00232"></a>00232     }
<a name="l00233"></a>00233   }
<a name="l00234"></a>00234 
<a name="l00235"></a><a class="code" href="classoperations__research_1_1Queue.html#ac21361cb6eedd26710bf86e5066ca0d">00235</a>   <span class="keywordtype">void</span> Freeze() {
<a name="l00236"></a>00236     freeze_level_++;
<a name="l00237"></a>00237     <a class="code" href="alldiff__cst_8cc.html#1ab3854946bf086fbb0971cc82516104">stamp_</a>++;
<a name="l00238"></a>00238   }
<a name="l00239"></a>00239 
<a name="l00240"></a><a class="code" href="classoperations__research_1_1Queue.html#c78f07b0fe8b17af9c5575118a8f900c">00240</a>   <span class="keywordtype">void</span> Unfreeze() {
<a name="l00241"></a>00241     freeze_level_--;
<a name="l00242"></a>00242     ProcessIfUnfrozen();
<a name="l00243"></a>00243   }
<a name="l00244"></a>00244 
<a name="l00245"></a><a class="code" href="classoperations__research_1_1Queue.html#6b155e084f5237feb1ad5140911537ee">00245</a>   <span class="keywordtype">void</span> ProcessOneDemon(<a class="code" href="classoperations__research_1_1Solver.html#4b0972c731faf884eba5acab99ebb2b4">Solver::DemonPriority</a> prio) {
<a name="l00246"></a>00246     <a class="code" href="classoperations__research_1_1Demon.html" title="A Demon is the base element of a propagation queue.">Demon</a>* <span class="keyword">const</span> <a class="code" href="constraint__solver_8cc.html#f800ac63ce2b6285ec62408b0f17acc3">demon</a> = containers_[prio]-&gt;NextDemon();
<a name="l00247"></a>00247     <span class="comment">// A NULL demon will just be ignored</span>
<a name="l00248"></a>00248     <span class="keywordflow">if</span> (demon != NULL) {
<a name="l00249"></a>00249       <span class="keywordflow">if</span> (FLAGS_cp_trace_demons) {
<a name="l00250"></a>00250         LG &lt;&lt; <span class="stringliteral">"### Running demon ("</span> &lt;&lt; prio &lt;&lt; <span class="stringliteral">"):"</span>
<a name="l00251"></a>00251            &lt;&lt; demon-&gt;<a class="code" href="classoperations__research_1_1Demon.html#d426e69437928dfa0096525369aead1c">DebugString</a>() &lt;&lt; <span class="stringliteral">" ###"</span>;
<a name="l00252"></a>00252       }
<a name="l00253"></a>00253       demon-&gt;<a class="code" href="classoperations__research_1_1Demon.html#614b0b652e620c4c7151d86f09dead55">set_stamp</a>(<a class="code" href="alldiff__cst_8cc.html#1ab3854946bf086fbb0971cc82516104">stamp_</a> - 1);
<a name="l00254"></a>00254       DCHECK_EQ(prio, demon-&gt;<a class="code" href="classoperations__research_1_1Demon.html#b7daa02f7052c9a43c64561c9d291605" title="This method returns the priority of the demon.">priority</a>());
<a name="l00255"></a>00255       <a class="code" href="dependency__graph_8cc.html#bd6bfbf6753a5deb0ce273fad6408e1e">solver_</a>-&gt;<a class="code" href="classoperations__research_1_1Solver.html#f55961702f23983ac14a3847afb72666">demon_runs_</a>[prio]++;
<a name="l00256"></a>00256       demon-&gt;<a class="code" href="classoperations__research_1_1Demon.html#7d3876bb3b369f0ae115e08ce9a6dc72" title="This is the main callback of the demon.">Run</a>(<a class="code" href="dependency__graph_8cc.html#bd6bfbf6753a5deb0ce273fad6408e1e">solver_</a>);
<a name="l00257"></a>00257     }
<a name="l00258"></a>00258   }
<a name="l00259"></a>00259 
<a name="l00260"></a><a class="code" href="classoperations__research_1_1Queue.html#d0529d4fa99e51d4bfd17974360cbc80">00260</a>   <span class="keywordtype">void</span> ProcessDemons() {
<a name="l00261"></a>00261     <span class="keywordflow">while</span> (!containers_[<a class="code" href="classoperations__research_1_1Solver.html#4b0972c731faf884eba5acab99ebb2b44f432957a8b27277538d5ee856201a4c">Solver::NORMAL_PRIORITY</a>]-&gt;Empty()) {
<a name="l00262"></a>00262       ProcessOneDemon(<a class="code" href="classoperations__research_1_1Solver.html#4b0972c731faf884eba5acab99ebb2b44f432957a8b27277538d5ee856201a4c">Solver::NORMAL_PRIORITY</a>);
<a name="l00263"></a>00263     }
<a name="l00264"></a>00264   }
<a name="l00265"></a>00265 
<a name="l00266"></a><a class="code" href="classoperations__research_1_1Queue.html#20418f62989173ee804f2a873c0123e2">00266</a>   <span class="keywordtype">void</span> Process() {
<a name="l00267"></a>00267     <span class="keywordflow">if</span> (!<a class="code" href="dependency__graph_8cc.html#3c556bc2d9f39f48c121b6222892ef2f">in_process_</a>) {
<a name="l00268"></a>00268       <a class="code" href="dependency__graph_8cc.html#3c556bc2d9f39f48c121b6222892ef2f">in_process_</a> = <span class="keyword">true</span>;
<a name="l00269"></a>00269       <span class="keywordflow">while</span> (!containers_[<a class="code" href="classoperations__research_1_1Solver.html#4b0972c731faf884eba5acab99ebb2b4e5f79fc80ef9ae665bcd7c0e55c02aa6">Solver::VAR_PRIORITY</a>]-&gt;Empty() ||
<a name="l00270"></a>00270              !containers_[<a class="code" href="classoperations__research_1_1Solver.html#4b0972c731faf884eba5acab99ebb2b44f432957a8b27277538d5ee856201a4c">Solver::NORMAL_PRIORITY</a>]-&gt;Empty() ||
<a name="l00271"></a>00271              !containers_[<a class="code" href="classoperations__research_1_1Solver.html#4b0972c731faf884eba5acab99ebb2b4f8769149902a8a2b168069cb93cc6370">Solver::DELAYED_PRIORITY</a>]-&gt;Empty()) {
<a name="l00272"></a>00272         <span class="keywordflow">while</span> (!containers_[<a class="code" href="classoperations__research_1_1Solver.html#4b0972c731faf884eba5acab99ebb2b4e5f79fc80ef9ae665bcd7c0e55c02aa6">Solver::VAR_PRIORITY</a>]-&gt;Empty() ||
<a name="l00273"></a>00273                !containers_[<a class="code" href="classoperations__research_1_1Solver.html#4b0972c731faf884eba5acab99ebb2b44f432957a8b27277538d5ee856201a4c">Solver::NORMAL_PRIORITY</a>]-&gt;Empty()) {
<a name="l00274"></a>00274           <span class="keywordflow">while</span> (!containers_[<a class="code" href="classoperations__research_1_1Solver.html#4b0972c731faf884eba5acab99ebb2b44f432957a8b27277538d5ee856201a4c">Solver::NORMAL_PRIORITY</a>]-&gt;Empty()) {
<a name="l00275"></a>00275             ProcessOneDemon(<a class="code" href="classoperations__research_1_1Solver.html#4b0972c731faf884eba5acab99ebb2b44f432957a8b27277538d5ee856201a4c">Solver::NORMAL_PRIORITY</a>);
<a name="l00276"></a>00276           }
<a name="l00277"></a>00277           ProcessOneDemon(<a class="code" href="classoperations__research_1_1Solver.html#4b0972c731faf884eba5acab99ebb2b4e5f79fc80ef9ae665bcd7c0e55c02aa6">Solver::VAR_PRIORITY</a>);
<a name="l00278"></a>00278         }
<a name="l00279"></a>00279         ProcessOneDemon(<a class="code" href="classoperations__research_1_1Solver.html#4b0972c731faf884eba5acab99ebb2b4f8769149902a8a2b168069cb93cc6370">Solver::DELAYED_PRIORITY</a>);
<a name="l00280"></a>00280       }
<a name="l00281"></a>00281       <a class="code" href="dependency__graph_8cc.html#3c556bc2d9f39f48c121b6222892ef2f">in_process_</a> = <span class="keyword">false</span>;
<a name="l00282"></a>00282     }
<a name="l00283"></a>00283   }
<a name="l00284"></a>00284 
<a name="l00285"></a><a class="code" href="classoperations__research_1_1Queue.html#39f395e16b4d8634c0d8ab12389d38f2">00285</a>   <span class="keywordtype">void</span> Enqueue(<a class="code" href="classoperations__research_1_1Demon.html" title="A Demon is the base element of a propagation queue.">Demon</a>* <span class="keyword">const</span> <a class="code" href="constraint__solver_8cc.html#f800ac63ce2b6285ec62408b0f17acc3">demon</a>) {
<a name="l00286"></a>00286     <span class="keywordflow">if</span> (demon-&gt;<a class="code" href="classoperations__research_1_1Demon.html#135f1e1a1e8e2901d2e095b50d439650">stamp</a>() &lt; <a class="code" href="alldiff__cst_8cc.html#1ab3854946bf086fbb0971cc82516104">stamp_</a>) {
<a name="l00287"></a>00287       demon-&gt;<a class="code" href="classoperations__research_1_1Demon.html#614b0b652e620c4c7151d86f09dead55">set_stamp</a>(<a class="code" href="alldiff__cst_8cc.html#1ab3854946bf086fbb0971cc82516104">stamp_</a>);
<a name="l00288"></a>00288       containers_[demon-&gt;<a class="code" href="classoperations__research_1_1Demon.html#b7daa02f7052c9a43c64561c9d291605" title="This method returns the priority of the demon.">priority</a>()]-&gt;Enqueue(demon);
<a name="l00289"></a>00289       ProcessIfUnfrozen();
<a name="l00290"></a>00290     }
<a name="l00291"></a>00291   }
<a name="l00292"></a>00292 
<a name="l00293"></a><a class="code" href="classoperations__research_1_1Queue.html#db7a60ba9dd657dff2d727017171a424">00293</a>   <span class="keywordtype">void</span> AfterFailure() {
<a name="l00294"></a>00294     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classoperations__research_1_1Solver.html#d4faf53cefb2c2cdb8892b978a4b93a9" title="Number of priorities for demons.">Solver::kNumPriorities</a>; ++i) {
<a name="l00295"></a>00295       containers_[i]-&gt;AfterFailure();
<a name="l00296"></a>00296     }
<a name="l00297"></a>00297     <span class="keywordflow">if</span> (clear_action_ != NULL) {
<a name="l00298"></a>00298       clear_action_-&gt;Run(<a class="code" href="dependency__graph_8cc.html#bd6bfbf6753a5deb0ce273fad6408e1e">solver_</a>);
<a name="l00299"></a>00299       clear_action_ = NULL;
<a name="l00300"></a>00300     }
<a name="l00301"></a>00301     freeze_level_ = 0;
<a name="l00302"></a>00302     <a class="code" href="dependency__graph_8cc.html#3c556bc2d9f39f48c121b6222892ef2f">in_process_</a> = <span class="keyword">false</span>;
<a name="l00303"></a>00303     in_add_ = <span class="keyword">false</span>;
<a name="l00304"></a>00304     to_add_.clear();
<a name="l00305"></a>00305   }
<a name="l00306"></a>00306 
<a name="l00307"></a><a class="code" href="classoperations__research_1_1Queue.html#2ec18094b92e88d27c28f196278859dd">00307</a>   <span class="keywordtype">void</span> increase_stamp() {
<a name="l00308"></a>00308     <a class="code" href="alldiff__cst_8cc.html#1ab3854946bf086fbb0971cc82516104">stamp_</a>++;
<a name="l00309"></a>00309   }
<a name="l00310"></a>00310 
<a name="l00311"></a><a class="code" href="classoperations__research_1_1Queue.html#e66aadfbaaa362ce5fcab3dca3a642b6">00311</a>   uint64 stamp()<span class="keyword"> const </span>{
<a name="l00312"></a>00312     <span class="keywordflow">return</span> <a class="code" href="alldiff__cst_8cc.html#1ab3854946bf086fbb0971cc82516104">stamp_</a>;
<a name="l00313"></a>00313   }
<a name="l00314"></a>00314 
<a name="l00315"></a><a class="code" href="classoperations__research_1_1Queue.html#4def4b68e3661b89aa06b319908fced0">00315</a>   <span class="keywordtype">void</span> set_action_on_fail(<a class="code" href="classoperations__research_1_1Action.html" title="An action is the base callback method.">Action</a>* <span class="keyword">const</span> a) {
<a name="l00316"></a>00316     clear_action_ = a;
<a name="l00317"></a>00317   }
<a name="l00318"></a>00318 
<a name="l00319"></a><a class="code" href="classoperations__research_1_1Queue.html#95754f9530734d72b50aa96504d6b09e">00319</a>   <span class="keywordtype">void</span> clear_action_on_fail() {
<a name="l00320"></a>00320     clear_action_ = NULL;
<a name="l00321"></a>00321   }
<a name="l00322"></a>00322 
<a name="l00323"></a><a class="code" href="classoperations__research_1_1Queue.html#7e2a23c5cb5bf7c71e45a99c3355b12b">00323</a>   <span class="keywordtype">void</span> AddConstraint(<a class="code" href="classoperations__research_1_1Constraint.html" title="A constraint is the main modeling object.">Constraint</a>* <span class="keyword">const</span> c) {
<a name="l00324"></a>00324     to_add_.push_back(c);
<a name="l00325"></a>00325     ProcessConstraints();
<a name="l00326"></a>00326   }
<a name="l00327"></a>00327 
<a name="l00328"></a><a class="code" href="classoperations__research_1_1Queue.html#014c7261e4c1b40cd8d81d22e22c3e94">00328</a>   <span class="keywordtype">void</span> ProcessConstraints() {
<a name="l00329"></a>00329     <span class="keywordflow">if</span> (!in_add_) {
<a name="l00330"></a>00330       in_add_ = <span class="keyword">true</span>;
<a name="l00331"></a>00331       <span class="comment">// We cannot store to_add_.size() as constraints can add other</span>
<a name="l00332"></a>00332       <span class="comment">// constraints.</span>
<a name="l00333"></a>00333       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> counter = 0; counter &lt; to_add_.size(); ++counter) {
<a name="l00334"></a>00334         <a class="code" href="classoperations__research_1_1Constraint.html" title="A constraint is the main modeling object.">Constraint</a>* <span class="keyword">const</span> constraint = to_add_[counter];
<a name="l00335"></a>00335         <span class="comment">// TODO(user): Add profiling to initial propagation</span>
<a name="l00336"></a>00336         constraint-&gt;<a class="code" href="classoperations__research_1_1Constraint.html#92c3bfe86238b5c95448d4a0384a327f" title="Calls Post and then Propagate to initialize the constraints.">PostAndPropagate</a>();
<a name="l00337"></a>00337       }
<a name="l00338"></a>00338       in_add_ = <span class="keyword">false</span>;
<a name="l00339"></a>00339       to_add_.clear();
<a name="l00340"></a>00340     }
<a name="l00341"></a>00341   }
<a name="l00342"></a>00342 
<a name="l00343"></a>00343  <span class="keyword">private</span>:
<a name="l00344"></a>00344   <span class="keywordtype">void</span> ProcessIfUnfrozen() {
<a name="l00345"></a>00345     <span class="keywordflow">if</span> (freeze_level_ == 0) {
<a name="l00346"></a>00346       Process();
<a name="l00347"></a>00347     }
<a name="l00348"></a>00348   }
<a name="l00349"></a>00349 
<a name="l00350"></a>00350   Solver* <span class="keyword">const</span> <a class="code" href="dependency__graph_8cc.html#bd6bfbf6753a5deb0ce273fad6408e1e">solver_</a>;
<a name="l00351"></a>00351   SinglePriorityQueue* containers_[<a class="code" href="classoperations__research_1_1Solver.html#d4faf53cefb2c2cdb8892b978a4b93a9" title="Number of priorities for demons.">Solver::kNumPriorities</a>];
<a name="l00352"></a>00352   uint64 <a class="code" href="alldiff__cst_8cc.html#1ab3854946bf086fbb0971cc82516104">stamp_</a>;
<a name="l00353"></a>00353   <span class="comment">// The number of nested freeze levels. The queue is frozen if and only if</span>
<a name="l00354"></a>00354   <span class="comment">// freeze_level_ &gt; 0.</span>
<a name="l00355"></a>00355   uint32 freeze_level_;
<a name="l00356"></a>00356   <span class="keywordtype">bool</span> <a class="code" href="dependency__graph_8cc.html#3c556bc2d9f39f48c121b6222892ef2f">in_process_</a>;
<a name="l00357"></a>00357   <a class="code" href="classoperations__research_1_1Action.html#f13b925e1e74a0f907f466630aa67bc0">Action</a>* clear_action_;
<a name="l00358"></a>00358   std::vector&lt;Constraint*&gt; to_add_;
<a name="l00359"></a>00359   <span class="keywordtype">bool</span> in_add_;
<a name="l00360"></a>00360 };
<a name="l00361"></a>00361 
<a name="l00362"></a>00362 <span class="comment">// ------------------ StateMarker / StateInfo struct -----------</span>
<a name="l00363"></a>00363 
<a name="l00364"></a><a class="code" href="structoperations__research_1_1StateInfo.html">00364</a> <span class="keyword">struct </span><a class="code" href="structoperations__research_1_1StateInfo.html" title="StateMarker / StateInfo struct.">StateInfo</a> {  <span class="comment">// This is an internal structure to store</span>
<a name="l00365"></a>00365                     <span class="comment">// additional information on the choice point.</span>
<a name="l00366"></a>00366  <span class="keyword">public</span>:
<a name="l00367"></a><a class="code" href="structoperations__research_1_1StateInfo.html#fad72143d9616d487be939548da6dff2">00367</a>   <a class="code" href="structoperations__research_1_1StateInfo.html" title="StateMarker / StateInfo struct.">StateInfo</a>() : ptr_info(NULL), int_info(0), depth(0), left_depth(0) {}
<a name="l00368"></a><a class="code" href="structoperations__research_1_1StateInfo.html#d94aa9259ee22adc0b9b1f58fa707f5f">00368</a>   <a class="code" href="structoperations__research_1_1StateInfo.html" title="StateMarker / StateInfo struct.">StateInfo</a>(<span class="keywordtype">void</span>* pinfo, <span class="keywordtype">int</span> iinfo)
<a name="l00369"></a>00369       : ptr_info(pinfo), int_info(iinfo), depth(0), left_depth(0) {}
<a name="l00370"></a><a class="code" href="structoperations__research_1_1StateInfo.html#ed5c2d0c003794c99fa76f465b447149">00370</a>   <a class="code" href="structoperations__research_1_1StateInfo.html" title="StateMarker / StateInfo struct.">StateInfo</a>(<span class="keywordtype">void</span>* pinfo, <span class="keywordtype">int</span> iinfo, <span class="keywordtype">int</span> d, <span class="keywordtype">int</span> ld)
<a name="l00371"></a>00371       : ptr_info(pinfo), int_info(iinfo), depth(d), left_depth(ld) {}
<a name="l00372"></a><a class="code" href="structoperations__research_1_1StateInfo.html#23808ad010fb33b8103e7f9713816c62">00372</a>   <span class="keywordtype">void</span>* ptr_info;
<a name="l00373"></a><a class="code" href="structoperations__research_1_1StateInfo.html#000fb6644096e817fbaaa6f0ec4d2dc7">00373</a>   <span class="keywordtype">int</span> int_info;
<a name="l00374"></a><a class="code" href="structoperations__research_1_1StateInfo.html#30afd4fe3478fb7523c1839aeae271cc">00374</a>   <span class="keywordtype">int</span> depth;
<a name="l00375"></a><a class="code" href="structoperations__research_1_1StateInfo.html#c8718ab0b1cccc16ce50235e93d6fb3e">00375</a>   <span class="keywordtype">int</span> left_depth;
<a name="l00376"></a>00376 };
<a name="l00377"></a>00377 
<a name="l00378"></a><a class="code" href="structoperations__research_1_1StateMarker.html">00378</a> <span class="keyword">struct </span><a class="code" href="structoperations__research_1_1StateMarker.html">StateMarker</a> {
<a name="l00379"></a>00379  <span class="keyword">public</span>:
<a name="l00380"></a>00380   <a class="code" href="structoperations__research_1_1StateMarker.html">StateMarker</a>(<a class="code" href="namespaceoperations__research.html#5881ca2f6350f69f63b48b872c1c7e5e" title="This enum is used internally to tag states in the search tree.">MarkerType</a> t, <span class="keyword">const</span> <a class="code" href="structoperations__research_1_1StateInfo.html" title="StateMarker / StateInfo struct.">StateInfo</a>&amp; info);
<a name="l00381"></a><a class="code" href="structoperations__research_1_1StateMarker.html#16432758b314f3cedad3fba81c895417">00381</a>   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>;
<a name="l00382"></a><a class="code" href="structoperations__research_1_1StateMarker.html#3ffe707082206cf6d91b65922bafe2e2">00382</a>   <span class="keyword">friend</span> <span class="keyword">struct </span><a class="code" href="structoperations__research_1_1Trail.html">Trail</a>;
<a name="l00383"></a>00383  <span class="keyword">private</span>:
<a name="l00384"></a>00384   <a class="code" href="namespaceoperations__research.html#5881ca2f6350f69f63b48b872c1c7e5e" title="This enum is used internally to tag states in the search tree.">MarkerType</a> type_;
<a name="l00385"></a>00385   <span class="keywordtype">int</span> rev_int_index_;
<a name="l00386"></a>00386   <span class="keywordtype">int</span> rev_int64_index_;
<a name="l00387"></a>00387   <span class="keywordtype">int</span> rev_uint64_index_;
<a name="l00388"></a>00388   <span class="keywordtype">int</span> rev_ptr_index_;
<a name="l00389"></a>00389   <span class="keywordtype">int</span> rev_boolvar_list_index_;
<a name="l00390"></a>00390   <span class="keywordtype">int</span> rev_bools_index_;
<a name="l00391"></a>00391   <span class="keywordtype">int</span> rev_int_memory_index_;
<a name="l00392"></a>00392   <span class="keywordtype">int</span> rev_int64_memory_index_;
<a name="l00393"></a>00393   <span class="keywordtype">int</span> rev_object_memory_index_;
<a name="l00394"></a>00394   <span class="keywordtype">int</span> rev_object_array_memory_index_;
<a name="l00395"></a>00395   <span class="keywordtype">int</span> rev_memory_index_;
<a name="l00396"></a>00396   <span class="keywordtype">int</span> rev_memory_array_index_;
<a name="l00397"></a>00397   <a class="code" href="structoperations__research_1_1StateInfo.html" title="StateMarker / StateInfo struct.">StateInfo</a> info_;
<a name="l00398"></a>00398 };
<a name="l00399"></a>00399 
<a name="l00400"></a><a class="code" href="structoperations__research_1_1StateMarker.html#060f5d89d9a6823461479e26f62bafd8">00400</a> <a class="code" href="structoperations__research_1_1StateMarker.html#060f5d89d9a6823461479e26f62bafd8">StateMarker::StateMarker</a>(<a class="code" href="namespaceoperations__research.html#5881ca2f6350f69f63b48b872c1c7e5e" title="This enum is used internally to tag states in the search tree.">MarkerType</a> t, <span class="keyword">const</span> <a class="code" href="structoperations__research_1_1StateInfo.html" title="StateMarker / StateInfo struct.">StateInfo</a>&amp; info)
<a name="l00401"></a>00401     : type_(t),
<a name="l00402"></a>00402       rev_int_index_(0),
<a name="l00403"></a>00403       rev_int64_index_(0),
<a name="l00404"></a>00404       rev_uint64_index_(0),
<a name="l00405"></a>00405       rev_ptr_index_(0),
<a name="l00406"></a>00406       rev_boolvar_list_index_(0),
<a name="l00407"></a>00407       rev_bools_index_(0),
<a name="l00408"></a>00408       rev_int_memory_index_(0),
<a name="l00409"></a>00409       rev_int64_memory_index_(0),
<a name="l00410"></a>00410       rev_object_memory_index_(0),
<a name="l00411"></a>00411       rev_object_array_memory_index_(0),
<a name="l00412"></a>00412       info_(info) {}
<a name="l00413"></a>00413 
<a name="l00414"></a>00414 <span class="comment">// ---------- Trail and Reversibility ----------</span>
<a name="l00415"></a>00415 
<a name="l00416"></a>00416 <span class="keyword">namespace </span>{
<a name="l00417"></a>00417 <span class="comment">// ----- addrval struct -----</span>
<a name="l00418"></a>00418 
<a name="l00419"></a>00419 <span class="comment">// This template class is used internally to implement reversibility.</span>
<a name="l00420"></a>00420 <span class="comment">// It stores an address and the value that was at the address.</span>
<a name="l00421"></a>00421 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keyword">struct </span>addrval {
<a name="l00422"></a>00422  <span class="keyword">public</span>:
<a name="l00423"></a>00423   addrval() : <a class="code" href="constraint__solver_8cc.html#a362338b69c404129e01e197a25f3a16">address_</a>(NULL) {}
<a name="l00424"></a>00424   <span class="keyword">explicit</span> addrval(T* adr) : <a class="code" href="constraint__solver_8cc.html#a362338b69c404129e01e197a25f3a16">address_</a>(adr), <a class="code" href="constraint__solver_8cc.html#d23798e2eb6681fd68436c2d050a8b24">old_value_</a>(*adr) {}
<a name="l00425"></a>00425   <span class="keywordtype">void</span> restore()<span class="keyword"> const </span>{ (*address_) = <a class="code" href="constraint__solver_8cc.html#d23798e2eb6681fd68436c2d050a8b24">old_value_</a>; }
<a name="l00426"></a>00426  <span class="keyword">private</span>:
<a name="l00427"></a><a class="code" href="constraint__solver_8cc.html#a362338b69c404129e01e197a25f3a16">00427</a>   T* <a class="code" href="constraint__solver_8cc.html#a362338b69c404129e01e197a25f3a16">address_</a>;
<a name="l00428"></a><a class="code" href="constraint__solver_8cc.html#d23798e2eb6681fd68436c2d050a8b24">00428</a>   T <a class="code" href="constraint__solver_8cc.html#d23798e2eb6681fd68436c2d050a8b24">old_value_</a>;
<a name="l00429"></a>00429 };
<a name="l00430"></a>00430 
<a name="l00431"></a>00431 <span class="comment">// ----- Compressed trail -----</span>
<a name="l00432"></a>00432 
<a name="l00433"></a>00433 <span class="comment">// ---------- Trail Packer ---------</span>
<a name="l00434"></a>00434 <span class="comment">// Abstract class to pack trail blocks.</span>
<a name="l00435"></a>00435 
<a name="l00436"></a>00436 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keyword">class </span>TrailPacker {
<a name="l00437"></a>00437  <span class="keyword">public</span>:
<a name="l00438"></a>00438   <span class="keyword">explicit</span> TrailPacker(<span class="keywordtype">int</span> block_size) : <a class="code" href="constraint__solver_8cc.html#5096c18af9e85f5843cff474f8146533">block_size_</a>(block_size) {}
<a name="l00439"></a>00439   <span class="keyword">virtual</span> ~TrailPacker() {}
<a name="l00440"></a>00440   <span class="keywordtype">int</span> input_size()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="constraint__solver_8cc.html#5096c18af9e85f5843cff474f8146533">block_size_</a> * <span class="keyword">sizeof</span>(addrval&lt;T&gt;); }
<a name="l00441"></a>00441   <span class="keyword">virtual</span> <span class="keywordtype">void</span> Pack(<span class="keyword">const</span> addrval&lt;T&gt;* block, <span class="keywordtype">string</span>* packed_block) = 0;
<a name="l00442"></a>00442   <span class="keyword">virtual</span> <span class="keywordtype">void</span> Unpack(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; packed_block, addrval&lt;T&gt;* block) = 0;
<a name="l00443"></a>00443  <span class="keyword">private</span>:
<a name="l00444"></a><a class="code" href="constraint__solver_8cc.html#5096c18af9e85f5843cff474f8146533">00444</a>   <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="constraint__solver_8cc.html#5096c18af9e85f5843cff474f8146533">block_size_</a>;
<a name="l00445"></a>00445   DISALLOW_COPY_AND_ASSIGN(TrailPacker);
<a name="l00446"></a>00446 };
<a name="l00447"></a>00447 
<a name="l00448"></a>00448 
<a name="l00449"></a>00449 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keyword">class </span>NoCompressionTrailPacker : <span class="keyword">public</span> TrailPacker&lt;T&gt; {
<a name="l00450"></a>00450  <span class="keyword">public</span>:
<a name="l00451"></a>00451   <span class="keyword">explicit</span> NoCompressionTrailPacker(<span class="keywordtype">int</span> block_size)
<a name="l00452"></a>00452       : TrailPacker&lt;T&gt;(block_size) {}
<a name="l00453"></a>00453   <span class="keyword">virtual</span> ~NoCompressionTrailPacker() {}
<a name="l00454"></a>00454   <span class="keyword">virtual</span> <span class="keywordtype">void</span> Pack(<span class="keyword">const</span> addrval&lt;T&gt;* block, <span class="keywordtype">string</span>* packed_block) {
<a name="l00455"></a>00455     DCHECK(block != NULL);
<a name="l00456"></a>00456     DCHECK(packed_block != NULL);
<a name="l00457"></a>00457     StringPiece block_str;
<a name="l00458"></a>00458     block_str.set(block, this-&gt;input_size());
<a name="l00459"></a>00459     block_str.CopyToString(packed_block);
<a name="l00460"></a>00460   }
<a name="l00461"></a>00461   <span class="keyword">virtual</span> <span class="keywordtype">void</span> Unpack(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; packed_block, addrval&lt;T&gt;* block) {
<a name="l00462"></a>00462     DCHECK(block != NULL);
<a name="l00463"></a>00463     memcpy(block, packed_block.c_str(), packed_block.size());
<a name="l00464"></a>00464   }
<a name="l00465"></a>00465  <span class="keyword">private</span>:
<a name="l00466"></a>00466   DISALLOW_COPY_AND_ASSIGN(NoCompressionTrailPacker&lt;T&gt;);
<a name="l00467"></a>00467 };
<a name="l00468"></a>00468 
<a name="l00469"></a>00469 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keyword">class </span>ZlibTrailPacker : <span class="keyword">public</span> TrailPacker&lt;T&gt; {
<a name="l00470"></a>00470  <span class="keyword">public</span>:
<a name="l00471"></a>00471   <span class="keyword">explicit</span> ZlibTrailPacker(<span class="keywordtype">int</span> block_size)
<a name="l00472"></a>00472       : TrailPacker&lt;T&gt;(block_size),
<a name="l00473"></a>00473         <a class="code" href="constraint__solver_8cc.html#f2658219e014f40beab279ee9c056bf1">tmp_size_</a>(compressBound(this-&gt;input_size())),
<a name="l00474"></a>00474         <a class="code" href="constraint__solver_8cc.html#71f7f413ecb3d77d983802f59b826b9c">tmp_block_</a>(new char[<a class="code" href="constraint__solver_8cc.html#f2658219e014f40beab279ee9c056bf1">tmp_size_</a>]) {}
<a name="l00475"></a>00475 
<a name="l00476"></a>00476   <span class="keyword">virtual</span> ~ZlibTrailPacker() {}
<a name="l00477"></a>00477 
<a name="l00478"></a>00478   <span class="keyword">virtual</span> <span class="keywordtype">void</span> Pack(<span class="keyword">const</span> addrval&lt;T&gt;* block, <span class="keywordtype">string</span>* packed_block) {
<a name="l00479"></a>00479     DCHECK(block != NULL);
<a name="l00480"></a>00480     DCHECK(packed_block != NULL);
<a name="l00481"></a>00481     uLongf size = <a class="code" href="constraint__solver_8cc.html#f2658219e014f40beab279ee9c056bf1">tmp_size_</a>;
<a name="l00482"></a>00482     <span class="keyword">const</span> <span class="keywordtype">int</span> result = compress(reinterpret_cast&lt;Bytef*&gt;(<a class="code" href="constraint__solver_8cc.html#71f7f413ecb3d77d983802f59b826b9c">tmp_block_</a>.get()),
<a name="l00483"></a>00483                                 &amp;size,
<a name="l00484"></a>00484                                 reinterpret_cast&lt;const Bytef*&gt;(block),
<a name="l00485"></a>00485                                 this-&gt;input_size());
<a name="l00486"></a>00486     CHECK_EQ(Z_OK, result);
<a name="l00487"></a>00487     StringPiece block_str;
<a name="l00488"></a>00488     block_str.set(<a class="code" href="constraint__solver_8cc.html#71f7f413ecb3d77d983802f59b826b9c">tmp_block_</a>.get(), size);
<a name="l00489"></a>00489     block_str.CopyToString(packed_block);
<a name="l00490"></a>00490   }
<a name="l00491"></a>00491 
<a name="l00492"></a>00492   <span class="keyword">virtual</span> <span class="keywordtype">void</span> Unpack(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; packed_block, addrval&lt;T&gt;* block) {
<a name="l00493"></a>00493     DCHECK(block != NULL);
<a name="l00494"></a>00494     uLongf size = this-&gt;input_size();
<a name="l00495"></a>00495     <span class="keyword">const</span> <span class="keywordtype">int</span> result =
<a name="l00496"></a>00496         uncompress(reinterpret_cast&lt;Bytef*&gt;(block),
<a name="l00497"></a>00497                    &amp;size,
<a name="l00498"></a>00498                    reinterpret_cast&lt;const Bytef*&gt;(packed_block.c_str()),
<a name="l00499"></a>00499                    packed_block.size());
<a name="l00500"></a>00500     CHECK_EQ(Z_OK, result);
<a name="l00501"></a>00501   }
<a name="l00502"></a>00502 
<a name="l00503"></a>00503  <span class="keyword">private</span>:
<a name="l00504"></a><a class="code" href="constraint__solver_8cc.html#f2658219e014f40beab279ee9c056bf1">00504</a>   <span class="keyword">const</span> uint64 <a class="code" href="constraint__solver_8cc.html#f2658219e014f40beab279ee9c056bf1">tmp_size_</a>;
<a name="l00505"></a><a class="code" href="constraint__solver_8cc.html#71f7f413ecb3d77d983802f59b826b9c">00505</a>   scoped_array&lt;char&gt; <a class="code" href="constraint__solver_8cc.html#71f7f413ecb3d77d983802f59b826b9c">tmp_block_</a>;
<a name="l00506"></a>00506   DISALLOW_COPY_AND_ASSIGN(ZlibTrailPacker&lt;T&gt;);
<a name="l00507"></a>00507 };
<a name="l00508"></a>00508 
<a name="l00509"></a>00509 
<a name="l00510"></a>00510 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keyword">class </span>CompressedTrail {
<a name="l00511"></a>00511  <span class="keyword">public</span>:
<a name="l00512"></a>00512   CompressedTrail(<span class="keywordtype">int</span> block_size,
<a name="l00513"></a>00513                   <a class="code" href="structoperations__research_1_1SolverParameters.html#63c6fe2e32ced9f83a4064c800130651">SolverParameters::TrailCompression</a> compression_level)
<a name="l00514"></a>00514       : <a class="code" href="constraint__solver_8cc.html#5096c18af9e85f5843cff474f8146533">block_size_</a>(block_size),
<a name="l00515"></a>00515         <a class="code" href="constraint__solver_8cc.html#82c4fcc22ae3da4c7c6cb6988fb19162">blocks_</a>(NULL),
<a name="l00516"></a>00516         <a class="code" href="constraint__solver_8cc.html#ff6eda2a826c43e932c40d3978b1e602">free_blocks_</a>(NULL),
<a name="l00517"></a>00517         <a class="code" href="constraint__solver_8cc.html#daa4e0422c561cd3355217847b464c1a">data_</a>(new addrval&lt;T&gt;[block_size]),
<a name="l00518"></a>00518         <a class="code" href="constraint__solver_8cc.html#47e9c6399acd806832325db9443ceb1e">buffer_</a>(new addrval&lt;T&gt;[block_size]),
<a name="l00519"></a>00519         <a class="code" href="constraint__solver_8cc.html#885536ed643b79ade94dd6edb34a7c43">buffer_used_</a>(false),
<a name="l00520"></a>00520         <a class="code" href="constraint__solver_8cc.html#a94ac41f5ae06f3794120fd6dfc00201">current_</a>(0),
<a name="l00521"></a>00521         <a class="code" href="alldiff__cst_8cc.html#6947fa5d6ba628dd62d59ffbad8b8d80">size_</a>(0) {
<a name="l00522"></a>00522     <span class="keywordflow">switch</span> (compression_level) {
<a name="l00523"></a>00523       <span class="keywordflow">case</span> <a class="code" href="structoperations__research_1_1SolverParameters.html#63c6fe2e32ced9f83a4064c80013065161440a766f50f6084eb75e9475441c9b">SolverParameters::NO_COMPRESSION</a>: {
<a name="l00524"></a>00524         <a class="code" href="constraint__solver_8cc.html#0c3fa39e36967304f977d21f5b75c3e2">packer_</a>.reset(<span class="keyword">new</span> NoCompressionTrailPacker&lt;T&gt;(block_size));
<a name="l00525"></a>00525         <span class="keywordflow">break</span>;
<a name="l00526"></a>00526       }
<a name="l00527"></a>00527       <span class="keywordflow">case</span> <a class="code" href="structoperations__research_1_1SolverParameters.html#63c6fe2e32ced9f83a4064c800130651be0708fd20ec0a9fc653ee2d2ee2f10f">SolverParameters::COMPRESS_WITH_ZLIB</a>: {
<a name="l00528"></a>00528         <a class="code" href="constraint__solver_8cc.html#0c3fa39e36967304f977d21f5b75c3e2">packer_</a>.reset(<span class="keyword">new</span> ZlibTrailPacker&lt;T&gt;(block_size));
<a name="l00529"></a>00529         <span class="keywordflow">break</span>;
<a name="l00530"></a>00530       }
<a name="l00531"></a>00531     }
<a name="l00532"></a>00532 
<a name="l00533"></a>00533     <span class="comment">// We zero all memory used by addrval arrays.</span>
<a name="l00534"></a>00534     <span class="comment">// Because of padding, all bytes may not be initialized, while compression</span>
<a name="l00535"></a>00535     <span class="comment">// will read them all, even if the uninitialized bytes are never used.</span>
<a name="l00536"></a>00536     <span class="comment">// This makes valgrind happy.</span>
<a name="l00537"></a>00537 
<a name="l00538"></a>00538     memset(<a class="code" href="constraint__solver_8cc.html#daa4e0422c561cd3355217847b464c1a">data_</a>.get(), 0, <span class="keyword">sizeof</span>(*<a class="code" href="constraint__solver_8cc.html#daa4e0422c561cd3355217847b464c1a">data_</a>.get()) * block_size);
<a name="l00539"></a>00539     memset(<a class="code" href="constraint__solver_8cc.html#47e9c6399acd806832325db9443ceb1e">buffer_</a>.get(), 0, <span class="keyword">sizeof</span>(*<a class="code" href="constraint__solver_8cc.html#47e9c6399acd806832325db9443ceb1e">buffer_</a>.get()) * block_size);
<a name="l00540"></a>00540   }
<a name="l00541"></a>00541   ~CompressedTrail() {
<a name="l00542"></a>00542     FreeBlocks(<a class="code" href="constraint__solver_8cc.html#82c4fcc22ae3da4c7c6cb6988fb19162">blocks_</a>);
<a name="l00543"></a>00543     FreeBlocks(<a class="code" href="constraint__solver_8cc.html#ff6eda2a826c43e932c40d3978b1e602">free_blocks_</a>);
<a name="l00544"></a>00544   }
<a name="l00545"></a>00545   <span class="keyword">const</span> addrval&lt;T&gt;&amp; Back()<span class="keyword"> const </span>{
<a name="l00546"></a>00546     <span class="comment">// Back of empty trail.</span>
<a name="l00547"></a>00547     DCHECK_GT(<a class="code" href="constraint__solver_8cc.html#a94ac41f5ae06f3794120fd6dfc00201">current_</a>, 0);
<a name="l00548"></a>00548     <span class="keywordflow">return</span> <a class="code" href="constraint__solver_8cc.html#daa4e0422c561cd3355217847b464c1a">data_</a>[<a class="code" href="constraint__solver_8cc.html#a94ac41f5ae06f3794120fd6dfc00201">current_</a> - 1];
<a name="l00549"></a>00549   }
<a name="l00550"></a>00550   <span class="keywordtype">void</span> PopBack() {
<a name="l00551"></a>00551     <span class="keywordflow">if</span> (<a class="code" href="alldiff__cst_8cc.html#6947fa5d6ba628dd62d59ffbad8b8d80">size_</a> &gt; 0) {
<a name="l00552"></a>00552       --<a class="code" href="constraint__solver_8cc.html#a94ac41f5ae06f3794120fd6dfc00201">current_</a>;
<a name="l00553"></a>00553       <span class="keywordflow">if</span> (<a class="code" href="constraint__solver_8cc.html#a94ac41f5ae06f3794120fd6dfc00201">current_</a> &lt;= 0) {
<a name="l00554"></a>00554         <span class="keywordflow">if</span> (<a class="code" href="constraint__solver_8cc.html#885536ed643b79ade94dd6edb34a7c43">buffer_used_</a>) {
<a name="l00555"></a>00555           <a class="code" href="constraint__solver_8cc.html#daa4e0422c561cd3355217847b464c1a">data_</a>.swap(<a class="code" href="constraint__solver_8cc.html#47e9c6399acd806832325db9443ceb1e">buffer_</a>);
<a name="l00556"></a>00556           <a class="code" href="constraint__solver_8cc.html#a94ac41f5ae06f3794120fd6dfc00201">current_</a> = <a class="code" href="constraint__solver_8cc.html#5096c18af9e85f5843cff474f8146533">block_size_</a>;
<a name="l00557"></a>00557           <a class="code" href="constraint__solver_8cc.html#885536ed643b79ade94dd6edb34a7c43">buffer_used_</a> = <span class="keyword">false</span>;
<a name="l00558"></a>00558         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="constraint__solver_8cc.html#82c4fcc22ae3da4c7c6cb6988fb19162">blocks_</a> != NULL) {
<a name="l00559"></a>00559           <a class="code" href="constraint__solver_8cc.html#0c3fa39e36967304f977d21f5b75c3e2">packer_</a>-&gt;Unpack(<a class="code" href="constraint__solver_8cc.html#82c4fcc22ae3da4c7c6cb6988fb19162">blocks_</a>-&gt;compressed, <a class="code" href="constraint__solver_8cc.html#daa4e0422c561cd3355217847b464c1a">data_</a>.get());
<a name="l00560"></a>00560           FreeTopBlock();
<a name="l00561"></a>00561           <a class="code" href="constraint__solver_8cc.html#a94ac41f5ae06f3794120fd6dfc00201">current_</a> = <a class="code" href="constraint__solver_8cc.html#5096c18af9e85f5843cff474f8146533">block_size_</a>;
<a name="l00562"></a>00562         }
<a name="l00563"></a>00563       }
<a name="l00564"></a>00564       --<a class="code" href="alldiff__cst_8cc.html#6947fa5d6ba628dd62d59ffbad8b8d80">size_</a>;
<a name="l00565"></a>00565     }
<a name="l00566"></a>00566   }
<a name="l00567"></a>00567   <span class="keywordtype">void</span> PushBack(<span class="keyword">const</span> addrval&lt;T&gt;&amp; addr_val) {
<a name="l00568"></a>00568     <span class="keywordflow">if</span> (<a class="code" href="constraint__solver_8cc.html#a94ac41f5ae06f3794120fd6dfc00201">current_</a> &gt;= <a class="code" href="constraint__solver_8cc.html#5096c18af9e85f5843cff474f8146533">block_size_</a>) {
<a name="l00569"></a>00569       <span class="keywordflow">if</span> (<a class="code" href="constraint__solver_8cc.html#885536ed643b79ade94dd6edb34a7c43">buffer_used_</a>) {  <span class="comment">// Buffer is used.</span>
<a name="l00570"></a>00570         NewTopBlock();
<a name="l00571"></a>00571         <a class="code" href="constraint__solver_8cc.html#0c3fa39e36967304f977d21f5b75c3e2">packer_</a>-&gt;Pack(<a class="code" href="constraint__solver_8cc.html#47e9c6399acd806832325db9443ceb1e">buffer_</a>.get(), &amp;<a class="code" href="constraint__solver_8cc.html#82c4fcc22ae3da4c7c6cb6988fb19162">blocks_</a>-&gt;compressed);
<a name="l00572"></a>00572         <span class="comment">// O(1) operation.</span>
<a name="l00573"></a>00573         <a class="code" href="constraint__solver_8cc.html#daa4e0422c561cd3355217847b464c1a">data_</a>.swap(<a class="code" href="constraint__solver_8cc.html#47e9c6399acd806832325db9443ceb1e">buffer_</a>);
<a name="l00574"></a>00574       } <span class="keywordflow">else</span> {
<a name="l00575"></a>00575         <a class="code" href="constraint__solver_8cc.html#daa4e0422c561cd3355217847b464c1a">data_</a>.swap(<a class="code" href="constraint__solver_8cc.html#47e9c6399acd806832325db9443ceb1e">buffer_</a>);
<a name="l00576"></a>00576         <a class="code" href="constraint__solver_8cc.html#885536ed643b79ade94dd6edb34a7c43">buffer_used_</a> = <span class="keyword">true</span>;
<a name="l00577"></a>00577       }
<a name="l00578"></a>00578       <a class="code" href="constraint__solver_8cc.html#a94ac41f5ae06f3794120fd6dfc00201">current_</a> = 0;
<a name="l00579"></a>00579     }
<a name="l00580"></a>00580     <a class="code" href="constraint__solver_8cc.html#daa4e0422c561cd3355217847b464c1a">data_</a>[<a class="code" href="constraint__solver_8cc.html#a94ac41f5ae06f3794120fd6dfc00201">current_</a>] = addr_val;
<a name="l00581"></a>00581     ++<a class="code" href="constraint__solver_8cc.html#a94ac41f5ae06f3794120fd6dfc00201">current_</a>;
<a name="l00582"></a>00582     ++<a class="code" href="alldiff__cst_8cc.html#6947fa5d6ba628dd62d59ffbad8b8d80">size_</a>;
<a name="l00583"></a>00583   }
<a name="l00584"></a>00584   <span class="keywordtype">int</span> size()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="alldiff__cst_8cc.html#6947fa5d6ba628dd62d59ffbad8b8d80">size_</a>; }
<a name="l00585"></a>00585 
<a name="l00586"></a>00586  <span class="keyword">private</span>:
<a name="l00587"></a>00587   <span class="keyword">struct </span>Block {
<a name="l00588"></a><a class="code" href="constraint__solver_8cc.html#af1975cc46128f6c968300d5a0bcdb18">00588</a>     <span class="keywordtype">string</span> <a class="code" href="constraint__solver_8cc.html#af1975cc46128f6c968300d5a0bcdb18">compressed</a>;
<a name="l00589"></a>00589     Block* <a class="code" href="constraint__solver_8cc.html#395f613555f398dd389670bb4c2a4599">next</a>;
<a name="l00590"></a>00590   };
<a name="l00591"></a>00591 
<a name="l00592"></a>00592   <span class="keywordtype">void</span> FreeTopBlock() {
<a name="l00593"></a>00593     Block* block = <a class="code" href="constraint__solver_8cc.html#82c4fcc22ae3da4c7c6cb6988fb19162">blocks_</a>;
<a name="l00594"></a>00594     <a class="code" href="constraint__solver_8cc.html#82c4fcc22ae3da4c7c6cb6988fb19162">blocks_</a> = block-&gt;next;
<a name="l00595"></a>00595     block-&gt;compressed.clear();
<a name="l00596"></a>00596     block-&gt;next = <a class="code" href="constraint__solver_8cc.html#ff6eda2a826c43e932c40d3978b1e602">free_blocks_</a>;
<a name="l00597"></a>00597     <a class="code" href="constraint__solver_8cc.html#ff6eda2a826c43e932c40d3978b1e602">free_blocks_</a> = block;
<a name="l00598"></a>00598   }
<a name="l00599"></a>00599   <span class="keywordtype">void</span> NewTopBlock() {
<a name="l00600"></a>00600     Block* block = NULL;
<a name="l00601"></a>00601     <span class="keywordflow">if</span> (<a class="code" href="constraint__solver_8cc.html#ff6eda2a826c43e932c40d3978b1e602">free_blocks_</a> != NULL) {
<a name="l00602"></a>00602       block = <a class="code" href="constraint__solver_8cc.html#ff6eda2a826c43e932c40d3978b1e602">free_blocks_</a>;
<a name="l00603"></a>00603       <a class="code" href="constraint__solver_8cc.html#ff6eda2a826c43e932c40d3978b1e602">free_blocks_</a> = block-&gt;next;
<a name="l00604"></a>00604     } <span class="keywordflow">else</span> {
<a name="l00605"></a>00605       block = <span class="keyword">new</span> Block;
<a name="l00606"></a>00606     }
<a name="l00607"></a>00607     block-&gt;next = <a class="code" href="constraint__solver_8cc.html#82c4fcc22ae3da4c7c6cb6988fb19162">blocks_</a>;
<a name="l00608"></a>00608     <a class="code" href="constraint__solver_8cc.html#82c4fcc22ae3da4c7c6cb6988fb19162">blocks_</a> = block;
<a name="l00609"></a>00609   }
<a name="l00610"></a>00610   <span class="keywordtype">void</span> FreeBlocks(Block* blocks) {
<a name="l00611"></a>00611     <span class="keywordflow">while</span> (NULL != blocks) {
<a name="l00612"></a>00612       Block* <a class="code" href="constraint__solver_8cc.html#395f613555f398dd389670bb4c2a4599">next</a> = blocks-&gt;next;
<a name="l00613"></a>00613       <span class="keyword">delete</span> blocks;
<a name="l00614"></a>00614       blocks = next;
<a name="l00615"></a>00615     }
<a name="l00616"></a>00616   }
<a name="l00617"></a>00617 
<a name="l00618"></a><a class="code" href="constraint__solver_8cc.html#0c3fa39e36967304f977d21f5b75c3e2">00618</a>   scoped_ptr&lt;TrailPacker&lt;T&gt; &gt; <a class="code" href="constraint__solver_8cc.html#0c3fa39e36967304f977d21f5b75c3e2">packer_</a>;
<a name="l00619"></a>00619   <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="constraint__solver_8cc.html#5096c18af9e85f5843cff474f8146533">block_size_</a>;
<a name="l00620"></a><a class="code" href="constraint__solver_8cc.html#82c4fcc22ae3da4c7c6cb6988fb19162">00620</a>   Block* <a class="code" href="constraint__solver_8cc.html#82c4fcc22ae3da4c7c6cb6988fb19162">blocks_</a>;
<a name="l00621"></a><a class="code" href="constraint__solver_8cc.html#ff6eda2a826c43e932c40d3978b1e602">00621</a>   Block* <a class="code" href="constraint__solver_8cc.html#ff6eda2a826c43e932c40d3978b1e602">free_blocks_</a>;
<a name="l00622"></a><a class="code" href="constraint__solver_8cc.html#daa4e0422c561cd3355217847b464c1a">00622</a>   scoped_array&lt;addrval&lt;T&gt; &gt; <a class="code" href="constraint__solver_8cc.html#daa4e0422c561cd3355217847b464c1a">data_</a>;
<a name="l00623"></a><a class="code" href="constraint__solver_8cc.html#47e9c6399acd806832325db9443ceb1e">00623</a>   scoped_array&lt;addrval&lt;T&gt; &gt; <a class="code" href="constraint__solver_8cc.html#47e9c6399acd806832325db9443ceb1e">buffer_</a>;
<a name="l00624"></a><a class="code" href="constraint__solver_8cc.html#885536ed643b79ade94dd6edb34a7c43">00624</a>   <span class="keywordtype">bool</span> <a class="code" href="constraint__solver_8cc.html#885536ed643b79ade94dd6edb34a7c43">buffer_used_</a>;
<a name="l00625"></a><a class="code" href="constraint__solver_8cc.html#a94ac41f5ae06f3794120fd6dfc00201">00625</a>   <span class="keywordtype">int</span> <a class="code" href="constraint__solver_8cc.html#a94ac41f5ae06f3794120fd6dfc00201">current_</a>;
<a name="l00626"></a><a class="code" href="constraint__solver_8cc.html#6947fa5d6ba628dd62d59ffbad8b8d80">00626</a>   <span class="keywordtype">int</span> <a class="code" href="alldiff__cst_8cc.html#6947fa5d6ba628dd62d59ffbad8b8d80">size_</a>;
<a name="l00627"></a>00627 };
<a name="l00628"></a>00628 }  <span class="comment">// namespace</span>
<a name="l00629"></a>00629 
<a name="l00630"></a>00630 <span class="comment">// ----- Trail -----</span>
<a name="l00631"></a>00631 
<a name="l00632"></a>00632 <span class="comment">// Object are explicitely copied using the copy ctor instead of</span>
<a name="l00633"></a>00633 <span class="comment">// passing and storing a pointer. As objects are small, copying is</span>
<a name="l00634"></a>00634 <span class="comment">// much faster than allocating (around 35% on a complete solve).</span>
<a name="l00635"></a>00635 
<a name="l00636"></a>00636 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="namespaceoperations__research.html#bf86ac5b7c7ec6d91d566831705aae7a" title="namespace">RestoreBoolValue</a>(IntVar* <span class="keyword">const</span> <a class="code" href="expr__array_8cc.html#472a99923cbe11ae7b5a5d157d9ad465">var</a>);
<a name="l00637"></a>00637 
<a name="l00638"></a><a class="code" href="structoperations__research_1_1Trail.html">00638</a> <span class="keyword">struct </span><a class="code" href="structoperations__research_1_1Trail.html">Trail</a> {
<a name="l00639"></a><a class="code" href="structoperations__research_1_1Trail.html#2d4bed7f601d9c2b91c436bf26d06b3f">00639</a>   CompressedTrail&lt;int&gt; rev_ints_;
<a name="l00640"></a><a class="code" href="structoperations__research_1_1Trail.html#560c3b50561fbad23f5d0eb2c23ebfab">00640</a>   CompressedTrail&lt;int64&gt; rev_int64s_;
<a name="l00641"></a><a class="code" href="structoperations__research_1_1Trail.html#4955abe64f41d7b61b70a50cecd54e6e">00641</a>   CompressedTrail&lt;uint64&gt; rev_uint64s_;
<a name="l00642"></a><a class="code" href="structoperations__research_1_1Trail.html#dbd038e5ae46c593614742f8a99a5e2f">00642</a>   CompressedTrail&lt;void*&gt; rev_ptrs_;
<a name="l00643"></a><a class="code" href="structoperations__research_1_1Trail.html#14dde66107e14df4e0ba8776044f98b8">00643</a>   std::vector&lt;IntVar*&gt; rev_boolvar_list_;
<a name="l00644"></a><a class="code" href="structoperations__research_1_1Trail.html#af3945788d4e1c53750a716f3ec5c81f">00644</a>   std::vector&lt;bool*&gt; rev_bools_;
<a name="l00645"></a><a class="code" href="structoperations__research_1_1Trail.html#c1bd42259c931105cdb2de4d3dce0e18">00645</a>   std::vector&lt;bool&gt; rev_bool_value_;
<a name="l00646"></a><a class="code" href="structoperations__research_1_1Trail.html#065ec10de6bd9974f507166874244d21">00646</a>   std::vector&lt;int*&gt; rev_int_memory_;
<a name="l00647"></a><a class="code" href="structoperations__research_1_1Trail.html#5483c63862b2b25a8d0d0c805663b64e">00647</a>   std::vector&lt;int64*&gt; rev_int64_memory_;
<a name="l00648"></a><a class="code" href="structoperations__research_1_1Trail.html#3fddfc852cfa223da8de198ba9a82930">00648</a>   std::vector&lt;BaseObject*&gt; rev_object_memory_;
<a name="l00649"></a><a class="code" href="structoperations__research_1_1Trail.html#e159f888e466248913a366ced7b3337f">00649</a>   std::vector&lt;BaseObject**&gt; rev_object_array_memory_;
<a name="l00650"></a><a class="code" href="structoperations__research_1_1Trail.html#a202f0ebb9d9e361ddabfd6a280b266d">00650</a>   std::vector&lt;void*&gt; rev_memory_;
<a name="l00651"></a><a class="code" href="structoperations__research_1_1Trail.html#5d994aba6a8e421ffa6e7db2be9c977a">00651</a>   std::vector&lt;void**&gt; rev_memory_array_;
<a name="l00652"></a>00652 
<a name="l00653"></a><a class="code" href="structoperations__research_1_1Trail.html#bdf8beb7e8d0082af1e7d8efa2e9f9e6">00653</a>   <a class="code" href="structoperations__research_1_1StateMarker.html#3ffe707082206cf6d91b65922bafe2e2">Trail</a>(<span class="keywordtype">int</span> block_size, <a class="code" href="structoperations__research_1_1SolverParameters.html#63c6fe2e32ced9f83a4064c800130651">SolverParameters::TrailCompression</a> compression_level)
<a name="l00654"></a>00654       : rev_ints_(block_size, compression_level),
<a name="l00655"></a>00655         rev_int64s_(block_size, compression_level),
<a name="l00656"></a>00656         rev_uint64s_(block_size, compression_level),
<a name="l00657"></a>00657         rev_ptrs_(block_size, compression_level) {}
<a name="l00658"></a>00658 
<a name="l00659"></a><a class="code" href="structoperations__research_1_1Trail.html#9bcb808935c3276e422e896453335a3c">00659</a>   <span class="keywordtype">void</span> BacktrackTo(<a class="code" href="structoperations__research_1_1StateMarker.html">StateMarker</a>* m) {
<a name="l00660"></a>00660     <span class="keywordtype">int</span> target = m-&gt;<a class="code" href="structoperations__research_1_1StateMarker.html#47e232d3c97f162917eb26a62370a3b0">rev_int_index_</a>;
<a name="l00661"></a>00661     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> curr = rev_ints_.size(); curr &gt; target; --curr) {
<a name="l00662"></a>00662       <span class="keyword">const</span> addrval&lt;int&gt;&amp; cell = rev_ints_.Back();
<a name="l00663"></a>00663       cell.restore();
<a name="l00664"></a>00664       rev_ints_.PopBack();
<a name="l00665"></a>00665     }
<a name="l00666"></a>00666     DCHECK_EQ(rev_ints_.size(), target);
<a name="l00667"></a>00667     <span class="comment">// Incorrect trail size after backtrack.</span>
<a name="l00668"></a>00668     target = m-&gt;<a class="code" href="structoperations__research_1_1StateMarker.html#59a871b8eb960f4f605ce92ae0b0b5cb">rev_int64_index_</a>;
<a name="l00669"></a>00669     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> curr = rev_int64s_.size(); curr &gt; target; --curr) {
<a name="l00670"></a>00670       <span class="keyword">const</span> addrval&lt;int64&gt;&amp; cell = rev_int64s_.Back();
<a name="l00671"></a>00671       cell.restore();
<a name="l00672"></a>00672       rev_int64s_.PopBack();
<a name="l00673"></a>00673     }
<a name="l00674"></a>00674     DCHECK_EQ(rev_int64s_.size(), target);
<a name="l00675"></a>00675     <span class="comment">// Incorrect trail size after backtrack.</span>
<a name="l00676"></a>00676     target = m-&gt;<a class="code" href="structoperations__research_1_1StateMarker.html#98de7b131b404376d33337b01eb28031">rev_uint64_index_</a>;
<a name="l00677"></a>00677     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> curr = rev_uint64s_.size(); curr &gt; target; --curr) {
<a name="l00678"></a>00678       <span class="keyword">const</span> addrval&lt;uint64&gt;&amp; cell = rev_uint64s_.Back();
<a name="l00679"></a>00679       cell.restore();
<a name="l00680"></a>00680       rev_uint64s_.PopBack();
<a name="l00681"></a>00681     }
<a name="l00682"></a>00682     DCHECK_EQ(rev_uint64s_.size(), target);
<a name="l00683"></a>00683     <span class="comment">// Incorrect trail size after backtrack.</span>
<a name="l00684"></a>00684     target = m-&gt;<a class="code" href="structoperations__research_1_1StateMarker.html#611fa35102e6366583df213d9a033ce5">rev_ptr_index_</a>;
<a name="l00685"></a>00685     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> curr = rev_ptrs_.size(); curr &gt; target; --curr) {
<a name="l00686"></a>00686       <span class="keyword">const</span> addrval&lt;void*&gt;&amp; cell = rev_ptrs_.Back();
<a name="l00687"></a>00687       cell.restore();
<a name="l00688"></a>00688       rev_ptrs_.PopBack();
<a name="l00689"></a>00689     }
<a name="l00690"></a>00690     DCHECK_EQ(rev_ptrs_.size(), target);
<a name="l00691"></a>00691     <span class="comment">// Incorrect trail size after backtrack.</span>
<a name="l00692"></a>00692     target = m-&gt;<a class="code" href="structoperations__research_1_1StateMarker.html#e15d50e63cbb570a6c5bd9b207e4fd86">rev_boolvar_list_index_</a>;
<a name="l00693"></a>00693     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> curr = rev_boolvar_list_.size() - 1; curr &gt;= target; --curr) {
<a name="l00694"></a>00694       <a class="code" href="classoperations__research_1_1IntVar.html" title="The class IntVar is a subset of IntExpr.">IntVar</a>* <span class="keyword">const</span> <a class="code" href="expr__array_8cc.html#472a99923cbe11ae7b5a5d157d9ad465">var</a> = rev_boolvar_list_[curr];
<a name="l00695"></a>00695       <a class="code" href="namespaceoperations__research.html#bf86ac5b7c7ec6d91d566831705aae7a" title="namespace">RestoreBoolValue</a>(var);
<a name="l00696"></a>00696     }
<a name="l00697"></a>00697     rev_boolvar_list_.resize(target);
<a name="l00698"></a>00698 
<a name="l00699"></a>00699     DCHECK_EQ(rev_bools_.size(), rev_bool_value_.size());
<a name="l00700"></a>00700     target = m-&gt;<a class="code" href="structoperations__research_1_1StateMarker.html#cfe80591d75fad1f8b61d0be54f83be1">rev_bools_index_</a>;
<a name="l00701"></a>00701     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> curr = rev_bools_.size() - 1; curr &gt;= target; --curr) {
<a name="l00702"></a>00702       *(rev_bools_[curr]) = rev_bool_value_[curr];
<a name="l00703"></a>00703     }
<a name="l00704"></a>00704     rev_bools_.resize(target);
<a name="l00705"></a>00705     rev_bool_value_.resize(target);
<a name="l00706"></a>00706 
<a name="l00707"></a>00707     target = m-&gt;<a class="code" href="structoperations__research_1_1StateMarker.html#567759b019a07447185219b3b049a56b">rev_int_memory_index_</a>;
<a name="l00708"></a>00708     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> curr = rev_int_memory_.size() - 1; curr &gt;= target; --curr) {
<a name="l00709"></a>00709       <span class="keyword">delete</span>[] rev_int_memory_[curr];
<a name="l00710"></a>00710     }
<a name="l00711"></a>00711     rev_int_memory_.resize(target);
<a name="l00712"></a>00712 
<a name="l00713"></a>00713     target = m-&gt;<a class="code" href="structoperations__research_1_1StateMarker.html#3716106fcd2f164dd83d0ee3d7f48ea4">rev_int64_memory_index_</a>;
<a name="l00714"></a>00714     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> curr = rev_int64_memory_.size() - 1; curr &gt;= target; --curr) {
<a name="l00715"></a>00715       <span class="keyword">delete</span>[] rev_int64_memory_[curr];
<a name="l00716"></a>00716     }
<a name="l00717"></a>00717     rev_int64_memory_.resize(target);
<a name="l00718"></a>00718 
<a name="l00719"></a>00719     target = m-&gt;<a class="code" href="structoperations__research_1_1StateMarker.html#0d2c3347f6d80cf1754b596f5c4cd3f3">rev_object_memory_index_</a>;
<a name="l00720"></a>00720     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> curr = rev_object_memory_.size() - 1; curr &gt;= target; --curr) {
<a name="l00721"></a>00721       <span class="keyword">delete</span> rev_object_memory_[curr];
<a name="l00722"></a>00722     }
<a name="l00723"></a>00723     rev_object_memory_.resize(target);
<a name="l00724"></a>00724 
<a name="l00725"></a>00725     target = m-&gt;<a class="code" href="structoperations__research_1_1StateMarker.html#b9edca8db5e3933b8343ebc6242c51b0">rev_object_array_memory_index_</a>;
<a name="l00726"></a>00726     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> curr = rev_object_array_memory_.size() - 1;
<a name="l00727"></a>00727          curr &gt;= target; --curr) {
<a name="l00728"></a>00728       <span class="keyword">delete</span>[] rev_object_array_memory_[curr];
<a name="l00729"></a>00729     }
<a name="l00730"></a>00730     rev_object_array_memory_.resize(target);
<a name="l00731"></a>00731 
<a name="l00732"></a>00732     target = m-&gt;<a class="code" href="structoperations__research_1_1StateMarker.html#59f571a7c091f1c6613f7a3fd81e2b9f">rev_memory_index_</a>;
<a name="l00733"></a>00733     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> curr = rev_memory_.size() - 1; curr &gt;= target; --curr) {
<a name="l00734"></a>00734       <span class="keyword">delete</span> <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(rev_memory_[curr]);
<a name="l00735"></a>00735       <span class="comment">// The previous cast is necessary to deallocate generic memory</span>
<a name="l00736"></a>00736       <span class="comment">// described by a void* when passed to the RevAlloc procedure</span>
<a name="l00737"></a>00737       <span class="comment">// We cannot do a delete[] there</span>
<a name="l00738"></a>00738       <span class="comment">// This is useful for cells of RevFIFO and should not be used outside</span>
<a name="l00739"></a>00739       <span class="comment">// of the product</span>
<a name="l00740"></a>00740     }
<a name="l00741"></a>00741     rev_memory_.resize(target);
<a name="l00742"></a>00742 
<a name="l00743"></a>00743     target = m-&gt;<a class="code" href="structoperations__research_1_1StateMarker.html#7376e157224557b0ac9471eee71c2e04">rev_memory_array_index_</a>;
<a name="l00744"></a>00744     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> curr = rev_memory_array_.size() - 1; curr &gt;= target; --curr) {
<a name="l00745"></a>00745       <span class="keyword">delete</span> [] rev_memory_array_[curr];
<a name="l00746"></a>00746       <span class="comment">// delete [] version of the previous unsafe case.</span>
<a name="l00747"></a>00747     }
<a name="l00748"></a>00748     rev_memory_array_.resize(target);
<a name="l00749"></a>00749   }
<a name="l00750"></a>00750 };
<a name="l00751"></a>00751 
<a name="l00752"></a>00752 <span class="keywordtype">void</span> Solver::InternalSaveValue(<span class="keywordtype">int</span>* valptr) {
<a name="l00753"></a>00753   trail_-&gt;rev_ints_.PushBack(addrval&lt;int&gt;(valptr));
<a name="l00754"></a>00754 }
<a name="l00755"></a>00755 
<a name="l00756"></a>00756 <span class="keywordtype">void</span> Solver::InternalSaveValue(int64* valptr) {
<a name="l00757"></a>00757   trail_-&gt;rev_int64s_.PushBack(addrval&lt;int64&gt;(valptr));
<a name="l00758"></a>00758 }
<a name="l00759"></a>00759 
<a name="l00760"></a>00760 <span class="keywordtype">void</span> Solver::InternalSaveValue(uint64* valptr) {
<a name="l00761"></a>00761   trail_-&gt;rev_uint64s_.PushBack(addrval&lt;uint64&gt;(valptr));
<a name="l00762"></a>00762 }
<a name="l00763"></a>00763 
<a name="l00764"></a>00764 <span class="keywordtype">void</span> Solver::InternalSaveValue(<span class="keywordtype">void</span>** valptr) {
<a name="l00765"></a>00765   trail_-&gt;rev_ptrs_.PushBack(addrval&lt;void*&gt;(valptr));
<a name="l00766"></a>00766 }
<a name="l00767"></a>00767 
<a name="l00768"></a>00768 <span class="comment">// TODO(user) : this code is unsafe if you save the same alternating</span>
<a name="l00769"></a>00769 <span class="comment">// bool multiple times.</span>
<a name="l00770"></a>00770 <span class="comment">// The correct code should use a bitset and a single list.</span>
<a name="l00771"></a>00771 <span class="keywordtype">void</span> Solver::InternalSaveValue(<span class="keywordtype">bool</span>* valptr) {
<a name="l00772"></a>00772   trail_-&gt;rev_bools_.push_back(valptr);
<a name="l00773"></a>00773   trail_-&gt;rev_bool_value_.push_back(*valptr);
<a name="l00774"></a>00774 }
<a name="l00775"></a>00775 
<a name="l00776"></a>00776 <span class="keywordtype">int</span>* Solver::SafeRevAlloc(<span class="keywordtype">int</span>* ptr) {
<a name="l00777"></a>00777   check_alloc_state();
<a name="l00778"></a>00778   trail_-&gt;rev_int_memory_.push_back(ptr);
<a name="l00779"></a>00779   <span class="keywordflow">return</span> ptr;
<a name="l00780"></a>00780 }
<a name="l00781"></a>00781 
<a name="l00782"></a>00782 int64* Solver::SafeRevAlloc(int64* ptr) {
<a name="l00783"></a>00783   check_alloc_state();
<a name="l00784"></a>00784   trail_-&gt;rev_int64_memory_.push_back(ptr);
<a name="l00785"></a>00785   <span class="keywordflow">return</span> ptr;
<a name="l00786"></a>00786 }
<a name="l00787"></a>00787 
<a name="l00788"></a>00788 uint64* Solver::SafeRevAlloc(uint64* ptr) {
<a name="l00789"></a>00789   check_alloc_state();
<a name="l00790"></a>00790   trail_-&gt;rev_int64_memory_.push_back(reinterpret_cast&lt;int64*&gt;(ptr));
<a name="l00791"></a>00791   <span class="keywordflow">return</span> ptr;
<a name="l00792"></a>00792 }
<a name="l00793"></a>00793 
<a name="l00794"></a>00794 BaseObject* Solver::SafeRevAlloc(BaseObject* ptr) {
<a name="l00795"></a>00795   check_alloc_state();
<a name="l00796"></a>00796   trail_-&gt;rev_object_memory_.push_back(ptr);
<a name="l00797"></a>00797   <span class="keywordflow">return</span> ptr;
<a name="l00798"></a>00798 }
<a name="l00799"></a>00799 
<a name="l00800"></a>00800 BaseObject** Solver::SafeRevAlloc(BaseObject** ptr) {
<a name="l00801"></a>00801   check_alloc_state();
<a name="l00802"></a>00802   trail_-&gt;rev_object_array_memory_.push_back(ptr);
<a name="l00803"></a>00803   <span class="keywordflow">return</span> ptr;
<a name="l00804"></a>00804 }
<a name="l00805"></a>00805 
<a name="l00806"></a>00806 IntVar** Solver::SafeRevAlloc(IntVar** ptr) {
<a name="l00807"></a>00807   BaseObject** in = SafeRevAlloc(reinterpret_cast&lt;BaseObject**&gt;(ptr));
<a name="l00808"></a>00808   <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span>IntVar**<span class="keyword">&gt;</span>(in);
<a name="l00809"></a>00809 }
<a name="l00810"></a>00810 
<a name="l00811"></a>00811 IntExpr** Solver::SafeRevAlloc(IntExpr** ptr) {
<a name="l00812"></a>00812   BaseObject** in = SafeRevAlloc(reinterpret_cast&lt;BaseObject**&gt;(ptr));
<a name="l00813"></a>00813   <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span>IntExpr**<span class="keyword">&gt;</span>(in);
<a name="l00814"></a>00814 }
<a name="l00815"></a>00815 
<a name="l00816"></a>00816 Constraint** Solver::SafeRevAlloc(Constraint** ptr) {
<a name="l00817"></a>00817   BaseObject** in = SafeRevAlloc(reinterpret_cast&lt;BaseObject**&gt;(ptr));
<a name="l00818"></a>00818   <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span>Constraint**<span class="keyword">&gt;</span>(in);
<a name="l00819"></a>00819 }
<a name="l00820"></a>00820 
<a name="l00821"></a>00821 <span class="keywordtype">void</span>* Solver::UnsafeRevAllocAux(<span class="keywordtype">void</span>* ptr) {
<a name="l00822"></a>00822   check_alloc_state();
<a name="l00823"></a>00823   trail_-&gt;rev_memory_.push_back(ptr);
<a name="l00824"></a>00824   <span class="keywordflow">return</span> ptr;
<a name="l00825"></a>00825 }
<a name="l00826"></a>00826 
<a name="l00827"></a>00827 <span class="keywordtype">void</span>** Solver::UnsafeRevAllocArrayAux(<span class="keywordtype">void</span>** ptr) {
<a name="l00828"></a>00828   check_alloc_state();
<a name="l00829"></a>00829   trail_-&gt;rev_memory_array_.push_back(ptr);
<a name="l00830"></a>00830   <span class="keywordflow">return</span> ptr;
<a name="l00831"></a>00831 }
<a name="l00832"></a>00832 
<a name="l00833"></a><a class="code" href="namespaceoperations__research.html#0e9621c9c2973131800432eaa57818d5">00833</a> <span class="keywordtype">void</span> <a class="code" href="namespaceoperations__research.html#0e9621c9c2973131800432eaa57818d5">InternalSaveBooleanVarValue</a>(<a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> solver, <a class="code" href="classoperations__research_1_1IntVar.html" title="The class IntVar is a subset of IntExpr.">IntVar</a>* <span class="keyword">const</span> <a class="code" href="expr__array_8cc.html#472a99923cbe11ae7b5a5d157d9ad465">var</a>) {
<a name="l00834"></a>00834   solver-&gt;<a class="code" href="classoperations__research_1_1Solver.html#f47aeceae83d79198b467315ad3c75e4">trail_</a>-&gt;rev_boolvar_list_.push_back(var);
<a name="l00835"></a>00835 }
<a name="l00836"></a>00836 
<a name="l00837"></a>00837 <span class="comment">// ------------------ Search class -----------------</span>
<a name="l00838"></a>00838 
<a name="l00839"></a><a class="code" href="classoperations__research_1_1Search.html">00839</a> <span class="keyword">class </span><a class="code" href="classoperations__research_1_1Search.html" title="Search class.">Search</a> {
<a name="l00840"></a>00840  <span class="keyword">public</span>:
<a name="l00841"></a><a class="code" href="classoperations__research_1_1Search.html#4a8159adb90f38dbfda2efcace82d233">00841</a>   <span class="keyword">explicit</span> <a class="code" href="classoperations__research_1_1Search.html" title="Search class.">Search</a>(<a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> s)
<a name="l00842"></a>00842       : <a class="code" href="dependency__graph_8cc.html#bd6bfbf6753a5deb0ce273fad6408e1e">solver_</a>(s), marker_stack_(), fail_buffer_(), solution_counter_(0),
<a name="l00843"></a>00843         decision_builder_(NULL), created_by_solve_(false),
<a name="l00844"></a>00844         <a class="code" href="constraint__solver_8cc.html#9fd084fd29a29f05d55a27331bb63280">selector_</a>(NULL), search_depth_(0), left_search_depth_(0),
<a name="l00845"></a>00845         should_restart_(false), should_finish_(false),
<a name="l00846"></a>00846         sentinel_pushed_(0), jmpbuf_filled_(false) {}
<a name="l00847"></a>00847 
<a name="l00848"></a>00848   <span class="keywordtype">void</span> EnterSearch();
<a name="l00849"></a>00849   <span class="keywordtype">void</span> RestartSearch();
<a name="l00850"></a>00850   <span class="keywordtype">void</span> ExitSearch();
<a name="l00851"></a>00851   <span class="keywordtype">void</span> BeginNextDecision(<a class="code" href="classoperations__research_1_1DecisionBuilder.html" title="A DecisionBuilder is responsible for creating the search tree.">DecisionBuilder</a>* <span class="keyword">const</span> b);
<a name="l00852"></a>00852   <span class="keywordtype">void</span> EndNextDecision(<a class="code" href="classoperations__research_1_1DecisionBuilder.html" title="A DecisionBuilder is responsible for creating the search tree.">DecisionBuilder</a>* <span class="keyword">const</span> b, <a class="code" href="classoperations__research_1_1Decision.html" title="A Decision represents a choice point in the search tree.">Decision</a>* <span class="keyword">const</span> d);
<a name="l00853"></a>00853   <span class="keywordtype">void</span> ApplyDecision(<a class="code" href="classoperations__research_1_1Decision.html" title="A Decision represents a choice point in the search tree.">Decision</a>* <span class="keyword">const</span> d);
<a name="l00854"></a>00854   <span class="keywordtype">void</span> AfterDecision(<a class="code" href="classoperations__research_1_1Decision.html" title="A Decision represents a choice point in the search tree.">Decision</a>* <span class="keyword">const</span> d, <span class="keywordtype">bool</span> apply);
<a name="l00855"></a>00855   <span class="keywordtype">void</span> RefuteDecision(<a class="code" href="classoperations__research_1_1Decision.html" title="A Decision represents a choice point in the search tree.">Decision</a>* <span class="keyword">const</span> d);
<a name="l00856"></a>00856   <span class="keywordtype">void</span> BeginFail();
<a name="l00857"></a>00857   <span class="keywordtype">void</span> EndFail();
<a name="l00858"></a>00858   <span class="keywordtype">void</span> BeginInitialPropagation();
<a name="l00859"></a>00859   <span class="keywordtype">void</span> EndInitialPropagation();
<a name="l00860"></a>00860   <span class="keywordtype">bool</span> AtSolution();
<a name="l00861"></a>00861   <span class="keywordtype">bool</span> AcceptSolution();
<a name="l00862"></a>00862   <span class="keywordtype">void</span> NoMoreSolutions();
<a name="l00863"></a>00863   <span class="keywordtype">bool</span> LocalOptimum();
<a name="l00864"></a>00864   <span class="keywordtype">bool</span> AcceptDelta(<a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* <a class="code" href="resource_8cc.html#73461c37822b6ebb75b54ba1a9ffb442">delta</a>, <a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* deltadelta);
<a name="l00865"></a>00865   <span class="keywordtype">void</span> AcceptNeighbor();
<a name="l00866"></a>00866   <span class="keywordtype">void</span> PeriodicCheck();
<a name="l00867"></a>00867   <span class="keywordtype">void</span> Accept(<a class="code" href="classoperations__research_1_1ModelVisitor.html" title="Model visitor.">ModelVisitor</a>* <span class="keyword">const</span> visitor) <span class="keyword">const</span>;
<a name="l00868"></a>00868   <span class="keywordtype">void</span> push_monitor(<a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <span class="keyword">const</span> m);
<a name="l00869"></a>00869   <span class="keywordtype">void</span> Clear();
<a name="l00870"></a><a class="code" href="classoperations__research_1_1Search.html#2c42984a7ff88ebd0b51d37e43adc352">00870</a>   <span class="keywordtype">void</span> IncrementSolutionCounter() { ++solution_counter_; }
<a name="l00871"></a><a class="code" href="classoperations__research_1_1Search.html#2eb6d13dcbce28d116b399f5b7da3c10">00871</a>   int64 solution_counter()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> solution_counter_; }
<a name="l00872"></a><a class="code" href="classoperations__research_1_1Search.html#4b37a519f7faebaeb4b6be5c62757c2b">00872</a>   <span class="keywordtype">void</span> set_decision_builder(<a class="code" href="classoperations__research_1_1DecisionBuilder.html" title="A DecisionBuilder is responsible for creating the search tree.">DecisionBuilder</a>* <span class="keyword">const</span> db) {
<a name="l00873"></a>00873     decision_builder_ = db;
<a name="l00874"></a>00874   }
<a name="l00875"></a><a class="code" href="classoperations__research_1_1Search.html#c63b1e9d7e458a8833d948e1f1a293d2">00875</a>   <a class="code" href="classoperations__research_1_1DecisionBuilder.html" title="A DecisionBuilder is responsible for creating the search tree.">DecisionBuilder</a>* decision_builder()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> decision_builder_; }
<a name="l00876"></a><a class="code" href="classoperations__research_1_1Search.html#1fcd92000011aeb8f6dc5454bfba38a9">00876</a>   <span class="keywordtype">void</span> set_created_by_solve(<span class="keywordtype">bool</span> c) { created_by_solve_ = c; }
<a name="l00877"></a><a class="code" href="classoperations__research_1_1Search.html#79b3af967780427b6c44a8772f3567d0">00877</a>   <span class="keywordtype">bool</span> created_by_solve()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> created_by_solve_; }
<a name="l00878"></a>00878   <a class="code" href="classoperations__research_1_1Solver.html#5f87c832967334179f0f9c8d05380847">Solver::DecisionModification</a> ModifyDecision();
<a name="l00879"></a>00879   <span class="keywordtype">void</span> SetBranchSelector(
<a name="l00880"></a>00880       ResultCallback1&lt;Solver::DecisionModification, Solver*&gt;* <span class="keyword">const</span> s);
<a name="l00881"></a><a class="code" href="classoperations__research_1_1Search.html#b55c57687534c2850947b41dc3171f46">00881</a>   <span class="keywordtype">void</span> LeftMove() {
<a name="l00882"></a>00882     search_depth_++;
<a name="l00883"></a>00883     left_search_depth_++;
<a name="l00884"></a>00884   }
<a name="l00885"></a><a class="code" href="classoperations__research_1_1Search.html#0da30980d5c9c977186c5efbe671b7f1">00885</a>   <span class="keywordtype">void</span> RightMove() {
<a name="l00886"></a>00886     search_depth_++;
<a name="l00887"></a>00887   }
<a name="l00888"></a><a class="code" href="classoperations__research_1_1Search.html#26654e9a2a907f90fa37dd5585d509e5">00888</a>   <span class="keywordtype">int</span> search_depth()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> search_depth_; }
<a name="l00889"></a><a class="code" href="classoperations__research_1_1Search.html#1ff26a6a5c4835440aaeba8bbd92c0ec">00889</a>   <span class="keywordtype">void</span> set_search_depth(<span class="keywordtype">int</span> d) { search_depth_ = d; }
<a name="l00890"></a><a class="code" href="classoperations__research_1_1Search.html#af419d2ffa1078d7b8a0260103862525">00890</a>   <span class="keywordtype">int</span> left_search_depth()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> left_search_depth_; }
<a name="l00891"></a><a class="code" href="classoperations__research_1_1Search.html#578d5df848003bfa499f3547ce30b3c1">00891</a>   <span class="keywordtype">void</span> set_search_left_depth(<span class="keywordtype">int</span> d) { left_search_depth_ = d; }
<a name="l00892"></a><a class="code" href="classoperations__research_1_1Search.html#e6f39170dfd0cc811a75d43a449e1ba9">00892</a>   <span class="keywordtype">void</span> set_should_restart(<span class="keywordtype">bool</span> s) { should_restart_ = s; }
<a name="l00893"></a><a class="code" href="classoperations__research_1_1Search.html#096a692a55fb43267be4e48b56b16a08">00893</a>   <span class="keywordtype">bool</span> should_restart()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> should_restart_; }
<a name="l00894"></a><a class="code" href="classoperations__research_1_1Search.html#c8d6976508790637ceb0522654a8e126">00894</a>   <span class="keywordtype">void</span> set_should_finish(<span class="keywordtype">bool</span> s) { should_finish_ = s; }
<a name="l00895"></a><a class="code" href="classoperations__research_1_1Search.html#cb882bb5a1c696e8f555e3be64d46c3f">00895</a>   <span class="keywordtype">bool</span> should_finish()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> should_finish_; }
<a name="l00896"></a><a class="code" href="classoperations__research_1_1Search.html#2e6691a9e4597739ede2ec697e8746ed">00896</a>   <span class="keywordtype">void</span> CheckFail() {
<a name="l00897"></a>00897     <span class="keywordflow">if</span> (should_finish_ || should_restart_) {
<a name="l00898"></a>00898       <a class="code" href="dependency__graph_8cc.html#bd6bfbf6753a5deb0ce273fad6408e1e">solver_</a>-&gt;<a class="code" href="classoperations__research_1_1Solver.html#45534161a4dda7e1997bc0effd606648" title="Abandon the current branch in the search tree. A backtrack will follow.">Fail</a>();
<a name="l00899"></a>00899     }
<a name="l00900"></a>00900   }
<a name="l00901"></a><a class="code" href="classoperations__research_1_1Search.html#16432758b314f3cedad3fba81c895417">00901</a>   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>;
<a name="l00902"></a>00902  <span class="keyword">private</span>:
<a name="l00903"></a>00903   <span class="comment">// Jumps back to the previous choice point, Checks if it was correctly set.</span>
<a name="l00904"></a>00904   <span class="keywordtype">void</span> JumpBack();
<a name="l00905"></a>00905   <span class="keywordtype">void</span> ClearBuffer() {
<a name="l00906"></a>00906     CHECK(jmpbuf_filled_) &lt;&lt; <span class="stringliteral">"Internal error in backtracking"</span>;
<a name="l00907"></a>00907     jmpbuf_filled_ = <span class="keyword">false</span>;
<a name="l00908"></a>00908   }
<a name="l00909"></a>00909 
<a name="l00910"></a>00910   <a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> <a class="code" href="dependency__graph_8cc.html#bd6bfbf6753a5deb0ce273fad6408e1e">solver_</a>;
<a name="l00911"></a>00911   std::vector&lt;StateMarker*&gt; marker_stack_;
<a name="l00912"></a>00912   std::vector&lt;SearchMonitor*&gt; <a class="code" href="local__search_8cc.html#9d84fc009216df22096caf7925401b19">monitors_</a>;
<a name="l00913"></a>00913   jmp_buf fail_buffer_;
<a name="l00914"></a>00914   int64 solution_counter_;
<a name="l00915"></a>00915   <a class="code" href="classoperations__research_1_1DecisionBuilder.html" title="A DecisionBuilder is responsible for creating the search tree.">DecisionBuilder</a>* decision_builder_;
<a name="l00916"></a>00916   <span class="keywordtype">bool</span> created_by_solve_;
<a name="l00917"></a>00917   scoped_ptr&lt;ResultCallback1&lt;Solver::DecisionModification, Solver*&gt; &gt; <a class="code" href="constraint__solver_8cc.html#9fd084fd29a29f05d55a27331bb63280">selector_</a>;
<a name="l00918"></a>00918   <span class="keywordtype">int</span> search_depth_;
<a name="l00919"></a>00919   <span class="keywordtype">int</span> left_search_depth_;
<a name="l00920"></a>00920   <span class="keywordtype">bool</span> should_restart_;
<a name="l00921"></a>00921   <span class="keywordtype">bool</span> should_finish_;
<a name="l00922"></a>00922   <span class="keywordtype">int</span> sentinel_pushed_;
<a name="l00923"></a>00923   <span class="keywordtype">bool</span> jmpbuf_filled_;
<a name="l00924"></a>00924 };
<a name="l00925"></a>00925 
<a name="l00926"></a>00926 <span class="comment">// Backtrack is implemented using 3 primitives:</span>
<a name="l00927"></a>00927 <span class="comment">// CP_TRY to start searching</span>
<a name="l00928"></a>00928 <span class="comment">// CP_DO_FAIL to signal a failure. The program will continue on the CP_ON_FAIL</span>
<a name="l00929"></a>00929 <span class="comment">// primitive.</span>
<a name="l00930"></a>00930 <span class="comment">// CP_FAST_BACKTRACK protects an implementation of backtrack using</span>
<a name="l00931"></a>00931 <span class="comment">// setjmp/longjmp.  The clean portable way is to use exceptions,</span>
<a name="l00932"></a>00932 <span class="comment">// unfortunately, it can be much slower.  Thus we use ideas from</span>
<a name="l00933"></a>00933 <span class="comment">// Prolog, CP/CLP implementations, continuations in C and implement failing</span>
<a name="l00934"></a>00934 <span class="comment">// and backtracking using setjmp/longjmp.</span>
<a name="l00935"></a><a class="code" href="constraint__solver_8cc.html#6fefff344468722cbdd7e1776ea5c806">00935</a> <span class="preprocessor">#define CP_FAST_BACKTRACK</span>
<a name="l00936"></a>00936 <span class="preprocessor"></span><span class="preprocessor">#if defined(CP_FAST_BACKTRACK)</span>
<a name="l00937"></a>00937 <span class="preprocessor"></span><span class="comment">// We cannot use a method/function for this as we would lose the</span>
<a name="l00938"></a>00938 <span class="comment">// context in the setjmp implementation.</span>
<a name="l00939"></a><a class="code" href="constraint__solver_8cc.html#458c844702d69839c667500d86ae49c8">00939</a> <span class="preprocessor">#define CP_TRY(search)                                              \</span>
<a name="l00940"></a>00940 <span class="preprocessor">  CHECK(!search-&gt;jmpbuf_filled_) &lt;&lt; "Fail() called outside search"; \</span>
<a name="l00941"></a>00941 <span class="preprocessor">  search-&gt;jmpbuf_filled_ = true;                                    \</span>
<a name="l00942"></a>00942 <span class="preprocessor">  if (setjmp(search-&gt;fail_buffer_) == 0)</span>
<a name="l00943"></a><a class="code" href="constraint__solver_8cc.html#40910cf9a9eb89daac6c929006a03416">00943</a> <span class="preprocessor"></span><span class="preprocessor">#define CP_ON_FAIL else</span>
<a name="l00944"></a><a class="code" href="constraint__solver_8cc.html#61301f951c309e0078fcaa570fa0e262">00944</a> <span class="preprocessor"></span><span class="preprocessor">#define CP_DO_FAIL(search) longjmp(search-&gt;fail_buffer_, 1)</span>
<a name="l00945"></a>00945 <span class="preprocessor"></span><span class="preprocessor">#else  // CP_FAST_BACKTRACK</span>
<a name="l00946"></a>00946 <span class="preprocessor"></span><span class="keyword">class </span>FailException {};
<a name="l00947"></a>00947 <span class="preprocessor">#define CP_TRY(search)                                                 \</span>
<a name="l00948"></a>00948 <span class="preprocessor">  CHECK(!search-&gt;jmpbuf_filled_) &lt;&lt; "Fail() called outside search";    \</span>
<a name="l00949"></a>00949 <span class="preprocessor">  search-&gt;jmpbuf_filled_ = true;                                       \</span>
<a name="l00950"></a>00950 <span class="preprocessor">  try</span>
<a name="l00951"></a>00951 <span class="preprocessor"></span><span class="preprocessor">#define CP_ON_FAIL catch(FailException&amp;)</span>
<a name="l00952"></a>00952 <span class="preprocessor"></span><span class="preprocessor">#define CP_DO_FAIL(search) throw FailException()</span>
<a name="l00953"></a>00953 <span class="preprocessor"></span><span class="preprocessor">#endif  // CP_FAST_BACKTRACK</span>
<a name="l00954"></a>00954 <span class="preprocessor"></span>
<a name="l00955"></a>00955 <span class="keywordtype">void</span> Search::JumpBack() {
<a name="l00956"></a>00956   ClearBuffer();
<a name="l00957"></a>00957   <a class="code" href="constraint__solver_8cc.html#61301f951c309e0078fcaa570fa0e262" title="CP_FAST_BACKTRACK.">CP_DO_FAIL</a>(<span class="keyword">this</span>);
<a name="l00958"></a>00958 }
<a name="l00959"></a>00959 
<a name="l00960"></a>00960 Search* Solver::ActiveSearch()<span class="keyword"> const </span>{
<a name="l00961"></a>00961   <span class="keywordflow">switch</span> (<a class="code" href="local__search_8cc.html#80151e3e5119fd23f5c8bd4125dafc11">state_</a>) {
<a name="l00962"></a>00962     <span class="keywordflow">case</span> IN_SEARCH:
<a name="l00963"></a>00963       <span class="keywordflow">return</span> searches_.back();
<a name="l00964"></a>00964     <span class="keywordflow">default</span>:
<a name="l00965"></a>00965       <span class="keywordflow">return</span> NULL;
<a name="l00966"></a>00966   }
<a name="l00967"></a>00967 }
<a name="l00968"></a>00968 
<a name="l00969"></a><a class="code" href="classoperations__research_1_1Solver.html#765c2fb7dcc5830caac346839066d2a2">00969</a> <span class="keyword">namespace </span>{
<a name="l00970"></a>00970 <span class="keyword">class </span>UndoBranchSelector : <span class="keyword">public</span> <a class="code" href="classoperations__research_1_1Action.html" title="An action is the base callback method.">Action</a> {
<a name="l00971"></a>00971  <span class="keyword">public</span>:
<a name="l00972"></a>00972   <span class="keyword">explicit</span> UndoBranchSelector(<span class="keywordtype">int</span> depth) : <a class="code" href="constraint__solver_8cc.html#d44441440d13feeced3a5592d8853ce8">depth_</a>(depth) {}
<a name="l00973"></a>00973   <span class="keyword">virtual</span> ~UndoBranchSelector() {}
<a name="l00974"></a>00974   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Action.html#d01804a870fc0d8634a13e9a305a5bf8" title="The main callback of the class.">Run</a>(<a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> s) {
<a name="l00975"></a>00975     <span class="keywordflow">if</span> (s-&gt;<a class="code" href="classoperations__research_1_1Solver.html#0f605fdb1307a1ac4931e6a181c9e154" title="Gets the number of nested searches.">SolveDepth</a>() == <a class="code" href="constraint__solver_8cc.html#d44441440d13feeced3a5592d8853ce8">depth_</a>) {
<a name="l00976"></a>00976       s-&gt;<a class="code" href="classoperations__research_1_1Solver.html#765c2fb7dcc5830caac346839066d2a2" title="Returns the active search, NULL outside search.">ActiveSearch</a>()-&gt;<a class="code" href="classoperations__research_1_1Search.html#cc7c99d8cdb8c6ab2b6c3ba6ab04df1e" title="namespace">SetBranchSelector</a>(NULL);
<a name="l00977"></a>00977     }
<a name="l00978"></a>00978   }
<a name="l00979"></a>00979   <span class="keyword">virtual</span> <span class="keywordtype">string</span> <a class="code" href="classoperations__research_1_1Action.html#47ea9f9072ca2eb9861b92858c38e11f" title="Action class.">DebugString</a>()<span class="keyword"> const </span>{
<a name="l00980"></a>00980     <span class="keywordflow">return</span> StringPrintf(<span class="stringliteral">"UndoBranchSelector(%i)"</span>, <a class="code" href="constraint__solver_8cc.html#d44441440d13feeced3a5592d8853ce8">depth_</a>);
<a name="l00981"></a>00981   }
<a name="l00982"></a>00982  <span class="keyword">private</span>:
<a name="l00983"></a>00983   <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="constraint__solver_8cc.html#d44441440d13feeced3a5592d8853ce8">depth_</a>;
<a name="l00984"></a>00984 };
<a name="l00985"></a>00985 
<a name="l00986"></a>00986 <span class="keyword">class </span>ApplyBranchSelector : <span class="keyword">public</span> <a class="code" href="classoperations__research_1_1DecisionBuilder.html" title="A DecisionBuilder is responsible for creating the search tree.">DecisionBuilder</a> {
<a name="l00987"></a>00987  <span class="keyword">public</span>:
<a name="l00988"></a>00988   <span class="keyword">explicit</span> ApplyBranchSelector(
<a name="l00989"></a>00989       ResultCallback1&lt;Solver::DecisionModification, Solver*&gt;* <span class="keyword">const</span> bs)
<a name="l00990"></a>00990       : <a class="code" href="constraint__solver_8cc.html#9fd084fd29a29f05d55a27331bb63280">selector_</a>(bs) {}
<a name="l00991"></a>00991   <span class="keyword">virtual</span> ~ApplyBranchSelector() {}
<a name="l00992"></a><a class="code" href="constraint__solver_8cc.html#d44441440d13feeced3a5592d8853ce8">00992</a> 
<a name="l00993"></a>00993   <span class="keyword">virtual</span> Decision* <a class="code" href="classoperations__research_1_1DecisionBuilder.html#3bcaa4dd991e8ddb4d0e48cfbca58592" title="This is the main method of the decision builder class.">Next</a>(Solver* <span class="keyword">const</span> s) {
<a name="l00994"></a>00994     s-&gt;SetBranchSelector(<a class="code" href="constraint__solver_8cc.html#9fd084fd29a29f05d55a27331bb63280">selector_</a>);
<a name="l00995"></a>00995     <span class="keywordflow">return</span> NULL;
<a name="l00996"></a>00996   }
<a name="l00997"></a>00997 
<a name="l00998"></a>00998   <span class="keyword">virtual</span> <span class="keywordtype">string</span> <a class="code" href="classoperations__research_1_1DecisionBuilder.html#b40ddf22d94afceffdf966b2e4a5e60d" title="Decision Builder.">DebugString</a>()<span class="keyword"> const </span>{
<a name="l00999"></a>00999     <span class="keywordflow">return</span> <span class="stringliteral">"Apply(BranchSelector)"</span>;
<a name="l01000"></a>01000   }
<a name="l01001"></a>01001  <span class="keyword">private</span>:
<a name="l01002"></a>01002   ResultCallback1&lt;Solver::DecisionModification, Solver*&gt;* <span class="keyword">const</span> <a class="code" href="constraint__solver_8cc.html#9fd084fd29a29f05d55a27331bb63280">selector_</a>;
<a name="l01003"></a>01003 };
<a name="l01004"></a>01004 }  <span class="comment">// namespace</span>
<a name="l01005"></a>01005 
<a name="l01006"></a>01006 <span class="keywordtype">void</span> Search::SetBranchSelector(
<a name="l01007"></a>01007     ResultCallback1&lt;Solver::DecisionModification, Solver*&gt;* <span class="keyword">const</span> bs) {
<a name="l01008"></a>01008   CHECK(bs == <a class="code" href="constraint__solver_8cc.html#9fd084fd29a29f05d55a27331bb63280">selector_</a> || <a class="code" href="constraint__solver_8cc.html#9fd084fd29a29f05d55a27331bb63280">selector_</a> == NULL || bs == NULL);
<a name="l01009"></a>01009   <span class="keywordflow">if</span> (<a class="code" href="constraint__solver_8cc.html#9fd084fd29a29f05d55a27331bb63280">selector_</a> != bs) {
<a name="l01010"></a>01010     <a class="code" href="constraint__solver_8cc.html#9fd084fd29a29f05d55a27331bb63280">selector_</a>.reset(bs);
<a name="l01011"></a><a class="code" href="constraint__solver_8cc.html#9fd084fd29a29f05d55a27331bb63280">01011</a>   }
<a name="l01012"></a>01012 }
<a name="l01013"></a>01013 
<a name="l01014"></a>01014 <span class="keywordtype">void</span> Solver::SetBranchSelector(
<a name="l01015"></a><a class="code" href="classoperations__research_1_1Search.html#cc7c99d8cdb8c6ab2b6c3ba6ab04df1e">01015</a>     ResultCallback1&lt;Solver::DecisionModification, Solver*&gt;* <span class="keyword">const</span> bs) {
<a name="l01016"></a>01016   bs-&gt;CheckIsRepeatable();
<a name="l01017"></a>01017   <span class="keywordflow">if</span> (searches_.size() &gt; 0 &amp;&amp; searches_.back() != NULL) {
<a name="l01018"></a>01018     <span class="comment">// We cannot use the trail as the search can be nested and thus</span>
<a name="l01019"></a>01019     <span class="comment">// deleted upon backtrack. Thus we guard the undo action by a</span>
<a name="l01020"></a>01020     <span class="comment">// check on the number of nesting of solve().</span>
<a name="l01021"></a>01021     AddBacktrackAction(RevAlloc(<span class="keyword">new</span> UndoBranchSelector(searches_.size())),
<a name="l01022"></a>01022                        <span class="keyword">false</span>);
<a name="l01023"></a><a class="code" href="classoperations__research_1_1Solver.html#b41a0969e90e13da5e75476eef9d705e">01023</a>     searches_.back()-&gt;SetBranchSelector(bs);
<a name="l01024"></a>01024   }
<a name="l01025"></a>01025 }
<a name="l01026"></a>01026 
<a name="l01027"></a>01027 DecisionBuilder* <a class="code" href="classoperations__research_1_1Solver.html#5801021363a9d2e8ca295ea388292876" title="Creates a decision builder that will set the branch selector.">Solver::MakeApplyBranchSelector</a>(
<a name="l01028"></a>01028     ResultCallback1&lt;Solver::DecisionModification, Solver*&gt;* <span class="keyword">const</span> bs) {
<a name="l01029"></a>01029   <span class="keywordflow">return</span> <a class="code" href="classoperations__research_1_1Solver.html#83ceb54f811483fd1c0444cddba8a600" title="The RevAlloc method stores the corresponding object in a stack.">RevAlloc</a>(<span class="keyword">new</span> ApplyBranchSelector(bs));
<a name="l01030"></a>01030 }
<a name="l01031"></a>01031 
<a name="l01032"></a>01032 <span class="keywordtype">int</span> <a class="code" href="classoperations__research_1_1Solver.html#0f605fdb1307a1ac4931e6a181c9e154" title="Gets the number of nested searches.">Solver::SolveDepth</a>()<span class="keyword"> const </span>{
<a name="l01033"></a>01033   <span class="keywordflow">switch</span> (state_) {
<a name="l01034"></a>01034     <span class="keywordflow">case</span> <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a95066908e143fd988a03767f05e682acaf" title="Executing the search code.">IN_SEARCH</a>:
<a name="l01035"></a>01035       <span class="keywordflow">return</span> searches_.size();
<a name="l01036"></a><a class="code" href="classoperations__research_1_1Solver.html#5801021363a9d2e8ca295ea388292876">01036</a>     <span class="keywordflow">default</span>:
<a name="l01037"></a>01037       <span class="keywordflow">return</span> 0;
<a name="l01038"></a>01038   }
<a name="l01039"></a>01039 }
<a name="l01040"></a>01040 
<a name="l01041"></a><a class="code" href="classoperations__research_1_1Solver.html#0f605fdb1307a1ac4931e6a181c9e154">01041</a> <span class="keywordtype">int</span> <a class="code" href="classoperations__research_1_1Solver.html#14dc7b55e3664d49fc59a90044bf6fdc" title="Gets the search depth of the current active search.">Solver::SearchDepth</a>()<span class="keyword"> const </span>{
<a name="l01042"></a>01042   <span class="keywordflow">if</span> (searches_.size() &gt; 0 &amp;&amp; searches_.back() != NULL) {
<a name="l01043"></a>01043     <span class="keywordflow">return</span> searches_.back()-&gt;search_depth();
<a name="l01044"></a>01044   }
<a name="l01045"></a>01045   <span class="keywordflow">return</span> -1;
<a name="l01046"></a>01046 }
<a name="l01047"></a>01047 
<a name="l01048"></a>01048 <span class="keywordtype">int</span> <a class="code" href="classoperations__research_1_1Solver.html#28506c5cdd51070a0bd38534dbc40c51" title="Gets the search left depth of the current active search.">Solver::SearchLeftDepth</a>()<span class="keyword"> const </span>{
<a name="l01049"></a>01049   <span class="keywordflow">if</span> (searches_.size() &gt; 0 &amp;&amp; searches_.back() != NULL) {
<a name="l01050"></a><a class="code" href="classoperations__research_1_1Solver.html#14dc7b55e3664d49fc59a90044bf6fdc">01050</a>     <span class="keywordflow">return</span> searches_.back()-&gt;left_search_depth();
<a name="l01051"></a>01051   }
<a name="l01052"></a>01052   <span class="keywordflow">return</span> -1;
<a name="l01053"></a>01053 }
<a name="l01054"></a>01054 
<a name="l01055"></a>01055 <a class="code" href="classoperations__research_1_1Solver.html#5f87c832967334179f0f9c8d05380847">Solver::DecisionModification</a> <a class="code" href="classoperations__research_1_1Search.html#afd69327361f5242cc981094f5064900">Search::ModifyDecision</a>() {
<a name="l01056"></a>01056   <span class="keywordflow">if</span> (<a class="code" href="constraint__solver_8cc.html#9fd084fd29a29f05d55a27331bb63280">selector_</a> != NULL) {
<a name="l01057"></a><a class="code" href="classoperations__research_1_1Solver.html#28506c5cdd51070a0bd38534dbc40c51">01057</a>     <span class="keywordflow">return</span> <a class="code" href="constraint__solver_8cc.html#9fd084fd29a29f05d55a27331bb63280">selector_</a>-&gt;Run(<a class="code" href="dependency__graph_8cc.html#bd6bfbf6753a5deb0ce273fad6408e1e">solver_</a>);
<a name="l01058"></a>01058   }
<a name="l01059"></a>01059   <span class="keywordflow">return</span> <a class="code" href="classoperations__research_1_1Solver.html#5f87c832967334179f0f9c8d05380847a8dfadb94521ac7979525ae94f618d57">Solver::NO_CHANGE</a>;
<a name="l01060"></a>01060 }
<a name="l01061"></a>01061 
<a name="l01062"></a>01062 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Search.html#b75f27d7740f8a0d5428878f589c0b49">Search::push_monitor</a>(<a class="code" href="classoperations__research_1_1Solver.html#ac32a6eabe1d316d7ff5f92fedd1ec5b">SearchMonitor</a>* <span class="keyword">const</span> m) {
<a name="l01063"></a>01063   <span class="keywordflow">if</span> (m) {
<a name="l01064"></a><a class="code" href="classoperations__research_1_1Search.html#afd69327361f5242cc981094f5064900">01064</a>     <a class="code" href="local__search_8cc.html#9d84fc009216df22096caf7925401b19">monitors_</a>.push_back(m);
<a name="l01065"></a>01065   }
<a name="l01066"></a>01066 }
<a name="l01067"></a>01067 
<a name="l01068"></a>01068 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Search.html#7768604c0fbc85bc05b12d8d0da745b0">Search::Clear</a>() {
<a name="l01069"></a>01069   monitors_.clear();
<a name="l01070"></a>01070   search_depth_ = 0;
<a name="l01071"></a><a class="code" href="classoperations__research_1_1Search.html#b75f27d7740f8a0d5428878f589c0b49">01071</a>   left_search_depth_ = 0;
<a name="l01072"></a>01072   selector_.reset(NULL);
<a name="l01073"></a>01073 }
<a name="l01074"></a>01074 
<a name="l01075"></a>01075 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Search.html#b3a81afa65291b9bdd3f3a168ce55aa4">Search::EnterSearch</a>() {
<a name="l01076"></a>01076   <span class="comment">// The solution counter is reset when entering search and not when</span>
<a name="l01077"></a><a class="code" href="classoperations__research_1_1Search.html#7768604c0fbc85bc05b12d8d0da745b0">01077</a>   <span class="comment">// leaving search. This enables the information to persist outside of</span>
<a name="l01078"></a>01078   <span class="comment">// top-level search.</span>
<a name="l01079"></a>01079   solution_counter_ = 0;
<a name="l01080"></a>01080 
<a name="l01081"></a>01081   <span class="keywordflow">for</span> (std::vector&lt;SearchMonitor*&gt;::iterator it = monitors_.begin();
<a name="l01082"></a>01082        it != monitors_.end();
<a name="l01083"></a>01083        ++it) {
<a name="l01084"></a><a class="code" href="classoperations__research_1_1Search.html#b3a81afa65291b9bdd3f3a168ce55aa4">01084</a>     (*it)-&gt;EnterSearch();
<a name="l01085"></a>01085   }
<a name="l01086"></a>01086 }
<a name="l01087"></a>01087 
<a name="l01088"></a>01088 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Search.html#b6c851370a6efe0318b8d4b9c71a85ed">Search::ExitSearch</a>() {
<a name="l01089"></a>01089   <span class="keywordflow">for</span> (std::vector&lt;SearchMonitor*&gt;::iterator it = monitors_.begin();
<a name="l01090"></a>01090        it != monitors_.end();
<a name="l01091"></a>01091        ++it) {
<a name="l01092"></a>01092     (*it)-&gt;ExitSearch();
<a name="l01093"></a>01093   }
<a name="l01094"></a>01094 }
<a name="l01095"></a>01095 
<a name="l01096"></a>01096 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Search.html#c6366ad1cb26f567fe888ff8cc254a63">Search::RestartSearch</a>() {
<a name="l01097"></a><a class="code" href="classoperations__research_1_1Search.html#b6c851370a6efe0318b8d4b9c71a85ed">01097</a>   <span class="keywordflow">for</span> (std::vector&lt;SearchMonitor*&gt;::iterator it = monitors_.begin();
<a name="l01098"></a>01098        it != monitors_.end();
<a name="l01099"></a>01099        ++it) {
<a name="l01100"></a>01100     (*it)-&gt;RestartSearch();
<a name="l01101"></a>01101   }
<a name="l01102"></a>01102 }
<a name="l01103"></a>01103 
<a name="l01104"></a>01104 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Search.html#ea34d6d09da7f3d264f84d5502414da0">Search::BeginNextDecision</a>(DecisionBuilder* <span class="keyword">const</span> db) {
<a name="l01105"></a><a class="code" href="classoperations__research_1_1Search.html#c6366ad1cb26f567fe888ff8cc254a63">01105</a>   <span class="keywordflow">for</span> (std::vector&lt;SearchMonitor*&gt;::iterator it = monitors_.begin();
<a name="l01106"></a>01106        it != monitors_.end();
<a name="l01107"></a>01107        ++it) {
<a name="l01108"></a>01108     (*it)-&gt;BeginNextDecision(db);
<a name="l01109"></a>01109   }
<a name="l01110"></a>01110   <a class="code" href="classoperations__research_1_1Search.html#2e6691a9e4597739ede2ec697e8746ed">CheckFail</a>();
<a name="l01111"></a>01111 }
<a name="l01112"></a>01112 
<a name="l01113"></a><a class="code" href="classoperations__research_1_1Search.html#ea34d6d09da7f3d264f84d5502414da0">01113</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Search.html#fb04411efa806e4d8da60b47750357a3">Search::EndNextDecision</a>(<a class="code" href="classoperations__research_1_1DecisionBuilder.html" title="A DecisionBuilder is responsible for creating the search tree.">DecisionBuilder</a>* <span class="keyword">const</span> db, <a class="code" href="classoperations__research_1_1Decision.html" title="A Decision represents a choice point in the search tree.">Decision</a>* <span class="keyword">const</span> d) {
<a name="l01114"></a>01114   <span class="keywordflow">for</span> (std::vector&lt;SearchMonitor*&gt;::iterator it = monitors_.begin();
<a name="l01115"></a>01115        it != monitors_.end();
<a name="l01116"></a>01116        ++it) {
<a name="l01117"></a>01117     (*it)-&gt;EndNextDecision(db, d);
<a name="l01118"></a>01118   }
<a name="l01119"></a>01119   <a class="code" href="classoperations__research_1_1Search.html#2e6691a9e4597739ede2ec697e8746ed">CheckFail</a>();
<a name="l01120"></a>01120 }
<a name="l01121"></a>01121 
<a name="l01122"></a><a class="code" href="classoperations__research_1_1Search.html#fb04411efa806e4d8da60b47750357a3">01122</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Search.html#fb4b1e39a8f2bfdabb87b445fef0a1ca">Search::ApplyDecision</a>(<a class="code" href="classoperations__research_1_1Decision.html" title="A Decision represents a choice point in the search tree.">Decision</a>* <span class="keyword">const</span> d) {
<a name="l01123"></a>01123   <span class="keywordflow">for</span> (std::vector&lt;SearchMonitor*&gt;::iterator it = monitors_.begin();
<a name="l01124"></a>01124        it != monitors_.end();
<a name="l01125"></a>01125        ++it) {
<a name="l01126"></a>01126     (*it)-&gt;ApplyDecision(d);
<a name="l01127"></a>01127   }
<a name="l01128"></a>01128   <a class="code" href="classoperations__research_1_1Search.html#2e6691a9e4597739ede2ec697e8746ed">CheckFail</a>();
<a name="l01129"></a>01129 }
<a name="l01130"></a>01130 
<a name="l01131"></a><a class="code" href="classoperations__research_1_1Search.html#fb4b1e39a8f2bfdabb87b445fef0a1ca">01131</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Search.html#86094dde74cc625735aa2f87daee7ed0">Search::AfterDecision</a>(<a class="code" href="classoperations__research_1_1Decision.html" title="A Decision represents a choice point in the search tree.">Decision</a>* <span class="keyword">const</span> d, <span class="keywordtype">bool</span> apply) {
<a name="l01132"></a>01132   <span class="keywordflow">for</span> (std::vector&lt;SearchMonitor*&gt;::iterator it = monitors_.begin();
<a name="l01133"></a>01133        it != monitors_.end();
<a name="l01134"></a>01134        ++it) {
<a name="l01135"></a>01135     (*it)-&gt;AfterDecision(d, apply);
<a name="l01136"></a>01136   }
<a name="l01137"></a>01137   <a class="code" href="classoperations__research_1_1Search.html#2e6691a9e4597739ede2ec697e8746ed">CheckFail</a>();
<a name="l01138"></a>01138 }
<a name="l01139"></a>01139 
<a name="l01140"></a><a class="code" href="classoperations__research_1_1Search.html#86094dde74cc625735aa2f87daee7ed0">01140</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Search.html#fdaa6f24db0d9192cee6e02d14084262">Search::RefuteDecision</a>(<a class="code" href="classoperations__research_1_1Decision.html" title="A Decision represents a choice point in the search tree.">Decision</a>* <span class="keyword">const</span> d) {
<a name="l01141"></a>01141   <span class="keywordflow">for</span> (std::vector&lt;SearchMonitor*&gt;::iterator it = monitors_.begin();
<a name="l01142"></a>01142        it != monitors_.end();
<a name="l01143"></a>01143        ++it) {
<a name="l01144"></a>01144     (*it)-&gt;RefuteDecision(d);
<a name="l01145"></a>01145   }
<a name="l01146"></a>01146   <a class="code" href="classoperations__research_1_1Search.html#2e6691a9e4597739ede2ec697e8746ed">CheckFail</a>();
<a name="l01147"></a>01147 }
<a name="l01148"></a>01148 
<a name="l01149"></a><a class="code" href="classoperations__research_1_1Search.html#fdaa6f24db0d9192cee6e02d14084262">01149</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Search.html#2727bfb415bf86bcc2b07dbad57c1142">Search::BeginFail</a>() {
<a name="l01150"></a>01150   <span class="keywordflow">for</span> (std::vector&lt;SearchMonitor*&gt;::iterator it = monitors_.begin();
<a name="l01151"></a>01151        it != monitors_.end();
<a name="l01152"></a>01152        ++it) {
<a name="l01153"></a>01153     (*it)-&gt;BeginFail();
<a name="l01154"></a>01154   }
<a name="l01155"></a>01155 }
<a name="l01156"></a>01156 
<a name="l01157"></a>01157 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Search.html#eb0a7901d42bd0cb246f26e118ee8454">Search::EndFail</a>() {
<a name="l01158"></a><a class="code" href="classoperations__research_1_1Search.html#2727bfb415bf86bcc2b07dbad57c1142">01158</a>   <span class="keywordflow">for</span> (std::vector&lt;SearchMonitor*&gt;::iterator it = monitors_.begin();
<a name="l01159"></a>01159        it != monitors_.end();
<a name="l01160"></a>01160        ++it) {
<a name="l01161"></a>01161     (*it)-&gt;EndFail();
<a name="l01162"></a>01162   }
<a name="l01163"></a>01163 }
<a name="l01164"></a>01164 
<a name="l01165"></a>01165 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Search.html#a6ccaf4a499ea8a40495f2e608e9d553">Search::BeginInitialPropagation</a>() {
<a name="l01166"></a><a class="code" href="classoperations__research_1_1Search.html#eb0a7901d42bd0cb246f26e118ee8454">01166</a>   <span class="keywordflow">for</span> (std::vector&lt;SearchMonitor*&gt;::iterator it = monitors_.begin();
<a name="l01167"></a>01167        it != monitors_.end();
<a name="l01168"></a>01168        ++it) {
<a name="l01169"></a>01169     (*it)-&gt;BeginInitialPropagation();
<a name="l01170"></a>01170   }
<a name="l01171"></a>01171 }
<a name="l01172"></a>01172 
<a name="l01173"></a>01173 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Search.html#8080b25049761226f4d6c4f7e00e0709">Search::EndInitialPropagation</a>() {
<a name="l01174"></a><a class="code" href="classoperations__research_1_1Search.html#a6ccaf4a499ea8a40495f2e608e9d553">01174</a>   <span class="keywordflow">for</span> (std::vector&lt;SearchMonitor*&gt;::iterator it = monitors_.begin();
<a name="l01175"></a>01175        it != monitors_.end();
<a name="l01176"></a>01176        ++it) {
<a name="l01177"></a>01177     (*it)-&gt;EndInitialPropagation();
<a name="l01178"></a>01178   }
<a name="l01179"></a>01179 }
<a name="l01180"></a>01180 
<a name="l01181"></a>01181 <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1Search.html#bf4066e10d0f2e2bb8452e9c5ebedf8b">Search::AcceptSolution</a>() {
<a name="l01182"></a><a class="code" href="classoperations__research_1_1Search.html#8080b25049761226f4d6c4f7e00e0709">01182</a>   <span class="keywordtype">bool</span> valid = <span class="keyword">true</span>;
<a name="l01183"></a>01183   <span class="keywordflow">for</span> (std::vector&lt;SearchMonitor*&gt;::iterator it = monitors_.begin();
<a name="l01184"></a>01184        it != monitors_.end();
<a name="l01185"></a>01185        ++it) {
<a name="l01186"></a>01186     <span class="keywordflow">if</span> (!(*it)-&gt;AcceptSolution()) {
<a name="l01187"></a>01187       valid = <span class="keyword">false</span>;
<a name="l01188"></a>01188     }
<a name="l01189"></a>01189   }
<a name="l01190"></a><a class="code" href="classoperations__research_1_1Search.html#bf4066e10d0f2e2bb8452e9c5ebedf8b">01190</a>   <span class="keywordflow">return</span> valid;
<a name="l01191"></a>01191 }
<a name="l01192"></a>01192 
<a name="l01193"></a>01193 <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1Search.html#1223d31a66d8516f2dbcc7088ab2dd0e">Search::AtSolution</a>() {
<a name="l01194"></a>01194   <span class="keywordtype">bool</span> should_continue = <span class="keyword">false</span>;
<a name="l01195"></a>01195   <span class="keywordflow">for</span> (std::vector&lt;SearchMonitor*&gt;::iterator it = monitors_.begin();
<a name="l01196"></a>01196        it != monitors_.end();
<a name="l01197"></a>01197        ++it) {
<a name="l01198"></a>01198     <span class="keywordflow">if</span> ((*it)-&gt;AtSolution()) {
<a name="l01199"></a>01199       should_continue = <span class="keyword">true</span>;
<a name="l01200"></a>01200     }
<a name="l01201"></a>01201   }
<a name="l01202"></a><a class="code" href="classoperations__research_1_1Search.html#1223d31a66d8516f2dbcc7088ab2dd0e">01202</a>   <span class="keywordflow">return</span> should_continue;
<a name="l01203"></a>01203 }
<a name="l01204"></a>01204 
<a name="l01205"></a>01205 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Search.html#c3d7a10701d0f27c98c96d1888ac9bbc">Search::NoMoreSolutions</a>() {
<a name="l01206"></a>01206   <span class="keywordflow">for</span> (std::vector&lt;SearchMonitor*&gt;::iterator it = monitors_.begin();
<a name="l01207"></a>01207        it != monitors_.end();
<a name="l01208"></a>01208        ++it) {
<a name="l01209"></a>01209     (*it)-&gt;NoMoreSolutions();
<a name="l01210"></a>01210   }
<a name="l01211"></a>01211 }
<a name="l01212"></a>01212 
<a name="l01213"></a>01213 <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1Search.html#346508b5222d06d807af16c188bb30e5">Search::LocalOptimum</a>() {
<a name="l01214"></a><a class="code" href="classoperations__research_1_1Search.html#c3d7a10701d0f27c98c96d1888ac9bbc">01214</a>   <span class="keywordtype">bool</span> res = <span class="keyword">false</span>;
<a name="l01215"></a>01215   <span class="keywordflow">for</span> (std::vector&lt;SearchMonitor*&gt;::iterator it = monitors_.begin();
<a name="l01216"></a>01216        it != monitors_.end();
<a name="l01217"></a>01217        ++it) {
<a name="l01218"></a>01218     <span class="keywordflow">if</span> ((*it)-&gt;LocalOptimum()) {
<a name="l01219"></a>01219       res = <span class="keyword">true</span>;
<a name="l01220"></a>01220     }
<a name="l01221"></a>01221   }
<a name="l01222"></a><a class="code" href="classoperations__research_1_1Search.html#346508b5222d06d807af16c188bb30e5">01222</a>   <span class="keywordflow">return</span> res;
<a name="l01223"></a>01223 }
<a name="l01224"></a>01224 
<a name="l01225"></a>01225 <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1Search.html#44a0b488d0c0df43d6bea1606a30f85d">Search::AcceptDelta</a>(<a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* <a class="code" href="resource_8cc.html#73461c37822b6ebb75b54ba1a9ffb442">delta</a>, <a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* deltadelta) {
<a name="l01226"></a>01226   <span class="keywordtype">bool</span> accept = <span class="keyword">true</span>;
<a name="l01227"></a>01227   <span class="keywordflow">for</span> (std::vector&lt;SearchMonitor*&gt;::iterator it = monitors_.begin();
<a name="l01228"></a>01228        it != monitors_.end();
<a name="l01229"></a>01229        ++it) {
<a name="l01230"></a>01230     <span class="keywordflow">if</span> (!(*it)-&gt;AcceptDelta(delta, deltadelta)) {
<a name="l01231"></a>01231       accept = <span class="keyword">false</span>;
<a name="l01232"></a>01232     }
<a name="l01233"></a>01233   }
<a name="l01234"></a><a class="code" href="classoperations__research_1_1Search.html#44a0b488d0c0df43d6bea1606a30f85d">01234</a>   <span class="keywordflow">return</span> accept;
<a name="l01235"></a>01235 }
<a name="l01236"></a>01236 
<a name="l01237"></a>01237 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Search.html#44b05979e5f6c941cf9c06e387fd28a4">Search::AcceptNeighbor</a>() {
<a name="l01238"></a>01238   <span class="keywordflow">for</span> (std::vector&lt;SearchMonitor*&gt;::iterator it = monitors_.begin();
<a name="l01239"></a>01239        it != monitors_.end();
<a name="l01240"></a>01240        ++it) {
<a name="l01241"></a>01241     (*it)-&gt;AcceptNeighbor();
<a name="l01242"></a>01242   }
<a name="l01243"></a>01243 }
<a name="l01244"></a>01244 
<a name="l01245"></a>01245 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Search.html#9723908316a806be6eca0eae11379680">Search::PeriodicCheck</a>() {
<a name="l01246"></a><a class="code" href="classoperations__research_1_1Search.html#44b05979e5f6c941cf9c06e387fd28a4">01246</a>   <span class="keywordflow">for</span> (std::vector&lt;SearchMonitor*&gt;::iterator it = monitors_.begin();
<a name="l01247"></a>01247        it != monitors_.end();
<a name="l01248"></a>01248        ++it) {
<a name="l01249"></a>01249     (*it)-&gt;PeriodicCheck();
<a name="l01250"></a>01250   }
<a name="l01251"></a>01251 }
<a name="l01252"></a>01252 
<a name="l01253"></a>01253 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Search.html#843d04e8d884a1cbfeec5cce85c619dd">Search::Accept</a>(ModelVisitor* <span class="keyword">const</span> visitor)<span class="keyword"> const </span>{
<a name="l01254"></a><a class="code" href="classoperations__research_1_1Search.html#9723908316a806be6eca0eae11379680">01254</a>   <span class="keywordflow">for</span> (std::vector&lt;SearchMonitor*&gt;::const_iterator it = monitors_.begin();
<a name="l01255"></a>01255        it != monitors_.end();
<a name="l01256"></a>01256        ++it) {
<a name="l01257"></a>01257     DCHECK((*it) != NULL);
<a name="l01258"></a>01258     (*it)-&gt;Accept(visitor);
<a name="l01259"></a>01259   }
<a name="l01260"></a>01260   <span class="keywordflow">if</span> (decision_builder_ != NULL) {
<a name="l01261"></a>01261     decision_builder_-&gt;<a class="code" href="classoperations__research_1_1DecisionBuilder.html#e7ca51f2177acc62d1a863694278ba20">Accept</a>(visitor);
<a name="l01262"></a><a class="code" href="classoperations__research_1_1Search.html#843d04e8d884a1cbfeec5cce85c619dd">01262</a>   }
<a name="l01263"></a>01263 }
<a name="l01264"></a>01264 
<a name="l01265"></a>01265 <span class="keyword">namespace </span>{
<a name="l01266"></a>01266 <span class="comment">// ---------- Fail Decision ----------</span>
<a name="l01267"></a>01267 
<a name="l01268"></a>01268 <span class="keyword">class </span>FailDecision : <span class="keyword">public</span> Decision {
<a name="l01269"></a>01269  <span class="keyword">public</span>:
<a name="l01270"></a>01270   <span class="keyword">virtual</span> <span class="keywordtype">void</span> Apply(<a class="code" href="classoperations__research_1_1Search.html#16432758b314f3cedad3fba81c895417">Solver</a>* <span class="keyword">const</span> s) {
<a name="l01271"></a>01271     s-&gt;Fail();
<a name="l01272"></a>01272   }
<a name="l01273"></a>01273   <span class="keyword">virtual</span> <span class="keywordtype">void</span> Refute(<a class="code" href="classoperations__research_1_1Search.html#16432758b314f3cedad3fba81c895417">Solver</a>* <span class="keyword">const</span> s) {
<a name="l01274"></a>01274     s-&gt;Fail();
<a name="l01275"></a>01275   }
<a name="l01276"></a>01276 };
<a name="l01277"></a>01277 
<a name="l01278"></a>01278 <span class="comment">// Balancing decision</span>
<a name="l01279"></a>01279 
<a name="l01280"></a>01280 <span class="keyword">class </span>BalancingDecision : <span class="keyword">public</span> Decision {
<a name="l01281"></a>01281  <span class="keyword">public</span>:
<a name="l01282"></a>01282   <span class="keyword">virtual</span> ~BalancingDecision() {}
<a name="l01283"></a>01283   <span class="keyword">virtual</span> <span class="keywordtype">void</span> Apply(<a class="code" href="classoperations__research_1_1Search.html#16432758b314f3cedad3fba81c895417">Solver</a>* <span class="keyword">const</span> s) {}
<a name="l01284"></a>01284   <span class="keyword">virtual</span> <span class="keywordtype">void</span> Refute(<a class="code" href="classoperations__research_1_1Search.html#16432758b314f3cedad3fba81c895417">Solver</a>* <span class="keyword">const</span> s) {}
<a name="l01285"></a>01285 };
<a name="l01286"></a>01286 }  <span class="comment">// namespace</span>
<a name="l01287"></a>01287 
<a name="l01288"></a>01288 Decision* <a class="code" href="classoperations__research_1_1Solver.html#ef168545c53462b00e474770d7948170" title="namespace">Solver::MakeFailDecision</a>() {
<a name="l01289"></a>01289   <span class="keywordflow">return</span> fail_decision_.get();
<a name="l01290"></a>01290 }
<a name="l01291"></a>01291 
<a name="l01292"></a>01292 
<a name="l01293"></a>01293 <span class="comment">// ------------------ Solver class -----------------</span>
<a name="l01294"></a>01294 
<a name="l01295"></a>01295 <span class="comment">// These magic numbers are there to make sure we pop the correct</span>
<a name="l01296"></a>01296 <span class="comment">// sentinels throughout the search.</span>
<a name="l01297"></a><a class="code" href="classoperations__research_1_1Solver.html#ef168545c53462b00e474770d7948170">01297</a> <span class="keyword">namespace </span>{
<a name="l01298"></a>01298 <span class="keyword">enum</span> SentinelMarker {
<a name="l01299"></a>01299   <a class="code" href="namespaceoperations__research.html#f1ab36801da5984b89300bc340ca2570">INITIAL_SEARCH_SENTINEL</a> = 10000000,
<a name="l01300"></a>01300   <a class="code" href="namespaceoperations__research.html#750b3027192fb2ccc71c4b318aa4f850">ROOT_NODE_SENTINEL</a>      = 20000000,
<a name="l01301"></a>01301   <a class="code" href="namespaceoperations__research.html#ec3e91d46100e1b95d4293ff52730113">SOLVER_CTOR_SENTINEL</a>    = 40000000
<a name="l01302"></a>01302 };
<a name="l01303"></a>01303 }  <span class="comment">// namespace</span>
<a name="l01304"></a>01304 
<a name="l01305"></a>01305 <span class="keyword">extern</span> <a class="code" href="classoperations__research_1_1Action.html" title="An action is the base callback method.">Action</a>* <a class="code" href="namespaceoperations__research.html#95ad34ed7b89a3604a3475012a6a068a" title="namespace">NewDomainIntVarCleaner</a>();
<a name="l01306"></a>01306 
<a name="l01307"></a>01307 <span class="keywordtype">string</span> <a class="code" href="classoperations__research_1_1Solver.html#9e7d568ffc44dde3e00ba3255299f688" title="Returns the name of the model.">Solver::model_name</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> name_; }
<a name="l01308"></a><a class="code" href="namespaceoperations__research.html#f1ab36801da5984b89300bc340ca2570">01308</a> 
<a name="l01309"></a><a class="code" href="namespaceoperations__research.html#750b3027192fb2ccc71c4b318aa4f850">01309</a> <a class="code" href="classoperations__research_1_1Solver.html#5b0165d313b9e2bfba93da6aff65052f">Solver::Solver</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; <a class="code" href="default__search_8cc.html#1848ae81740c68c2502b2f176cfadcef" title="A name for logging purposes.">name</a>, <span class="keyword">const</span> <a class="code" href="structoperations__research_1_1SolverParameters.html" title="This struct holds all parameters for the Solver object.">SolverParameters</a>&amp; <a class="code" href="classoperations__research_1_1Solver.html#8b52d4efd0ccb1880d2f1bc794166872" title="Read-only Parameters.">parameters</a>)
<a name="l01310"></a><a class="code" href="namespaceoperations__research.html#ec3e91d46100e1b95d4293ff52730113">01310</a>     : name_(name),
<a name="l01311"></a>01311       parameters_(parameters),
<a name="l01312"></a>01312       queue_(new <a class="code" href="classoperations__research_1_1Queue.html" title="namespace">Queue</a>(this)),
<a name="l01313"></a>01313       trail_(new <a class="code" href="structoperations__research_1_1Trail.html">Trail</a>(parameters.trail_block_size, parameters.compress_trail)),
<a name="l01314"></a>01314       state_(<a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a95c05654b6a7479316478744b3ce4a50df" title="Before search, after search.">OUTSIDE_SEARCH</a>),
<a name="l01315"></a>01315       branches_(0),
<a name="l01316"></a><a class="code" href="classoperations__research_1_1Solver.html#9e7d568ffc44dde3e00ba3255299f688">01316</a>       fails_(0),
<a name="l01317"></a>01317       decisions_(0),
<a name="l01318"></a><a class="code" href="classoperations__research_1_1Solver.html#204c89d453a0716e5c521dc3dc2f5604">01318</a>       neighbors_(0),
<a name="l01319"></a>01319       filtered_neighbors_(0),
<a name="l01320"></a>01320       accepted_neighbors_(0),
<a name="l01321"></a>01321       variable_cleaner_(<a class="code" href="namespaceoperations__research.html#95ad34ed7b89a3604a3475012a6a068a" title="namespace">NewDomainIntVarCleaner</a>()),
<a name="l01322"></a>01322       timer_(new <a class="code" href="constraint__solver_8h.html#5237bcebc553d0f8eb7e399f04e6ad98">ClockTimer</a>),
<a name="l01323"></a>01323       searches_(),
<a name="l01324"></a>01324       random_(ACMRandom::DeterministicSeed()),
<a name="l01325"></a>01325       fail_hooks_(NULL),
<a name="l01326"></a>01326       fail_stamp_(GG_ULONGLONG(1)),
<a name="l01327"></a>01327       balancing_decision_(new BalancingDecision),
<a name="l01328"></a>01328       fail_intercept_(NULL),
<a name="l01329"></a>01329       demon_monitor_(<a class="code" href="namespaceoperations__research.html#c0839cdc9649d88a73060cfde2038b3e" title="Forward Declarations and Profiling Support.">BuildDemonMonitor</a>(this)),
<a name="l01330"></a>01330       true_constraint_(NULL),
<a name="l01331"></a>01331       false_constraint_(NULL),
<a name="l01332"></a>01332       fail_decision_(new FailDecision()),
<a name="l01333"></a>01333       constraint_index_(0),
<a name="l01334"></a>01334       additional_constraint_index_(0),
<a name="l01335"></a>01335       model_cache_(NULL),
<a name="l01336"></a>01336       dependency_graph_(NULL) {
<a name="l01337"></a>01337   <a class="code" href="classoperations__research_1_1Solver.html#ff69c43f533d38b3ed33f897c7ab3f5a" title="Init.">Init</a>();
<a name="l01338"></a>01338 }
<a name="l01339"></a>01339 
<a name="l01340"></a>01340 <a class="code" href="classoperations__research_1_1Solver.html#5b0165d313b9e2bfba93da6aff65052f">Solver::Solver</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; <a class="code" href="default__search_8cc.html#1848ae81740c68c2502b2f176cfadcef" title="A name for logging purposes.">name</a>)
<a name="l01341"></a>01341     : name_(name),
<a name="l01342"></a>01342       parameters_(),
<a name="l01343"></a>01343       queue_(new <a class="code" href="classoperations__research_1_1Queue.html" title="namespace">Queue</a>(this)),
<a name="l01344"></a>01344       trail_(new <a class="code" href="structoperations__research_1_1Trail.html">Trail</a>(parameters_.trail_block_size,
<a name="l01345"></a>01345                        parameters_.compress_trail)),
<a name="l01346"></a>01346       state_(<a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a95c05654b6a7479316478744b3ce4a50df" title="Before search, after search.">OUTSIDE_SEARCH</a>),
<a name="l01347"></a>01347       branches_(0),
<a name="l01348"></a>01348       fails_(0),
<a name="l01349"></a><a class="code" href="classoperations__research_1_1Solver.html#5b0165d313b9e2bfba93da6aff65052f">01349</a>       decisions_(0),
<a name="l01350"></a>01350       neighbors_(0),
<a name="l01351"></a>01351       filtered_neighbors_(0),
<a name="l01352"></a>01352       accepted_neighbors_(0),
<a name="l01353"></a>01353       variable_cleaner_(<a class="code" href="namespaceoperations__research.html#95ad34ed7b89a3604a3475012a6a068a" title="namespace">NewDomainIntVarCleaner</a>()),
<a name="l01354"></a>01354       timer_(new <a class="code" href="constraint__solver_8h.html#5237bcebc553d0f8eb7e399f04e6ad98">ClockTimer</a>),
<a name="l01355"></a>01355       searches_(),
<a name="l01356"></a>01356       random_(ACMRandom::DeterministicSeed()),
<a name="l01357"></a>01357       fail_hooks_(NULL),
<a name="l01358"></a>01358       fail_stamp_(GG_ULONGLONG(1)),
<a name="l01359"></a>01359       balancing_decision_(new BalancingDecision),
<a name="l01360"></a>01360       fail_intercept_(NULL),
<a name="l01361"></a>01361       demon_monitor_(<a class="code" href="namespaceoperations__research.html#c0839cdc9649d88a73060cfde2038b3e" title="Forward Declarations and Profiling Support.">BuildDemonMonitor</a>(this)),
<a name="l01362"></a>01362       true_constraint_(NULL),
<a name="l01363"></a>01363       false_constraint_(NULL),
<a name="l01364"></a>01364       fail_decision_(new FailDecision()),
<a name="l01365"></a>01365       constraint_index_(0),
<a name="l01366"></a>01366       additional_constraint_index_(0),
<a name="l01367"></a>01367       model_cache_(NULL),
<a name="l01368"></a>01368       dependency_graph_(NULL) {
<a name="l01369"></a>01369   <a class="code" href="classoperations__research_1_1Solver.html#ff69c43f533d38b3ed33f897c7ab3f5a" title="Init.">Init</a>();
<a name="l01370"></a>01370 }
<a name="l01371"></a>01371 
<a name="l01372"></a>01372 <span class="keyword">extern</span> <a class="code" href="classoperations__research_1_1ModelCache.html" title="Implements a complete cache for model elements: expressions and constraints.">ModelCache</a>* <a class="code" href="namespaceoperations__research.html#257ee12a1feb2e15b6efa4b3fe283173" title="namespace">BuildModelCache</a>(<a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> solver);
<a name="l01373"></a>01373 <span class="keyword">extern</span> <a class="code" href="classoperations__research_1_1DependencyGraph.html">DependencyGraph</a>* <a class="code" href="namespaceoperations__research.html#c3a31fd55a27058c2ba9acd41b75ec5d">BuildDependencyGraph</a>(<a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> solver);
<a name="l01374"></a>01374 
<a name="l01375"></a>01375 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Solver.html#ff69c43f533d38b3ed33f897c7ab3f5a" title="Init.">Solver::Init</a>() {
<a name="l01376"></a>01376   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classoperations__research_1_1Solver.html#d4faf53cefb2c2cdb8892b978a4b93a9" title="Number of priorities for demons.">kNumPriorities</a>; ++i) {
<a name="l01377"></a>01377     demon_runs_[i] = 0;
<a name="l01378"></a>01378   }
<a name="l01379"></a>01379   searches_.push_back(<span class="keyword">new</span> Search(<span class="keyword">this</span>));
<a name="l01380"></a>01380   PushSentinel(<a class="code" href="namespaceoperations__research.html#ec3e91d46100e1b95d4293ff52730113">SOLVER_CTOR_SENTINEL</a>);
<a name="l01381"></a>01381   InitCachedIntConstants();  <span class="comment">// to be called after the SENTINEL is set.</span>
<a name="l01382"></a>01382   InitCachedConstraint();  <span class="comment">// Cache the true constraint.</span>
<a name="l01383"></a>01383   InitBuilders();
<a name="l01384"></a><a class="code" href="classoperations__research_1_1Solver.html#ff69c43f533d38b3ed33f897c7ab3f5a">01384</a>   timer_-&gt;Restart();
<a name="l01385"></a>01385   model_cache_.reset(<a class="code" href="namespaceoperations__research.html#257ee12a1feb2e15b6efa4b3fe283173" title="namespace">BuildModelCache</a>(<span class="keyword">this</span>));
<a name="l01386"></a>01386   dependency_graph_.reset(<a class="code" href="namespaceoperations__research.html#c3a31fd55a27058c2ba9acd41b75ec5d">BuildDependencyGraph</a>(<span class="keyword">this</span>));
<a name="l01387"></a>01387 }
<a name="l01388"></a>01388 
<a name="l01389"></a>01389 <a class="code" href="classoperations__research_1_1Solver.html#663bdb75f27a96e424ad2a7a4ba397ec">Solver::~Solver</a>() {
<a name="l01390"></a>01390   <span class="comment">// solver destructor called with searches open.</span>
<a name="l01391"></a>01391   CHECK_EQ(searches_.size(), 1);
<a name="l01392"></a>01392   BacktrackToSentinel(<a class="code" href="namespaceoperations__research.html#f1ab36801da5984b89300bc340ca2570">INITIAL_SEARCH_SENTINEL</a>);
<a name="l01393"></a>01393 
<a name="l01394"></a>01394   <a class="code" href="structoperations__research_1_1StateInfo.html" title="StateMarker / StateInfo struct.">StateInfo</a> info;
<a name="l01395"></a>01395   <a class="code" href="namespaceoperations__research.html#5881ca2f6350f69f63b48b872c1c7e5e" title="This enum is used internally to tag states in the search tree.">MarkerType</a> finalType = <a class="code" href="classoperations__research_1_1Solver.html#67a90d3f386c8530100f810ef54a240a">PopState</a>(&amp;info);
<a name="l01396"></a>01396   <span class="comment">// Not popping a SENTINEL in Solver destructor.</span>
<a name="l01397"></a>01397   DCHECK_EQ(finalType, <a class="code" href="namespaceoperations__research.html#5881ca2f6350f69f63b48b872c1c7e5e9a277c2d196896995aaffb41aec2faea">SENTINEL</a>);
<a name="l01398"></a><a class="code" href="classoperations__research_1_1Solver.html#663bdb75f27a96e424ad2a7a4ba397ec">01398</a>   <span class="comment">// Not popping initial SENTINEL in Solver destructor.</span>
<a name="l01399"></a>01399   DCHECK_EQ(info.<a class="code" href="structoperations__research_1_1StateInfo.html#000fb6644096e817fbaaa6f0ec4d2dc7">int_info</a>, <a class="code" href="namespaceoperations__research.html#ec3e91d46100e1b95d4293ff52730113">SOLVER_CTOR_SENTINEL</a>);
<a name="l01400"></a>01400 
<a name="l01401"></a>01401   <a class="code" href="classoperations__research_1_1Search.html" title="Search class.">Search</a>* search = searches_.back();
<a name="l01402"></a>01402   searches_.pop_back();
<a name="l01403"></a>01403   CHECK(searches_.empty())
<a name="l01404"></a>01404       &lt;&lt; <span class="stringliteral">"non empty list of searches when ending the solver"</span>;
<a name="l01405"></a>01405   <span class="keyword">delete</span> search;
<a name="l01406"></a>01406   <a class="code" href="namespaceoperations__research.html#c7e3e4722c51d781636e24d843c0e542">DeleteDemonMonitor</a>(demon_monitor_);
<a name="l01407"></a>01407   DeleteBuilders();
<a name="l01408"></a>01408 }
<a name="l01409"></a>01409 
<a name="l01410"></a>01410 <span class="keyword">const</span> <a class="code" href="structoperations__research_1_1SolverParameters.html#63c6fe2e32ced9f83a4064c800130651">SolverParameters::TrailCompression</a>
<a name="l01411"></a>01411 <a class="code" href="structoperations__research_1_1SolverParameters.html#6f804a79d6f2f5b989cef147e5642ecf">SolverParameters::kDefaultTrailCompression</a> = <a class="code" href="structoperations__research_1_1SolverParameters.html#63c6fe2e32ced9f83a4064c80013065161440a766f50f6084eb75e9475441c9b">SolverParameters::NO_COMPRESSION</a>;
<a name="l01412"></a>01412 <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structoperations__research_1_1SolverParameters.html#3ca543fc47b4a89b45f5c1e5626e3226">SolverParameters::kDefaultTrailBlockSize</a> = 8000;
<a name="l01413"></a>01413 <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structoperations__research_1_1SolverParameters.html#14b9430319840c90d5064c32e9459176">SolverParameters::kDefaultArraySplitSize</a> = 16;
<a name="l01414"></a>01414 <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="structoperations__research_1_1SolverParameters.html#b283c9875ecce4fe4991a1f73c47299f">SolverParameters::kDefaultNameStoring</a> = <span class="keyword">true</span>;
<a name="l01415"></a>01415 <span class="keyword">const</span> <a class="code" href="structoperations__research_1_1SolverParameters.html#bb1b746ad99155bea2d44ba46db07187">SolverParameters::ProfileLevel</a> <a class="code" href="structoperations__research_1_1SolverParameters.html#8e1e96280d622b55f6e620b76032f1e6">SolverParameters::kDefaultProfileLevel</a> =
<a name="l01416"></a>01416          <a class="code" href="structoperations__research_1_1SolverParameters.html#bb1b746ad99155bea2d44ba46db0718723a03d3fac4ba780d9caa8ae38f5dea9">SolverParameters::NO_PROFILING</a>;
<a name="l01417"></a>01417 
<a name="l01418"></a>01418 <span class="keywordtype">string</span> <a class="code" href="classoperations__research_1_1Solver.html#a7a09bf2f27ccbdc1d1d386bd94e142a" title="misc debug string.">Solver::DebugString</a>()<span class="keyword"> const </span>{
<a name="l01419"></a>01419   <span class="keywordtype">string</span> out = <span class="stringliteral">"Solver(name = \""</span> + name_ + <span class="stringliteral">"\", state = "</span>;
<a name="l01420"></a>01420   <span class="keywordflow">switch</span> (state_) {
<a name="l01421"></a>01421     <span class="keywordflow">case</span> <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a95c05654b6a7479316478744b3ce4a50df" title="Before search, after search.">OUTSIDE_SEARCH</a>:
<a name="l01422"></a>01422       out += <span class="stringliteral">"OUTSIDE_SEARCH"</span>;
<a name="l01423"></a>01423       <span class="keywordflow">break</span>;
<a name="l01424"></a>01424     <span class="keywordflow">case</span> <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a950e9b4a7467a4d4f1a7da211e6c59251e" title="Executing the root node.">IN_ROOT_NODE</a>:
<a name="l01425"></a>01425       out += <span class="stringliteral">"IN_ROOT_NODE"</span>;
<a name="l01426"></a>01426       <span class="keywordflow">break</span>;
<a name="l01427"></a><a class="code" href="classoperations__research_1_1Solver.html#a7a09bf2f27ccbdc1d1d386bd94e142a">01427</a>     <span class="keywordflow">case</span> <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a95066908e143fd988a03767f05e682acaf" title="Executing the search code.">IN_SEARCH</a>:
<a name="l01428"></a>01428       out += <span class="stringliteral">"IN_SEARCH"</span>;
<a name="l01429"></a>01429       <span class="keywordflow">break</span>;
<a name="l01430"></a>01430     <span class="keywordflow">case</span> <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a95d487136b6f055fa3fadfd6a3c12aa3a3" title="After successful NextSolution and before EndSearch.">AT_SOLUTION</a>:
<a name="l01431"></a>01431       out += <span class="stringliteral">"AT_SOLUTION"</span>;
<a name="l01432"></a>01432       <span class="keywordflow">break</span>;
<a name="l01433"></a>01433     <span class="keywordflow">case</span> <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a95401b0c79d1fa9261524343fce4dd5439" title="After failed NextSolution and before EndSearch.">NO_MORE_SOLUTIONS</a>:
<a name="l01434"></a>01434       out += <span class="stringliteral">"NO_MORE_SOLUTIONS"</span>;
<a name="l01435"></a>01435       <span class="keywordflow">break</span>;
<a name="l01436"></a>01436     <span class="keywordflow">case</span> <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a9530b34e2664f9b1e2fb0d1347d7a87674" title="After search, the model is infeasible.">PROBLEM_INFEASIBLE</a>:
<a name="l01437"></a>01437       out += <span class="stringliteral">"PROBLEM_INFEASIBLE"</span>;
<a name="l01438"></a>01438       <span class="keywordflow">break</span>;
<a name="l01439"></a>01439   }
<a name="l01440"></a>01440   StringAppendF(&amp;out, <span class="stringliteral">", branches = %"</span> GG_LL_FORMAT
<a name="l01441"></a>01441                 <span class="stringliteral">"d, fails = %"</span> GG_LL_FORMAT
<a name="l01442"></a>01442                 <span class="stringliteral">"d, decisions = %"</span> GG_LL_FORMAT
<a name="l01443"></a>01443                 <span class="stringliteral">"d, delayed demon runs = %"</span> GG_LL_FORMAT
<a name="l01444"></a>01444                 <span class="stringliteral">"d, var demon runs = %"</span> GG_LL_FORMAT
<a name="l01445"></a>01445                 <span class="stringliteral">"d, normal demon runs = %"</span> GG_LL_FORMAT
<a name="l01446"></a>01446                 <span class="stringliteral">"d, Run time = %"</span> GG_LL_FORMAT <span class="stringliteral">"d ms)"</span>,
<a name="l01447"></a>01447                 branches_, fails_, decisions_, demon_runs_[<a class="code" href="classoperations__research_1_1Solver.html#4b0972c731faf884eba5acab99ebb2b4f8769149902a8a2b168069cb93cc6370">DELAYED_PRIORITY</a>],
<a name="l01448"></a>01448                 demon_runs_[<a class="code" href="classoperations__research_1_1Solver.html#4b0972c731faf884eba5acab99ebb2b4e5f79fc80ef9ae665bcd7c0e55c02aa6">VAR_PRIORITY</a>], demon_runs_[<a class="code" href="classoperations__research_1_1Solver.html#4b0972c731faf884eba5acab99ebb2b44f432957a8b27277538d5ee856201a4c">NORMAL_PRIORITY</a>],
<a name="l01449"></a>01449                 <a class="code" href="classoperations__research_1_1Solver.html#e1b93d59fbe7e74c48de9a4a8ec3e910" title="wall_time() in ms since the creation of the solver.">wall_time</a>());
<a name="l01450"></a>01450   <span class="keywordflow">return</span> out;
<a name="l01451"></a>01451 }
<a name="l01452"></a>01452 
<a name="l01453"></a>01453 int64 <a class="code" href="classoperations__research_1_1Solver.html#5e71cbc298a43b9a8200254f5b1b44aa" title="Current memory usage in bytes.">Solver::MemoryUsage</a>() {
<a name="l01454"></a>01454   <span class="keywordflow">return</span> GetProcessMemoryUsage();
<a name="l01455"></a>01455 }
<a name="l01456"></a>01456 
<a name="l01457"></a>01457 
<a name="l01458"></a>01458 int64 <a class="code" href="classoperations__research_1_1Solver.html#e1b93d59fbe7e74c48de9a4a8ec3e910" title="wall_time() in ms since the creation of the solver.">Solver::wall_time</a>()<span class="keyword"> const </span>{
<a name="l01459"></a>01459   <span class="keywordflow">return</span> timer_-&gt;GetInMs();
<a name="l01460"></a>01460 }
<a name="l01461"></a>01461 
<a name="l01462"></a><a class="code" href="classoperations__research_1_1Solver.html#5e71cbc298a43b9a8200254f5b1b44aa">01462</a> int64 <a class="code" href="classoperations__research_1_1Solver.html#27328aaeb854db363c20ba50179c154a" title="number of solutions found since the start of the search.">Solver::solutions</a>()<span class="keyword"> const </span>{
<a name="l01463"></a>01463   <span class="keywordflow">return</span> searches_.front()-&gt;solution_counter();
<a name="l01464"></a>01464 }
<a name="l01465"></a>01465 
<a name="l01466"></a>01466 <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1Solver.html#1176bbd276eb06ffbfbb85f5556d05b9" title="Ensures communication of local optima between monitors and search.">Solver::LocalOptimum</a>() {
<a name="l01467"></a><a class="code" href="classoperations__research_1_1Solver.html#e1b93d59fbe7e74c48de9a4a8ec3e910">01467</a>   <span class="keywordflow">return</span> searches_.front()-&gt;LocalOptimum();
<a name="l01468"></a>01468 }
<a name="l01469"></a>01469 
<a name="l01470"></a>01470 <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1Solver.html#72af137f31ed95a5b1810490cbb73b68" title="Checks with monitors if delta is acceptable.">Solver::AcceptDelta</a>(<a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* <a class="code" href="resource_8cc.html#73461c37822b6ebb75b54ba1a9ffb442">delta</a>, <a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* deltadelta) {
<a name="l01471"></a><a class="code" href="classoperations__research_1_1Solver.html#27328aaeb854db363c20ba50179c154a">01471</a>   <span class="keywordflow">return</span> searches_.front()-&gt;AcceptDelta(delta, deltadelta);
<a name="l01472"></a>01472 }
<a name="l01473"></a>01473 
<a name="l01474"></a>01474 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Solver.html#81af3cc927a7e10da0c631b8005f36ad" title="Ensures communication of accepted neighbors between monitors and search.">Solver::AcceptNeighbor</a>() {
<a name="l01475"></a><a class="code" href="classoperations__research_1_1Solver.html#1176bbd276eb06ffbfbb85f5556d05b9">01475</a>   <span class="keywordflow">return</span> searches_.front()-&gt;AcceptNeighbor();
<a name="l01476"></a>01476 }
<a name="l01477"></a>01477 
<a name="l01478"></a>01478 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Solver.html#6ffc56653b5ef9643ce87d05c9ebd8d6" title="Performs PeriodicCheck on the top-level search; can be called from a nested solve...">Solver::TopPeriodicCheck</a>() {
<a name="l01479"></a><a class="code" href="classoperations__research_1_1Solver.html#72af137f31ed95a5b1810490cbb73b68">01479</a>   searches_.front()-&gt;PeriodicCheck();
<a name="l01480"></a>01480 }
<a name="l01481"></a>01481 
<a name="l01482"></a>01482 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Solver.html#6d2ae179cd6e66dc4cfd14307126b2cb" title="The PushState and PopState methods manipulates the states of the reversible objects...">Solver::PushState</a>() {
<a name="l01483"></a><a class="code" href="classoperations__research_1_1Solver.html#81af3cc927a7e10da0c631b8005f36ad">01483</a>   <a class="code" href="structoperations__research_1_1StateInfo.html" title="StateMarker / StateInfo struct.">StateInfo</a> info;
<a name="l01484"></a>01484   <a class="code" href="classoperations__research_1_1Solver.html#6d2ae179cd6e66dc4cfd14307126b2cb" title="The PushState and PopState methods manipulates the states of the reversible objects...">PushState</a>(<a class="code" href="namespaceoperations__research.html#5881ca2f6350f69f63b48b872c1c7e5e695cce0161b127055c52d41744e97395">SIMPLE_MARKER</a>, info);
<a name="l01485"></a>01485 }
<a name="l01486"></a>01486 
<a name="l01487"></a><a class="code" href="classoperations__research_1_1Solver.html#6ffc56653b5ef9643ce87d05c9ebd8d6">01487</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Solver.html#67a90d3f386c8530100f810ef54a240a">Solver::PopState</a>() {
<a name="l01488"></a>01488   <a class="code" href="structoperations__research_1_1StateInfo.html" title="StateMarker / StateInfo struct.">StateInfo</a> info;
<a name="l01489"></a>01489   <a class="code" href="namespaceoperations__research.html#5881ca2f6350f69f63b48b872c1c7e5e" title="This enum is used internally to tag states in the search tree.">MarkerType</a> t = <a class="code" href="classoperations__research_1_1Solver.html#67a90d3f386c8530100f810ef54a240a">PopState</a>(&amp;info);
<a name="l01490"></a>01490   CHECK_EQ(<a class="code" href="namespaceoperations__research.html#5881ca2f6350f69f63b48b872c1c7e5e695cce0161b127055c52d41744e97395">SIMPLE_MARKER</a>, t);
<a name="l01491"></a><a class="code" href="classoperations__research_1_1Solver.html#6d2ae179cd6e66dc4cfd14307126b2cb">01491</a> }
<a name="l01492"></a>01492 
<a name="l01493"></a>01493 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Solver.html#6d2ae179cd6e66dc4cfd14307126b2cb" title="The PushState and PopState methods manipulates the states of the reversible objects...">Solver::PushState</a>(<a class="code" href="namespaceoperations__research.html#5881ca2f6350f69f63b48b872c1c7e5e" title="This enum is used internally to tag states in the search tree.">MarkerType</a> t, <span class="keyword">const</span> <a class="code" href="structoperations__research_1_1StateInfo.html" title="StateMarker / StateInfo struct.">StateInfo</a>&amp; info) {
<a name="l01494"></a>01494   <a class="code" href="structoperations__research_1_1StateMarker.html">StateMarker</a>* m = <span class="keyword">new</span> <a class="code" href="structoperations__research_1_1StateMarker.html">StateMarker</a>(t, info);
<a name="l01495"></a>01495   <span class="keywordflow">if</span> (t != <a class="code" href="namespaceoperations__research.html#5881ca2f6350f69f63b48b872c1c7e5e7d02bd6f10e34551ac9b74d12ee3d746">REVERSIBLE_ACTION</a> || info.<a class="code" href="structoperations__research_1_1StateInfo.html#000fb6644096e817fbaaa6f0ec4d2dc7">int_info</a> == 0) {
<a name="l01496"></a><a class="code" href="classoperations__research_1_1Solver.html#67a90d3f386c8530100f810ef54a240a">01496</a>     m-&gt;<a class="code" href="structoperations__research_1_1StateMarker.html#47e232d3c97f162917eb26a62370a3b0">rev_int_index_</a> = trail_-&gt;rev_ints_.size();
<a name="l01497"></a>01497     m-&gt;<a class="code" href="structoperations__research_1_1StateMarker.html#59a871b8eb960f4f605ce92ae0b0b5cb">rev_int64_index_</a> = trail_-&gt;rev_int64s_.size();
<a name="l01498"></a>01498     m-&gt;<a class="code" href="structoperations__research_1_1StateMarker.html#98de7b131b404376d33337b01eb28031">rev_uint64_index_</a> = trail_-&gt;rev_uint64s_.size();
<a name="l01499"></a>01499     m-&gt;<a class="code" href="structoperations__research_1_1StateMarker.html#611fa35102e6366583df213d9a033ce5">rev_ptr_index_</a> = trail_-&gt;rev_ptrs_.size();
<a name="l01500"></a>01500     m-&gt;<a class="code" href="structoperations__research_1_1StateMarker.html#e15d50e63cbb570a6c5bd9b207e4fd86">rev_boolvar_list_index_</a> = trail_-&gt;rev_boolvar_list_.size();
<a name="l01501"></a>01501     m-&gt;<a class="code" href="structoperations__research_1_1StateMarker.html#cfe80591d75fad1f8b61d0be54f83be1">rev_bools_index_</a> = trail_-&gt;rev_bools_.size();
<a name="l01502"></a>01502     m-&gt;<a class="code" href="structoperations__research_1_1StateMarker.html#567759b019a07447185219b3b049a56b">rev_int_memory_index_</a> = trail_-&gt;rev_int_memory_.size();
<a name="l01503"></a>01503     m-&gt;<a class="code" href="structoperations__research_1_1StateMarker.html#3716106fcd2f164dd83d0ee3d7f48ea4">rev_int64_memory_index_</a> = trail_-&gt;rev_int64_memory_.size();
<a name="l01504"></a>01504     m-&gt;<a class="code" href="structoperations__research_1_1StateMarker.html#0d2c3347f6d80cf1754b596f5c4cd3f3">rev_object_memory_index_</a> = trail_-&gt;rev_object_memory_.size();
<a name="l01505"></a>01505     m-&gt;<a class="code" href="structoperations__research_1_1StateMarker.html#b9edca8db5e3933b8343ebc6242c51b0">rev_object_array_memory_index_</a> = trail_-&gt;rev_object_array_memory_.size();
<a name="l01506"></a>01506     m-&gt;<a class="code" href="structoperations__research_1_1StateMarker.html#59f571a7c091f1c6613f7a3fd81e2b9f">rev_memory_index_</a> = trail_-&gt;rev_memory_.size();
<a name="l01507"></a>01507     m-&gt;<a class="code" href="structoperations__research_1_1StateMarker.html#7376e157224557b0ac9471eee71c2e04">rev_memory_array_index_</a> = trail_-&gt;rev_memory_array_.size();
<a name="l01508"></a>01508   }
<a name="l01509"></a>01509   searches_.back()-&gt;marker_stack_.push_back(m);
<a name="l01510"></a>01510   queue_-&gt;increase_stamp();
<a name="l01511"></a>01511 }
<a name="l01512"></a>01512 
<a name="l01513"></a>01513 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Solver.html#12783cb5a67a23a12104dfd9f51d3c92" title="When SaveValue() is not the best way to go, one can create a reversible action that...">Solver::AddBacktrackAction</a>(Action* a, <span class="keywordtype">bool</span> fast) {
<a name="l01514"></a>01514   StateInfo info(a, static_cast&lt;int&gt;(fast));
<a name="l01515"></a>01515   <a class="code" href="classoperations__research_1_1Solver.html#6d2ae179cd6e66dc4cfd14307126b2cb" title="The PushState and PopState methods manipulates the states of the reversible objects...">PushState</a>(<a class="code" href="namespaceoperations__research.html#5881ca2f6350f69f63b48b872c1c7e5e7d02bd6f10e34551ac9b74d12ee3d746">REVERSIBLE_ACTION</a>, info);
<a name="l01516"></a>01516 }
<a name="l01517"></a>01517 
<a name="l01518"></a>01518 <a class="code" href="namespaceoperations__research.html#5881ca2f6350f69f63b48b872c1c7e5e" title="This enum is used internally to tag states in the search tree.">MarkerType</a> <a class="code" href="classoperations__research_1_1Solver.html#67a90d3f386c8530100f810ef54a240a">Solver::PopState</a>(StateInfo* info) {
<a name="l01519"></a>01519   CHECK(!searches_.back()-&gt;marker_stack_.empty())
<a name="l01520"></a>01520       &lt;&lt; <span class="stringliteral">"PopState() on an empty stack"</span>;
<a name="l01521"></a>01521   CHECK(info != NULL);
<a name="l01522"></a><a class="code" href="classoperations__research_1_1Solver.html#12783cb5a67a23a12104dfd9f51d3c92">01522</a>   <a class="code" href="structoperations__research_1_1StateMarker.html">StateMarker</a>* m = searches_.back()-&gt;marker_stack_.back();
<a name="l01523"></a>01523   <span class="keywordflow">if</span> (m-&gt;<a class="code" href="structoperations__research_1_1StateMarker.html#5945e8fa6615f411642c0a8f7b254e9f">type_</a> != <a class="code" href="namespaceoperations__research.html#5881ca2f6350f69f63b48b872c1c7e5e7d02bd6f10e34551ac9b74d12ee3d746">REVERSIBLE_ACTION</a> || m-&gt;<a class="code" href="structoperations__research_1_1StateMarker.html#a511a58fff101f893be1792b30533a99">info_</a>.<a class="code" href="structoperations__research_1_1StateInfo.html#000fb6644096e817fbaaa6f0ec4d2dc7">int_info</a> == 0) {
<a name="l01524"></a>01524     trail_-&gt;BacktrackTo(m);
<a name="l01525"></a>01525   }
<a name="l01526"></a>01526   <a class="code" href="namespaceoperations__research.html#5881ca2f6350f69f63b48b872c1c7e5e" title="This enum is used internally to tag states in the search tree.">MarkerType</a> t = m-&gt;<a class="code" href="structoperations__research_1_1StateMarker.html#5945e8fa6615f411642c0a8f7b254e9f">type_</a>;
<a name="l01527"></a>01527   (*info) = m-&gt;<a class="code" href="structoperations__research_1_1StateMarker.html#a511a58fff101f893be1792b30533a99">info_</a>;
<a name="l01528"></a>01528   searches_.back()-&gt;marker_stack_.pop_back();
<a name="l01529"></a>01529   <span class="keyword">delete</span> m;
<a name="l01530"></a>01530   queue_-&gt;increase_stamp();
<a name="l01531"></a>01531   <span class="keywordflow">return</span> t;
<a name="l01532"></a>01532 }
<a name="l01533"></a>01533 
<a name="l01534"></a>01534 <span class="keywordtype">void</span> Solver::check_alloc_state() {
<a name="l01535"></a>01535   <span class="keywordflow">switch</span> (state_) {
<a name="l01536"></a>01536     <span class="keywordflow">case</span> <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a95c05654b6a7479316478744b3ce4a50df" title="Before search, after search.">OUTSIDE_SEARCH</a>:
<a name="l01537"></a>01537     <span class="keywordflow">case</span> <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a950e9b4a7467a4d4f1a7da211e6c59251e" title="Executing the root node.">IN_ROOT_NODE</a>:
<a name="l01538"></a>01538     <span class="keywordflow">case</span> <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a95066908e143fd988a03767f05e682acaf" title="Executing the search code.">IN_SEARCH</a>:
<a name="l01539"></a>01539     <span class="keywordflow">case</span> <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a95401b0c79d1fa9261524343fce4dd5439" title="After failed NextSolution and before EndSearch.">NO_MORE_SOLUTIONS</a>:
<a name="l01540"></a>01540     <span class="keywordflow">case</span> <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a9530b34e2664f9b1e2fb0d1347d7a87674" title="After search, the model is infeasible.">PROBLEM_INFEASIBLE</a>:
<a name="l01541"></a>01541       <span class="keywordflow">break</span>;
<a name="l01542"></a>01542     <span class="keywordflow">case</span> <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a95d487136b6f055fa3fadfd6a3c12aa3a3" title="After successful NextSolution and before EndSearch.">AT_SOLUTION</a>:
<a name="l01543"></a>01543       LOG(FATAL) &lt;&lt; <span class="stringliteral">"allocating at a leaf node"</span>;
<a name="l01544"></a>01544     <span class="keywordflow">default</span>:
<a name="l01545"></a>01545       LOG(FATAL) &lt;&lt; <span class="stringliteral">"This switch was supposed to be exhaustive, but it is not!"</span>;
<a name="l01546"></a>01546   }
<a name="l01547"></a>01547 }
<a name="l01548"></a>01548 
<a name="l01549"></a>01549 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Solver.html#e8f2aca4ff70252d643ac2a0ca02e44d" title="Adds a fail hook, that is an action that will be called after each failure.">Solver::AddFailHook</a>(Action* a) {
<a name="l01550"></a>01550   <span class="keywordflow">if</span> (fail_hooks_ == NULL) {
<a name="l01551"></a>01551     <a class="code" href="classoperations__research_1_1Solver.html#7ccd4144085fe2217fd92798283e99df" title="reversibility">SaveValue</a>(reinterpret_cast&lt;void**&gt;(&amp;fail_hooks_));
<a name="l01552"></a>01552     fail_hooks_ = UnsafeRevAlloc(<span class="keyword">new</span> SimpleRevFIFO&lt;Action*&gt;);
<a name="l01553"></a>01553   }
<a name="l01554"></a>01554   fail_hooks_-&gt;Push(<span class="keyword">this</span>, a);
<a name="l01555"></a>01555 }
<a name="l01556"></a>01556 
<a name="l01557"></a>01557 <span class="keywordtype">void</span> Solver::CallFailHooks() {
<a name="l01558"></a><a class="code" href="classoperations__research_1_1Solver.html#e8f2aca4ff70252d643ac2a0ca02e44d">01558</a>   <span class="keywordflow">if</span> (fail_hooks_ != NULL) {
<a name="l01559"></a>01559     <span class="keywordflow">for</span> (<a class="code" href="classoperations__research_1_1SimpleRevFIFO.html" title="utility classes">SimpleRevFIFO&lt;Action*&gt;::Iterator</a> it(fail_hooks_); it.ok(); ++it) {
<a name="l01560"></a>01560       (*it)-&gt;Run(<span class="keyword">this</span>);
<a name="l01561"></a>01561     }
<a name="l01562"></a>01562   }
<a name="l01563"></a>01563 }
<a name="l01564"></a>01564 
<a name="l01565"></a>01565 <span class="keywordtype">void</span> Solver::FreezeQueue() {
<a name="l01566"></a>01566   queue_-&gt;Freeze();
<a name="l01567"></a>01567 }
<a name="l01568"></a>01568 
<a name="l01569"></a>01569 <span class="keywordtype">void</span> Solver::UnfreezeQueue() {
<a name="l01570"></a>01570   queue_-&gt;Unfreeze();
<a name="l01571"></a>01571 }
<a name="l01572"></a>01572 
<a name="l01573"></a>01573 <span class="keywordtype">void</span> Solver::Enqueue(Demon* d) {
<a name="l01574"></a>01574   queue_-&gt;Enqueue(d);
<a name="l01575"></a>01575 }
<a name="l01576"></a>01576 
<a name="l01577"></a>01577 <span class="keywordtype">void</span> Solver::ProcessDemonsOnQueue() {
<a name="l01578"></a>01578   queue_-&gt;ProcessDemons();
<a name="l01579"></a>01579 }
<a name="l01580"></a>01580 
<a name="l01581"></a>01581 uint64 <a class="code" href="classoperations__research_1_1Solver.html#f17dc31a0a12a7c6c9c09a8a8e2d94e4" title="The stamp indicates how many moves in the search tree we have performed.">Solver::stamp</a>()<span class="keyword"> const </span>{
<a name="l01582"></a>01582   <span class="keywordflow">return</span> queue_-&gt;stamp();
<a name="l01583"></a>01583 }
<a name="l01584"></a>01584 
<a name="l01585"></a>01585 uint64 <a class="code" href="classoperations__research_1_1Solver.html#0acf6942724a40e662a40df1f804eb51" title="The fail_stamp() is incremented after each backtrack.">Solver::fail_stamp</a>()<span class="keyword"> const </span>{
<a name="l01586"></a>01586   <span class="keywordflow">return</span> fail_stamp_;
<a name="l01587"></a>01587 }
<a name="l01588"></a>01588 
<a name="l01589"></a>01589 <span class="keywordtype">void</span> Solver::set_queue_action_on_fail(Action* a) {
<a name="l01590"></a><a class="code" href="classoperations__research_1_1Solver.html#f17dc31a0a12a7c6c9c09a8a8e2d94e4">01590</a>   queue_-&gt;set_action_on_fail(a);
<a name="l01591"></a>01591 }
<a name="l01592"></a>01592 
<a name="l01593"></a>01593 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Solver.html#3c3b1b166d9cd1613a05e960899c19c9">SetQueueCleanerOnFail</a>(<a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> solver, <a class="code" href="classoperations__research_1_1IntVar.html" title="The class IntVar is a subset of IntExpr.">IntVar</a>* <span class="keyword">const</span> <a class="code" href="expr__array_8cc.html#472a99923cbe11ae7b5a5d157d9ad465">var</a>) {
<a name="l01594"></a><a class="code" href="classoperations__research_1_1Solver.html#0acf6942724a40e662a40df1f804eb51">01594</a>   solver-&gt;<a class="code" href="classoperations__research_1_1Solver.html#9f939894fd37da401bd1178e2c0f0f11">set_queue_cleaner_on_fail</a>(var);
<a name="l01595"></a>01595 }
<a name="l01596"></a>01596 
<a name="l01597"></a>01597 <span class="keywordtype">void</span> Solver::clear_queue_action_on_fail() {
<a name="l01598"></a>01598   queue_-&gt;clear_action_on_fail();
<a name="l01599"></a>01599 }
<a name="l01600"></a>01600 
<a name="l01601"></a>01601 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Solver.html#9c522a6cff91adae19af5cce7d8e411f" title="propagation">Solver::AddConstraint</a>(<a class="code" href="classoperations__research_1_1Solver.html#697ed9eaa8955d595a023663ab1e8418">Constraint</a>* <span class="keyword">const</span> c) {
<a name="l01602"></a><a class="code" href="namespaceoperations__research.html#3b7cd70aea9c32dce5901bda5745531f">01602</a>   <span class="keywordflow">if</span> (state_ == <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a95066908e143fd988a03767f05e682acaf" title="Executing the search code.">IN_SEARCH</a>) {
<a name="l01603"></a>01603     queue_-&gt;AddConstraint(c);
<a name="l01604"></a>01604   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (state_ == <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a950e9b4a7467a4d4f1a7da211e6c59251e" title="Executing the root node.">IN_ROOT_NODE</a>) {
<a name="l01605"></a>01605     DCHECK_GE(constraint_index_, 0);
<a name="l01606"></a>01606     DCHECK_LE(constraint_index_, constraints_list_.size());
<a name="l01607"></a>01607     <span class="keyword">const</span> <span class="keywordtype">int</span> constraint_parent =
<a name="l01608"></a>01608         constraint_index_ == constraints_list_.size() ?
<a name="l01609"></a>01609         additional_constraints_parent_list_[additional_constraint_index_] :
<a name="l01610"></a><a class="code" href="classoperations__research_1_1Solver.html#9c522a6cff91adae19af5cce7d8e411f">01610</a>         constraint_index_;
<a name="l01611"></a>01611     additional_constraints_list_.push_back(c);
<a name="l01612"></a>01612     additional_constraints_parent_list_.push_back(constraint_parent);
<a name="l01613"></a>01613   } <span class="keywordflow">else</span> {
<a name="l01614"></a>01614     <span class="keywordflow">if</span> (FLAGS_cp_show_constraints) {
<a name="l01615"></a>01615       LOG(INFO) &lt;&lt; c-&gt;DebugString();
<a name="l01616"></a>01616     }
<a name="l01617"></a>01617     constraints_list_.push_back(c);
<a name="l01618"></a>01618   }
<a name="l01619"></a>01619 }
<a name="l01620"></a>01620 
<a name="l01621"></a>01621 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Solver.html#07f095e73b86c92e29af7093f850e3a3" title="Adds the constraint &amp;#39;c&amp;#39; to the solver and marks it as a delegate constraint...">Solver::AddDelegateConstraint</a>(<a class="code" href="classoperations__research_1_1Solver.html#697ed9eaa8955d595a023663ab1e8418">Constraint</a>* <span class="keyword">const</span> c) {
<a name="l01622"></a>01622   <span class="keywordflow">if</span> (state_ != <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a95066908e143fd988a03767f05e682acaf" title="Executing the search code.">IN_SEARCH</a>) {
<a name="l01623"></a>01623     delegate_constraints_.insert(c);
<a name="l01624"></a>01624   }
<a name="l01625"></a>01625   <a class="code" href="classoperations__research_1_1Solver.html#9c522a6cff91adae19af5cce7d8e411f" title="propagation">AddConstraint</a>(c);
<a name="l01626"></a>01626 }
<a name="l01627"></a>01627 
<a name="l01628"></a>01628 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Solver.html#88de4c7ed8872eaece9bd09b1a7c882f" title="Accepts the given model visitor.">Solver::Accept</a>(ModelVisitor* <span class="keyword">const</span> visitor)<span class="keyword"> const </span>{
<a name="l01629"></a>01629   std::vector&lt;SearchMonitor*&gt; monitors;
<a name="l01630"></a><a class="code" href="classoperations__research_1_1Solver.html#07f095e73b86c92e29af7093f850e3a3">01630</a>   <a class="code" href="classoperations__research_1_1Solver.html#88de4c7ed8872eaece9bd09b1a7c882f" title="Accepts the given model visitor.">Accept</a>(visitor, monitors);
<a name="l01631"></a>01631 }
<a name="l01632"></a>01632 
<a name="l01633"></a>01633 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Solver.html#88de4c7ed8872eaece9bd09b1a7c882f" title="Accepts the given model visitor.">Solver::Accept</a>(<a class="code" href="classoperations__research_1_1ModelVisitor.html" title="Model visitor.">ModelVisitor</a>* <span class="keyword">const</span> visitor,
<a name="l01634"></a>01634                     <span class="keyword">const</span> std::vector&lt;SearchMonitor*&gt;&amp; monitors)<span class="keyword"> const </span>{
<a name="l01635"></a>01635   visitor-&gt;<a class="code" href="classoperations__research_1_1ModelVisitor.html#effe687b21079d1d50b407ebb43d9c02" title="Virtual methods for visitors.">BeginVisitModel</a>(name_);
<a name="l01636"></a>01636   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="pack_8cc.html#750b5d744c39a06bfb13e6eb010e35d0">index</a> = 0; <a class="code" href="pack_8cc.html#750b5d744c39a06bfb13e6eb010e35d0">index</a> &lt; constraints_list_.size(); ++<a class="code" href="pack_8cc.html#750b5d744c39a06bfb13e6eb010e35d0">index</a>) {
<a name="l01637"></a><a class="code" href="classoperations__research_1_1Solver.html#88de4c7ed8872eaece9bd09b1a7c882f">01637</a>     <a class="code" href="classoperations__research_1_1Constraint.html" title="A constraint is the main modeling object.">Constraint</a>* <span class="keyword">const</span> constraint = constraints_list_[<a class="code" href="pack_8cc.html#750b5d744c39a06bfb13e6eb010e35d0">index</a>];
<a name="l01638"></a>01638     constraint-&gt;<a class="code" href="classoperations__research_1_1Constraint.html#816c36feb4ec4ffce6a8d3490029301c" title="Accepts the given visitor.">Accept</a>(visitor);
<a name="l01639"></a>01639   }
<a name="l01640"></a>01640   <span class="keywordflow">if</span> (state_ == <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a950e9b4a7467a4d4f1a7da211e6c59251e" title="Executing the root node.">IN_ROOT_NODE</a>) {
<a name="l01641"></a>01641     searches_.front()-&gt;Accept(visitor);
<a name="l01642"></a><a class="code" href="classoperations__research_1_1Solver.html#e4200b38caf2f098cf43cfb0db9544a4">01642</a>   } <span class="keywordflow">else</span> {
<a name="l01643"></a>01643     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; monitors.size(); ++i) {
<a name="l01644"></a>01644       monitors[i]-&gt;Accept(visitor);
<a name="l01645"></a>01645     }
<a name="l01646"></a>01646   }
<a name="l01647"></a>01647   visitor-&gt;<a class="code" href="classoperations__research_1_1ModelVisitor.html#2675aad9af880079211e264d04a23d48">EndVisitModel</a>(name_);
<a name="l01648"></a>01648 }
<a name="l01649"></a>01649 
<a name="l01650"></a>01650 <span class="keywordtype">void</span> Solver::ProcessConstraints() {
<a name="l01651"></a>01651   <span class="comment">// Both constraints_list_ and additional_constraints_list_ are used in</span>
<a name="l01652"></a>01652   <span class="comment">// a FIFO way.</span>
<a name="l01653"></a>01653   <span class="keywordflow">if</span> (FLAGS_cp_print_model) {
<a name="l01654"></a>01654     ModelVisitor* <span class="keyword">const</span> visitor = <a class="code" href="classoperations__research_1_1Solver.html#dd0408c5d62170393c7d9f231b74d329" title="ModelVisitor.">MakePrintModelVisitor</a>();
<a name="l01655"></a>01655     <a class="code" href="classoperations__research_1_1Solver.html#88de4c7ed8872eaece9bd09b1a7c882f" title="Accepts the given model visitor.">Accept</a>(visitor);
<a name="l01656"></a>01656   }
<a name="l01657"></a>01657   <span class="keywordflow">if</span> (FLAGS_cp_model_stats) {
<a name="l01658"></a>01658     ModelVisitor* <span class="keyword">const</span> visitor = <a class="code" href="classoperations__research_1_1Solver.html#fc6f3bbb86ad33b7ef6c459a9241c413" title="Displays some nice statistics on the model.">MakeStatisticsModelVisitor</a>();
<a name="l01659"></a>01659     <a class="code" href="classoperations__research_1_1Solver.html#88de4c7ed8872eaece9bd09b1a7c882f" title="Accepts the given model visitor.">Accept</a>(visitor);
<a name="l01660"></a>01660   }
<a name="l01661"></a>01661   <span class="keywordflow">if</span> (!FLAGS_cp_export_file.empty()) {
<a name="l01662"></a>01662     File::Init();
<a name="l01663"></a>01663     File* file = File::Open(FLAGS_cp_export_file, <span class="stringliteral">"w"</span>);
<a name="l01664"></a>01664     <span class="keywordflow">if</span> (file == NULL) {
<a name="l01665"></a>01665       LOG(WARNING) &lt;&lt; <span class="stringliteral">"Cannot open "</span> &lt;&lt; FLAGS_cp_export_file;
<a name="l01666"></a>01666     } <span class="keywordflow">else</span> {
<a name="l01667"></a>01667       CPModelProto export_proto;
<a name="l01668"></a>01668       <a class="code" href="classoperations__research_1_1Solver.html#2663a7feeb159961b7e3d08968cc374f" title="Exports the model to protobuf.">ExportModel</a>(&amp;export_proto);
<a name="l01669"></a>01669       VLOG(1) &lt;&lt; export_proto.DebugString();
<a name="l01670"></a>01670       RecordWriter writer(file);
<a name="l01671"></a>01671       writer.WriteProtocolMessage(export_proto);
<a name="l01672"></a>01672       writer.Close();
<a name="l01673"></a>01673     }
<a name="l01674"></a>01674   }
<a name="l01675"></a>01675 
<a name="l01676"></a>01676   <span class="keywordflow">if</span> (FLAGS_cp_no_solve) {
<a name="l01677"></a>01677     LOG(INFO) &lt;&lt; <span class="stringliteral">"Forcing early failure"</span>;
<a name="l01678"></a>01678     <a class="code" href="classoperations__research_1_1Solver.html#45534161a4dda7e1997bc0effd606648" title="Abandon the current branch in the search tree. A backtrack will follow.">Fail</a>();
<a name="l01679"></a>01679   }
<a name="l01680"></a>01680 
<a name="l01681"></a>01681   <span class="comment">// Clear state before processing constraints.</span>
<a name="l01682"></a>01682   <span class="keyword">const</span> <span class="keywordtype">int</span> constraints_size = constraints_list_.size();
<a name="l01683"></a>01683   additional_constraints_list_.clear();
<a name="l01684"></a>01684   additional_constraints_parent_list_.clear();
<a name="l01685"></a>01685 
<a name="l01686"></a>01686   <span class="comment">// Process constraints from the model.</span>
<a name="l01687"></a>01687   <span class="keyword">const</span> <span class="keywordtype">bool</span> profile = <a class="code" href="classoperations__research_1_1Solver.html#156b32cc07fa9ae5fde5e3a9ee907a4d" title="Returns wether we are profiling constraints.">Profile</a>();
<a name="l01688"></a>01688   <span class="keywordflow">for</span> (constraint_index_ = 0;
<a name="l01689"></a>01689        constraint_index_ &lt; constraints_size;
<a name="l01690"></a>01690        ++constraint_index_) {
<a name="l01691"></a>01691     <a class="code" href="classoperations__research_1_1Solver.html#697ed9eaa8955d595a023663ab1e8418">Constraint</a>* <span class="keyword">const</span> constraint = constraints_list_[constraint_index_];
<a name="l01692"></a>01692     <span class="keywordflow">if</span> (profile) {
<a name="l01693"></a>01693       <a class="code" href="namespaceoperations__research.html#b5240e8c0ba682f97baea46641082c70">DemonMonitorStartInitialPropagation</a>(demon_monitor_, constraint);
<a name="l01694"></a>01694     }
<a name="l01695"></a>01695     constraint-&gt;PostAndPropagate();
<a name="l01696"></a>01696     <span class="keywordflow">if</span> (profile) {
<a name="l01697"></a>01697       <a class="code" href="namespaceoperations__research.html#aa11d663f99a1dda5d5228aaf3014602">DemonMonitorEndInitialPropagation</a>(demon_monitor_, constraint);
<a name="l01698"></a>01698     }
<a name="l01699"></a>01699   }
<a name="l01700"></a>01700   CHECK_EQ(constraints_list_.size(), constraints_size);
<a name="l01701"></a>01701 
<a name="l01702"></a>01702   <span class="comment">// Process nested constraints added during the previous step.</span>
<a name="l01703"></a>01703   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> additional_constraint_index_ = 0;
<a name="l01704"></a>01704        additional_constraint_index_ &lt; additional_constraints_list_.size();
<a name="l01705"></a>01705        ++additional_constraint_index_) {
<a name="l01706"></a>01706     <a class="code" href="classoperations__research_1_1Solver.html#697ed9eaa8955d595a023663ab1e8418">Constraint</a>* <span class="keyword">const</span> nested =
<a name="l01707"></a>01707         additional_constraints_list_[additional_constraint_index_];
<a name="l01708"></a>01708     <span class="keyword">const</span> <span class="keywordtype">int</span> parent_index =
<a name="l01709"></a>01709         additional_constraints_parent_list_[additional_constraint_index_];
<a name="l01710"></a>01710     <span class="keyword">const</span> <a class="code" href="classoperations__research_1_1Solver.html#697ed9eaa8955d595a023663ab1e8418">Constraint</a>* <span class="keyword">const</span> parent = constraints_list_[parent_index];
<a name="l01711"></a>01711     <span class="keywordflow">if</span> (profile) {
<a name="l01712"></a>01712       <a class="code" href="namespaceoperations__research.html#70ceefb1ec146ec849dc8babf6fc7286">DemonMonitorStartInitialNestedPropagation</a>(demon_monitor_,
<a name="l01713"></a>01713                                                 parent,
<a name="l01714"></a>01714                                                 nested);
<a name="l01715"></a>01715     }
<a name="l01716"></a>01716     nested-&gt;PostAndPropagate();
<a name="l01717"></a>01717     <span class="keywordflow">if</span> (profile) {
<a name="l01718"></a>01718       <a class="code" href="namespaceoperations__research.html#ae54e5a5cdc80f0f8d63675197f99665">DemonMonitorEndInitialNestedPropagation</a>(demon_monitor_,
<a name="l01719"></a>01719                                               parent,
<a name="l01720"></a>01720                                               nested);
<a name="l01721"></a>01721     }
<a name="l01722"></a>01722   }
<a name="l01723"></a>01723 }
<a name="l01724"></a>01724 
<a name="l01725"></a>01725 <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1Solver.html#6d31c124181afb65d1441712e5f392d2" title="Returns true wether the current search has been created using a Solve() call instead...">Solver::CurrentlyInSolve</a>()<span class="keyword"> const </span>{
<a name="l01726"></a>01726   DCHECK_GT(searches_.size(), 0);
<a name="l01727"></a>01727   DCHECK(searches_.back() != NULL);
<a name="l01728"></a>01728   <span class="keywordflow">return</span> searches_.back()-&gt;created_by_solve();
<a name="l01729"></a>01729 }
<a name="l01730"></a>01730 
<a name="l01731"></a>01731 <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1Solver.html#3ce9d85b90e2416f59ee89b13579c725" title="search">Solver::Solve</a>(DecisionBuilder* <span class="keyword">const</span> db,
<a name="l01732"></a>01732                    <span class="keyword">const</span> std::vector&lt;SearchMonitor*&gt;&amp; monitors) {
<a name="l01733"></a>01733   <span class="keywordflow">return</span> <a class="code" href="classoperations__research_1_1Solver.html#3ce9d85b90e2416f59ee89b13579c725" title="search">Solve</a>(db, monitors.data(), monitors.size());
<a name="l01734"></a><a class="code" href="classoperations__research_1_1Solver.html#6d31c124181afb65d1441712e5f392d2">01734</a> }
<a name="l01735"></a>01735 
<a name="l01736"></a>01736 <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1Solver.html#3ce9d85b90e2416f59ee89b13579c725" title="search">Solver::Solve</a>(<a class="code" href="classoperations__research_1_1DecisionBuilder.html" title="A DecisionBuilder is responsible for creating the search tree.">DecisionBuilder</a>* <span class="keyword">const</span> db, <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <span class="keyword">const</span> m1) {
<a name="l01737"></a>01737   std::vector&lt;SearchMonitor*&gt; monitors;
<a name="l01738"></a>01738   monitors.push_back(m1);
<a name="l01739"></a>01739   <span class="keywordflow">return</span> <a class="code" href="classoperations__research_1_1Solver.html#3ce9d85b90e2416f59ee89b13579c725" title="search">Solve</a>(db, monitors.data(), monitors.size());
<a name="l01740"></a><a class="code" href="classoperations__research_1_1Solver.html#3ce9d85b90e2416f59ee89b13579c725">01740</a> }
<a name="l01741"></a>01741 
<a name="l01742"></a>01742 <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1Solver.html#3ce9d85b90e2416f59ee89b13579c725" title="search">Solver::Solve</a>(<a class="code" href="classoperations__research_1_1DecisionBuilder.html" title="A DecisionBuilder is responsible for creating the search tree.">DecisionBuilder</a>* <span class="keyword">const</span> db) {
<a name="l01743"></a>01743   <span class="keywordflow">return</span> <a class="code" href="classoperations__research_1_1Solver.html#3ce9d85b90e2416f59ee89b13579c725" title="search">Solve</a>(db, NULL, <a class="code" href="namespaceoperations__research.html#009f247167f32509baf749083e4bc984" title="Misc.">Zero</a>());
<a name="l01744"></a>01744 }
<a name="l01745"></a><a class="code" href="classoperations__research_1_1Solver.html#de33b8a9dce522094d5ce4b53fd5299d">01745</a> 
<a name="l01746"></a>01746 <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1Solver.html#3ce9d85b90e2416f59ee89b13579c725" title="search">Solver::Solve</a>(<a class="code" href="classoperations__research_1_1DecisionBuilder.html" title="A DecisionBuilder is responsible for creating the search tree.">DecisionBuilder</a>* <span class="keyword">const</span> db,
<a name="l01747"></a>01747                    <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <span class="keyword">const</span> m1,
<a name="l01748"></a>01748                    <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <span class="keyword">const</span> m2) {
<a name="l01749"></a>01749   std::vector&lt;SearchMonitor*&gt; monitors;
<a name="l01750"></a>01750   monitors.push_back(m1);
<a name="l01751"></a><a class="code" href="classoperations__research_1_1Solver.html#ab76d0849165f2c5b70ca910114607cd">01751</a>   monitors.push_back(m2);
<a name="l01752"></a>01752   <span class="keywordflow">return</span> <a class="code" href="classoperations__research_1_1Solver.html#3ce9d85b90e2416f59ee89b13579c725" title="search">Solve</a>(db, monitors.data(), monitors.size());
<a name="l01753"></a>01753 }
<a name="l01754"></a>01754 
<a name="l01755"></a><a class="code" href="classoperations__research_1_1Solver.html#ae3ef7a28da87aeb3fbd258210f805c7">01755</a> <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1Solver.html#3ce9d85b90e2416f59ee89b13579c725" title="search">Solver::Solve</a>(<a class="code" href="classoperations__research_1_1DecisionBuilder.html" title="A DecisionBuilder is responsible for creating the search tree.">DecisionBuilder</a>* <span class="keyword">const</span> db,
<a name="l01756"></a>01756                    <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <span class="keyword">const</span> m1,
<a name="l01757"></a>01757                    <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <span class="keyword">const</span> m2,
<a name="l01758"></a>01758                    <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <span class="keyword">const</span> m3) {
<a name="l01759"></a>01759   std::vector&lt;SearchMonitor*&gt; monitors;
<a name="l01760"></a>01760   monitors.push_back(m1);
<a name="l01761"></a>01761   monitors.push_back(m2);
<a name="l01762"></a>01762   monitors.push_back(m3);
<a name="l01763"></a>01763   <span class="keywordflow">return</span> <a class="code" href="classoperations__research_1_1Solver.html#3ce9d85b90e2416f59ee89b13579c725" title="search">Solve</a>(db, monitors.data(), monitors.size());
<a name="l01764"></a><a class="code" href="classoperations__research_1_1Solver.html#18f600b8b9594c59d9da9fb1b93cfa9b">01764</a> }
<a name="l01765"></a>01765 
<a name="l01766"></a>01766 <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1Solver.html#3ce9d85b90e2416f59ee89b13579c725" title="search">Solver::Solve</a>(<a class="code" href="classoperations__research_1_1DecisionBuilder.html" title="A DecisionBuilder is responsible for creating the search tree.">DecisionBuilder</a>* <span class="keyword">const</span> db,
<a name="l01767"></a>01767                    <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <span class="keyword">const</span> m1,
<a name="l01768"></a>01768                    <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <span class="keyword">const</span> m2,
<a name="l01769"></a>01769                    <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <span class="keyword">const</span> m3,
<a name="l01770"></a>01770                    <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <span class="keyword">const</span> m4) {
<a name="l01771"></a>01771   std::vector&lt;SearchMonitor*&gt; monitors;
<a name="l01772"></a>01772   monitors.push_back(m1);
<a name="l01773"></a>01773   monitors.push_back(m2);
<a name="l01774"></a>01774   monitors.push_back(m3);
<a name="l01775"></a><a class="code" href="classoperations__research_1_1Solver.html#dadd60fc9e9d63a293b606376a171578">01775</a>   monitors.push_back(m4);
<a name="l01776"></a>01776   <span class="keywordflow">return</span> <a class="code" href="classoperations__research_1_1Solver.html#3ce9d85b90e2416f59ee89b13579c725" title="search">Solve</a>(db, monitors.data(), monitors.size());
<a name="l01777"></a>01777 }
<a name="l01778"></a>01778 
<a name="l01779"></a>01779 <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1Solver.html#3ce9d85b90e2416f59ee89b13579c725" title="search">Solver::Solve</a>(<a class="code" href="classoperations__research_1_1DecisionBuilder.html" title="A DecisionBuilder is responsible for creating the search tree.">DecisionBuilder</a>* <span class="keyword">const</span> db,
<a name="l01780"></a>01780                    <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <span class="keyword">const</span> * monitors,
<a name="l01781"></a>01781                    <span class="keywordtype">int</span> size) {
<a name="l01782"></a>01782   <a class="code" href="classoperations__research_1_1Solver.html#67ed18b7174df0eb483834276f19ce73" title="Decomposed top level search.">NewSearch</a>(db, monitors, size);
<a name="l01783"></a>01783   searches_.back()-&gt;set_created_by_solve(<span class="keyword">true</span>);  <span class="comment">// Overwrites default.</span>
<a name="l01784"></a>01784   <a class="code" href="classoperations__research_1_1Solver.html#11ed2a5d7bb8fb1a8967fee572ab9c47" title="namespace">NextSolution</a>();
<a name="l01785"></a>01785   <span class="keyword">const</span> <span class="keywordtype">bool</span> solution_found = searches_.back()-&gt;solution_counter() &gt; 0;
<a name="l01786"></a>01786   <a class="code" href="classoperations__research_1_1Solver.html#b95c7f997dbe36deb51e7c0213bdf445">EndSearch</a>();
<a name="l01787"></a>01787   <span class="keywordflow">return</span> solution_found;
<a name="l01788"></a><a class="code" href="classoperations__research_1_1Solver.html#65c256a6d5fc54a6921b63741bbbf779">01788</a> }
<a name="l01789"></a>01789 
<a name="l01790"></a>01790 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Solver.html#67ed18b7174df0eb483834276f19ce73" title="Decomposed top level search.">Solver::NewSearch</a>(<a class="code" href="classoperations__research_1_1DecisionBuilder.html" title="A DecisionBuilder is responsible for creating the search tree.">DecisionBuilder</a>* <span class="keyword">const</span> db,
<a name="l01791"></a>01791                        <span class="keyword">const</span> std::vector&lt;SearchMonitor*&gt;&amp; monitors) {
<a name="l01792"></a>01792   <span class="keywordflow">return</span> <a class="code" href="classoperations__research_1_1Solver.html#67ed18b7174df0eb483834276f19ce73" title="Decomposed top level search.">NewSearch</a>(db, monitors.data(), monitors.size());
<a name="l01793"></a>01793 }
<a name="l01794"></a>01794 
<a name="l01795"></a>01795 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Solver.html#67ed18b7174df0eb483834276f19ce73" title="Decomposed top level search.">Solver::NewSearch</a>(DecisionBuilder* <span class="keyword">const</span> db, <a class="code" href="classoperations__research_1_1Solver.html#ac32a6eabe1d316d7ff5f92fedd1ec5b">SearchMonitor</a>* <span class="keyword">const</span> m1) {
<a name="l01796"></a>01796   std::vector&lt;SearchMonitor*&gt; monitors;
<a name="l01797"></a>01797   monitors.push_back(m1);
<a name="l01798"></a>01798   <span class="keywordflow">return</span> <a class="code" href="classoperations__research_1_1Solver.html#67ed18b7174df0eb483834276f19ce73" title="Decomposed top level search.">NewSearch</a>(db, monitors.data(), monitors.size());
<a name="l01799"></a><a class="code" href="classoperations__research_1_1Solver.html#67ed18b7174df0eb483834276f19ce73">01799</a> }
<a name="l01800"></a>01800 
<a name="l01801"></a>01801 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Solver.html#67ed18b7174df0eb483834276f19ce73" title="Decomposed top level search.">Solver::NewSearch</a>(<a class="code" href="classoperations__research_1_1DecisionBuilder.html" title="A DecisionBuilder is responsible for creating the search tree.">DecisionBuilder</a>* <span class="keyword">const</span> db) {
<a name="l01802"></a>01802   <span class="keywordflow">return</span> <a class="code" href="classoperations__research_1_1Solver.html#67ed18b7174df0eb483834276f19ce73" title="Decomposed top level search.">NewSearch</a>(db, NULL, <a class="code" href="namespaceoperations__research.html#009f247167f32509baf749083e4bc984" title="Misc.">Zero</a>());
<a name="l01803"></a>01803 }
<a name="l01804"></a><a class="code" href="classoperations__research_1_1Solver.html#0e93535e454db167f3b2bac3ffc18610">01804</a> 
<a name="l01805"></a>01805 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Solver.html#67ed18b7174df0eb483834276f19ce73" title="Decomposed top level search.">Solver::NewSearch</a>(<a class="code" href="classoperations__research_1_1DecisionBuilder.html" title="A DecisionBuilder is responsible for creating the search tree.">DecisionBuilder</a>* <span class="keyword">const</span> db,
<a name="l01806"></a>01806                        <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <span class="keyword">const</span> m1,
<a name="l01807"></a>01807                        <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <span class="keyword">const</span> m2) {
<a name="l01808"></a>01808   std::vector&lt;SearchMonitor*&gt; monitors;
<a name="l01809"></a>01809   monitors.push_back(m1);
<a name="l01810"></a><a class="code" href="classoperations__research_1_1Solver.html#92bf29bae6bb68ecae8d09e477183689">01810</a>   monitors.push_back(m2);
<a name="l01811"></a>01811   <span class="keywordflow">return</span> <a class="code" href="classoperations__research_1_1Solver.html#67ed18b7174df0eb483834276f19ce73" title="Decomposed top level search.">NewSearch</a>(db, monitors.data(), monitors.size());
<a name="l01812"></a>01812 }
<a name="l01813"></a>01813 
<a name="l01814"></a><a class="code" href="classoperations__research_1_1Solver.html#77376dffe41cb00920902a485c137b75">01814</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Solver.html#67ed18b7174df0eb483834276f19ce73" title="Decomposed top level search.">Solver::NewSearch</a>(<a class="code" href="classoperations__research_1_1DecisionBuilder.html" title="A DecisionBuilder is responsible for creating the search tree.">DecisionBuilder</a>* <span class="keyword">const</span> db,
<a name="l01815"></a>01815                        <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <span class="keyword">const</span> m1,
<a name="l01816"></a>01816                        <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <span class="keyword">const</span> m2,
<a name="l01817"></a>01817                        <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <span class="keyword">const</span> m3) {
<a name="l01818"></a>01818   std::vector&lt;SearchMonitor*&gt; monitors;
<a name="l01819"></a>01819   monitors.push_back(m1);
<a name="l01820"></a>01820   monitors.push_back(m2);
<a name="l01821"></a>01821   monitors.push_back(m3);
<a name="l01822"></a>01822   <span class="keywordflow">return</span> <a class="code" href="classoperations__research_1_1Solver.html#67ed18b7174df0eb483834276f19ce73" title="Decomposed top level search.">NewSearch</a>(db, monitors.data(), monitors.size());
<a name="l01823"></a><a class="code" href="classoperations__research_1_1Solver.html#309a2fb045ca55e103b3705b3ad3ba39">01823</a> }
<a name="l01824"></a>01824 
<a name="l01825"></a>01825 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Solver.html#67ed18b7174df0eb483834276f19ce73" title="Decomposed top level search.">Solver::NewSearch</a>(<a class="code" href="classoperations__research_1_1DecisionBuilder.html" title="A DecisionBuilder is responsible for creating the search tree.">DecisionBuilder</a>* <span class="keyword">const</span> db,
<a name="l01826"></a>01826                        <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <span class="keyword">const</span> m1,
<a name="l01827"></a>01827                        <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <span class="keyword">const</span> m2,
<a name="l01828"></a>01828                        <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <span class="keyword">const</span> m3,
<a name="l01829"></a>01829                        <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <span class="keyword">const</span> m4) {
<a name="l01830"></a>01830   std::vector&lt;SearchMonitor*&gt; monitors;
<a name="l01831"></a>01831   monitors.push_back(m1);
<a name="l01832"></a>01832   monitors.push_back(m2);
<a name="l01833"></a>01833   monitors.push_back(m3);
<a name="l01834"></a><a class="code" href="classoperations__research_1_1Solver.html#5b0d44ae2db74b96268885785bd9c328">01834</a>   monitors.push_back(m4);
<a name="l01835"></a>01835   <span class="keywordflow">return</span> <a class="code" href="classoperations__research_1_1Solver.html#67ed18b7174df0eb483834276f19ce73" title="Decomposed top level search.">NewSearch</a>(db, monitors.data(), monitors.size());
<a name="l01836"></a>01836 }
<a name="l01837"></a>01837 
<a name="l01838"></a>01838 <span class="comment">// Opens a new top level search.</span>
<a name="l01839"></a>01839 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Solver.html#67ed18b7174df0eb483834276f19ce73" title="Decomposed top level search.">Solver::NewSearch</a>(<a class="code" href="classoperations__research_1_1DecisionBuilder.html" title="A DecisionBuilder is responsible for creating the search tree.">DecisionBuilder</a>* <span class="keyword">const</span> db,
<a name="l01840"></a>01840                        <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <span class="keyword">const</span> * monitors,
<a name="l01841"></a>01841                        <span class="keywordtype">int</span> size) {
<a name="l01842"></a>01842   <span class="comment">// TODO(user) : reset statistics</span>
<a name="l01843"></a>01843 
<a name="l01844"></a>01844   CHECK_NOTNULL(db);
<a name="l01845"></a>01845   DCHECK_GE(size, 0);
<a name="l01846"></a>01846 
<a name="l01847"></a>01847   <span class="keywordflow">if</span> (state_ == <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a95066908e143fd988a03767f05e682acaf" title="Executing the search code.">IN_SEARCH</a> || state_ == <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a950e9b4a7467a4d4f1a7da211e6c59251e" title="Executing the root node.">IN_ROOT_NODE</a>) {
<a name="l01848"></a><a class="code" href="classoperations__research_1_1Solver.html#f1b1699d53b5182d872335aaeac0673a">01848</a>     LOG(FATAL) &lt;&lt; <span class="stringliteral">"Use NestedSolve() inside search"</span>;
<a name="l01849"></a>01849   }
<a name="l01850"></a>01850   <span class="comment">// Check state and go to OUTSIDE_SEARCH.</span>
<a name="l01851"></a>01851   <a class="code" href="classoperations__research_1_1Search.html" title="Search class.">Search</a>* <span class="keyword">const</span> search = searches_.back();
<a name="l01852"></a>01852   search-&gt;<a class="code" href="classoperations__research_1_1Search.html#1fcd92000011aeb8f6dc5454bfba38a9">set_created_by_solve</a>(<span class="keyword">false</span>);  <span class="comment">// default behavior.</span>
<a name="l01853"></a>01853 
<a name="l01854"></a>01854   BacktrackToSentinel(<a class="code" href="namespaceoperations__research.html#f1ab36801da5984b89300bc340ca2570">INITIAL_SEARCH_SENTINEL</a>);
<a name="l01855"></a>01855   state_ = <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a95c05654b6a7479316478744b3ce4a50df" title="Before search, after search.">OUTSIDE_SEARCH</a>;
<a name="l01856"></a>01856 
<a name="l01857"></a>01857   <span class="comment">// Push monitors and enter search.</span>
<a name="l01858"></a>01858   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; size; ++i) {
<a name="l01859"></a>01859     search-&gt;<a class="code" href="classoperations__research_1_1Search.html#b75f27d7740f8a0d5428878f589c0b49">push_monitor</a>(monitors[i]);
<a name="l01860"></a>01860   }
<a name="l01861"></a>01861   std::vector&lt;SearchMonitor*&gt; extras;
<a name="l01862"></a>01862   db-&gt;<a class="code" href="classoperations__research_1_1DecisionBuilder.html#61ba3c6d0da12541495cfea7e892ec99" title="This method will be called at the start of the search.">AppendMonitors</a>(<span class="keyword">this</span>, &amp;extras);
<a name="l01863"></a>01863   <span class="keywordflow">for</span> (ConstIter&lt;std::vector&lt;SearchMonitor*&gt; &gt; it(extras); !it.at_end(); ++it) {
<a name="l01864"></a>01864     search-&gt;<a class="code" href="classoperations__research_1_1Search.html#b75f27d7740f8a0d5428878f589c0b49">push_monitor</a>(*it);
<a name="l01865"></a>01865   }
<a name="l01866"></a>01866   search-&gt;<a class="code" href="classoperations__research_1_1Search.html#b3a81afa65291b9bdd3f3a168ce55aa4">EnterSearch</a>();
<a name="l01867"></a>01867 
<a name="l01868"></a>01868   <span class="comment">// Push sentinel and set decision builder.</span>
<a name="l01869"></a>01869   DCHECK_EQ(1, searches_.size());
<a name="l01870"></a>01870   PushSentinel(<a class="code" href="namespaceoperations__research.html#f1ab36801da5984b89300bc340ca2570">INITIAL_SEARCH_SENTINEL</a>);
<a name="l01871"></a>01871   search-&gt;<a class="code" href="classoperations__research_1_1Search.html#4b37a519f7faebaeb4b6be5c62757c2b">set_decision_builder</a>(db);
<a name="l01872"></a>01872 }
<a name="l01873"></a>01873 
<a name="l01874"></a>01874 <span class="comment">// Backtrack to the last open right branch in the search tree.</span>
<a name="l01875"></a>01875 <span class="comment">// It returns true in case the search tree has been completely explored.</span>
<a name="l01876"></a>01876 <span class="keywordtype">bool</span> Solver::BacktrackOneLevel(Decision** fail_decision) {
<a name="l01877"></a>01877   <span class="keywordtype">bool</span> no_more_solutions = <span class="keyword">false</span>;
<a name="l01878"></a>01878   <span class="keywordtype">bool</span> end_loop = <span class="keyword">false</span>;
<a name="l01879"></a>01879   <span class="keywordflow">while</span> (!end_loop) {
<a name="l01880"></a>01880     StateInfo info;
<a name="l01881"></a>01881     <a class="code" href="namespaceoperations__research.html#5881ca2f6350f69f63b48b872c1c7e5e" title="This enum is used internally to tag states in the search tree.">MarkerType</a> t = <a class="code" href="classoperations__research_1_1Solver.html#67a90d3f386c8530100f810ef54a240a">PopState</a>(&amp;info);
<a name="l01882"></a>01882     <span class="keywordflow">switch</span> (t) {
<a name="l01883"></a>01883       <span class="keywordflow">case</span> <a class="code" href="namespaceoperations__research.html#5881ca2f6350f69f63b48b872c1c7e5e9a277c2d196896995aaffb41aec2faea">SENTINEL</a>:
<a name="l01884"></a>01884         CHECK_EQ(info.ptr_info, <span class="keyword">this</span>) &lt;&lt; <span class="stringliteral">"Wrong sentinel found"</span>;
<a name="l01885"></a>01885         CHECK((info.int_info == <a class="code" href="namespaceoperations__research.html#750b3027192fb2ccc71c4b318aa4f850">ROOT_NODE_SENTINEL</a> &amp;&amp; searches_.size() == 1) ||
<a name="l01886"></a>01886               (info.int_info == <a class="code" href="namespaceoperations__research.html#f1ab36801da5984b89300bc340ca2570">INITIAL_SEARCH_SENTINEL</a> &amp;&amp;
<a name="l01887"></a>01887                searches_.size() &gt; 1));
<a name="l01888"></a>01888         searches_.back()-&gt;sentinel_pushed_--;
<a name="l01889"></a>01889         no_more_solutions = <span class="keyword">true</span>;
<a name="l01890"></a>01890         end_loop = <span class="keyword">true</span>;
<a name="l01891"></a>01891         <span class="keywordflow">break</span>;
<a name="l01892"></a>01892       <span class="keywordflow">case</span> <a class="code" href="namespaceoperations__research.html#5881ca2f6350f69f63b48b872c1c7e5e695cce0161b127055c52d41744e97395">SIMPLE_MARKER</a>:
<a name="l01893"></a>01893         LOG(ERROR)
<a name="l01894"></a>01894             &lt;&lt; <span class="stringliteral">"Simple markers should not be encountered during search"</span>;
<a name="l01895"></a>01895         <span class="keywordflow">break</span>;
<a name="l01896"></a>01896       <span class="keywordflow">case</span> <a class="code" href="namespaceoperations__research.html#5881ca2f6350f69f63b48b872c1c7e5e1d3aaf5d04e4a502a2db3fa71a1061b7">CHOICE_POINT</a>:
<a name="l01897"></a>01897         <span class="keywordflow">if</span> (info.int_info == 0) {  <span class="comment">// was left branch</span>
<a name="l01898"></a>01898           (*fail_decision) = <span class="keyword">reinterpret_cast&lt;</span>Decision*<span class="keyword">&gt;</span>(info.ptr_info);
<a name="l01899"></a>01899           end_loop = <span class="keyword">true</span>;
<a name="l01900"></a>01900           searches_.back()-&gt;set_search_depth(info.depth);
<a name="l01901"></a>01901           searches_.back()-&gt;set_search_left_depth(info.left_depth);
<a name="l01902"></a>01902         }
<a name="l01903"></a>01903         <span class="keywordflow">break</span>;
<a name="l01904"></a>01904       <span class="keywordflow">case</span> <a class="code" href="namespaceoperations__research.html#5881ca2f6350f69f63b48b872c1c7e5e7d02bd6f10e34551ac9b74d12ee3d746">REVERSIBLE_ACTION</a>: {
<a name="l01905"></a>01905         Action* d = <span class="keyword">reinterpret_cast&lt;</span>Action*<span class="keyword">&gt;</span>(info.ptr_info);
<a name="l01906"></a>01906         d-&gt;Run(<span class="keyword">this</span>);
<a name="l01907"></a>01907         <span class="keywordflow">break</span>;
<a name="l01908"></a>01908       }
<a name="l01909"></a>01909     }
<a name="l01910"></a>01910   }
<a name="l01911"></a>01911   Search* <span class="keyword">const</span> search = searches_.back();
<a name="l01912"></a>01912   search-&gt;EndFail();
<a name="l01913"></a>01913   CallFailHooks();
<a name="l01914"></a>01914   fail_stamp_++;
<a name="l01915"></a>01915   <span class="keywordflow">if</span> (no_more_solutions) {
<a name="l01916"></a>01916     search-&gt;NoMoreSolutions();
<a name="l01917"></a>01917   }
<a name="l01918"></a>01918   <span class="keywordflow">return</span> no_more_solutions;
<a name="l01919"></a>01919 }
<a name="l01920"></a>01920 
<a name="l01921"></a>01921 <span class="keywordtype">void</span> Solver::PushSentinel(<span class="keywordtype">int</span> magic_code) {
<a name="l01922"></a>01922   StateInfo info(<span class="keyword">this</span>, magic_code);
<a name="l01923"></a>01923   <a class="code" href="classoperations__research_1_1Solver.html#6d2ae179cd6e66dc4cfd14307126b2cb" title="The PushState and PopState methods manipulates the states of the reversible objects...">PushState</a>(<a class="code" href="namespaceoperations__research.html#5881ca2f6350f69f63b48b872c1c7e5e9a277c2d196896995aaffb41aec2faea">SENTINEL</a>, info);
<a name="l01924"></a>01924   <span class="comment">// We do not count the sentinel pushed in the ctor.</span>
<a name="l01925"></a>01925   <span class="keywordflow">if</span> (magic_code != <a class="code" href="namespaceoperations__research.html#ec3e91d46100e1b95d4293ff52730113">SOLVER_CTOR_SENTINEL</a>) {
<a name="l01926"></a>01926     searches_.back()-&gt;sentinel_pushed_++;
<a name="l01927"></a>01927   }
<a name="l01928"></a>01928   <span class="keyword">const</span> <span class="keywordtype">int</span> pushed = searches_.back()-&gt;sentinel_pushed_;
<a name="l01929"></a>01929   DCHECK((magic_code == <a class="code" href="namespaceoperations__research.html#ec3e91d46100e1b95d4293ff52730113">SOLVER_CTOR_SENTINEL</a>) ||
<a name="l01930"></a>01930          (magic_code == <a class="code" href="namespaceoperations__research.html#f1ab36801da5984b89300bc340ca2570">INITIAL_SEARCH_SENTINEL</a> &amp;&amp; pushed == 1) ||
<a name="l01931"></a>01931          (magic_code == <a class="code" href="namespaceoperations__research.html#750b3027192fb2ccc71c4b318aa4f850">ROOT_NODE_SENTINEL</a> &amp;&amp; pushed == 2));
<a name="l01932"></a>01932 }
<a name="l01933"></a>01933 
<a name="l01934"></a>01934 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Solver.html#13e7e93a66ce0f15343c48c66d615e47">Solver::RestartSearch</a>() {
<a name="l01935"></a>01935   Search* <span class="keyword">const</span> search = searches_.back();
<a name="l01936"></a>01936   CHECK_NE(0, search-&gt;sentinel_pushed_);
<a name="l01937"></a>01937   <span class="keywordflow">if</span> (searches_.size() == 1) {  <span class="comment">// top level.</span>
<a name="l01938"></a>01938     <span class="keywordflow">if</span> (search-&gt;sentinel_pushed_ &gt; 1) {
<a name="l01939"></a>01939       BacktrackToSentinel(<a class="code" href="namespaceoperations__research.html#750b3027192fb2ccc71c4b318aa4f850">ROOT_NODE_SENTINEL</a>);
<a name="l01940"></a>01940     }
<a name="l01941"></a>01941     CHECK_EQ(1, search-&gt;sentinel_pushed_);
<a name="l01942"></a>01942     PushSentinel(<a class="code" href="namespaceoperations__research.html#750b3027192fb2ccc71c4b318aa4f850">ROOT_NODE_SENTINEL</a>);
<a name="l01943"></a><a class="code" href="classoperations__research_1_1Solver.html#13e7e93a66ce0f15343c48c66d615e47">01943</a>     state_ = <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a95066908e143fd988a03767f05e682acaf" title="Executing the search code.">IN_SEARCH</a>;
<a name="l01944"></a>01944   } <span class="keywordflow">else</span> {
<a name="l01945"></a>01945     CHECK_EQ(<a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a95066908e143fd988a03767f05e682acaf" title="Executing the search code.">IN_SEARCH</a>, state_);
<a name="l01946"></a>01946     <span class="keywordflow">if</span> (search-&gt;sentinel_pushed_ &gt; 0) {
<a name="l01947"></a>01947       BacktrackToSentinel(<a class="code" href="namespaceoperations__research.html#f1ab36801da5984b89300bc340ca2570">INITIAL_SEARCH_SENTINEL</a>);
<a name="l01948"></a>01948     }
<a name="l01949"></a>01949     CHECK_EQ(0, search-&gt;sentinel_pushed_);
<a name="l01950"></a>01950     PushSentinel(<a class="code" href="namespaceoperations__research.html#f1ab36801da5984b89300bc340ca2570">INITIAL_SEARCH_SENTINEL</a>);
<a name="l01951"></a>01951   }
<a name="l01952"></a>01952 
<a name="l01953"></a>01953   <span class="keywordflow">if</span> (<a class="code" href="classoperations__research_1_1Solver.html#156b32cc07fa9ae5fde5e3a9ee907a4d" title="Returns wether we are profiling constraints.">Profile</a>()) {
<a name="l01954"></a>01954     CHECK_NOTNULL(demon_monitor_);
<a name="l01955"></a>01955     <a class="code" href="namespaceoperations__research.html#2d60edc96e40e663962f32ffa4685ec6">DemonMonitorRestartSearch</a>(demon_monitor_);
<a name="l01956"></a>01956   }
<a name="l01957"></a>01957 
<a name="l01958"></a>01958   search-&gt;RestartSearch();
<a name="l01959"></a>01959 }
<a name="l01960"></a>01960 
<a name="l01961"></a>01961 <span class="comment">// Backtrack to the initial search sentinel.</span>
<a name="l01962"></a>01962 <span class="comment">// Does not change the state, this should be done by the caller.</span>
<a name="l01963"></a>01963 <span class="keywordtype">void</span> Solver::BacktrackToSentinel(<span class="keywordtype">int</span> magic_code) {
<a name="l01964"></a>01964   Search* <span class="keyword">const</span> search = searches_.back();
<a name="l01965"></a>01965   <span class="keywordtype">bool</span> end_loop = search-&gt;sentinel_pushed_ == 0;
<a name="l01966"></a>01966   <span class="keywordflow">while</span> (!end_loop) {
<a name="l01967"></a>01967     StateInfo info;
<a name="l01968"></a>01968     <a class="code" href="namespaceoperations__research.html#5881ca2f6350f69f63b48b872c1c7e5e" title="This enum is used internally to tag states in the search tree.">MarkerType</a> t = <a class="code" href="classoperations__research_1_1Solver.html#67a90d3f386c8530100f810ef54a240a">PopState</a>(&amp;info);
<a name="l01969"></a>01969     <span class="keywordflow">switch</span> (t) {
<a name="l01970"></a>01970       <span class="keywordflow">case</span> <a class="code" href="namespaceoperations__research.html#5881ca2f6350f69f63b48b872c1c7e5e9a277c2d196896995aaffb41aec2faea">SENTINEL</a>: {
<a name="l01971"></a>01971         CHECK_EQ(info.ptr_info, <span class="keyword">this</span>) &lt;&lt; <span class="stringliteral">"Wrong sentinel found"</span>;
<a name="l01972"></a>01972         CHECK_GE(--search-&gt;sentinel_pushed_, 0);
<a name="l01973"></a>01973         search-&gt;set_search_depth(0);
<a name="l01974"></a>01974         search-&gt;set_search_left_depth(0);
<a name="l01975"></a>01975 
<a name="l01976"></a>01976         <span class="keywordflow">if</span> (info.int_info == magic_code) {
<a name="l01977"></a>01977           end_loop = <span class="keyword">true</span>;
<a name="l01978"></a>01978         }
<a name="l01979"></a>01979         <span class="keywordflow">break</span>;
<a name="l01980"></a>01980       }
<a name="l01981"></a>01981       <span class="keywordflow">case</span> <a class="code" href="namespaceoperations__research.html#5881ca2f6350f69f63b48b872c1c7e5e695cce0161b127055c52d41744e97395">SIMPLE_MARKER</a>:
<a name="l01982"></a>01982         <span class="keywordflow">break</span>;
<a name="l01983"></a>01983       <span class="keywordflow">case</span> <a class="code" href="namespaceoperations__research.html#5881ca2f6350f69f63b48b872c1c7e5e1d3aaf5d04e4a502a2db3fa71a1061b7">CHOICE_POINT</a>:
<a name="l01984"></a>01984         <span class="keywordflow">break</span>;
<a name="l01985"></a>01985       <span class="keywordflow">case</span> <a class="code" href="namespaceoperations__research.html#5881ca2f6350f69f63b48b872c1c7e5e7d02bd6f10e34551ac9b74d12ee3d746">REVERSIBLE_ACTION</a>: {
<a name="l01986"></a>01986         Demon* d = <span class="keyword">reinterpret_cast&lt;</span>Demon*<span class="keyword">&gt;</span>(info.ptr_info);
<a name="l01987"></a>01987         d-&gt;Run(<span class="keyword">this</span>);
<a name="l01988"></a>01988         <span class="keywordflow">break</span>;
<a name="l01989"></a>01989       }
<a name="l01990"></a>01990     }
<a name="l01991"></a>01991   }
<a name="l01992"></a>01992   fail_stamp_++;
<a name="l01993"></a>01993 }
<a name="l01994"></a>01994 
<a name="l01995"></a>01995 <span class="comment">// Closes the current search without backtrack.</span>
<a name="l01996"></a>01996 <span class="keywordtype">void</span> Solver::JumpToSentinelWhenNested() {
<a name="l01997"></a>01997   CHECK_GT(searches_.size(), 1) &lt;&lt; <span class="stringliteral">"calling JumpToSentinel from top level"</span>;
<a name="l01998"></a>01998   Search* c = searches_.back();
<a name="l01999"></a>01999   Search* p = searches_[searches_.size() - 2];
<a name="l02000"></a>02000   <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;
<a name="l02001"></a>02001   <span class="keywordflow">while</span> (!c-&gt;marker_stack_.empty()) {
<a name="l02002"></a>02002     StateMarker* m = c-&gt;marker_stack_.back();
<a name="l02003"></a>02003     <span class="keywordflow">if</span> (m-&gt;type_ == <a class="code" href="namespaceoperations__research.html#5881ca2f6350f69f63b48b872c1c7e5e7d02bd6f10e34551ac9b74d12ee3d746">REVERSIBLE_ACTION</a>) {
<a name="l02004"></a>02004       p-&gt;marker_stack_.push_back(m);
<a name="l02005"></a>02005     } <span class="keywordflow">else</span> {
<a name="l02006"></a>02006       <span class="keywordflow">if</span> (m-&gt;type_ == <a class="code" href="namespaceoperations__research.html#5881ca2f6350f69f63b48b872c1c7e5e9a277c2d196896995aaffb41aec2faea">SENTINEL</a>) {
<a name="l02007"></a>02007         CHECK_EQ(c-&gt;marker_stack_.size(), 1) &lt;&lt; <span class="stringliteral">"Sentinel found too early"</span>;
<a name="l02008"></a>02008         found = <span class="keyword">true</span>;
<a name="l02009"></a>02009       }
<a name="l02010"></a>02010       <span class="keyword">delete</span> m;
<a name="l02011"></a>02011     }
<a name="l02012"></a>02012     c-&gt;marker_stack_.pop_back();
<a name="l02013"></a>02013   }
<a name="l02014"></a>02014   c-&gt;set_search_depth(0);
<a name="l02015"></a>02015   c-&gt;set_search_left_depth(0);
<a name="l02016"></a>02016   CHECK_EQ(found, <span class="keyword">true</span>) &lt;&lt; <span class="stringliteral">"Sentinel not found"</span>;
<a name="l02017"></a>02017 }
<a name="l02018"></a>02018 
<a name="l02019"></a>02019 <span class="keyword">namespace </span>{
<a name="l02020"></a>02020 <span class="keyword">class </span>ReverseDecision : <span class="keyword">public</span> Decision {
<a name="l02021"></a>02021  <span class="keyword">public</span>:
<a name="l02022"></a>02022   <span class="keyword">explicit</span> ReverseDecision(Decision* <span class="keyword">const</span> d) : <a class="code" href="constraint__solver_8cc.html#1452e4944dcf272b8a473664908dc004">decision_</a>(d) {
<a name="l02023"></a>02023     CHECK(d != NULL);
<a name="l02024"></a>02024   }
<a name="l02025"></a>02025   <span class="keyword">virtual</span> ~ReverseDecision() {}
<a name="l02026"></a>02026 
<a name="l02027"></a>02027   <span class="keyword">virtual</span> <span class="keywordtype">void</span> Apply(<a class="code" href="classoperations__research_1_1Solver.html#5b0165d313b9e2bfba93da6aff65052f">Solver</a>* <span class="keyword">const</span> s) {
<a name="l02028"></a>02028     <a class="code" href="constraint__solver_8cc.html#1452e4944dcf272b8a473664908dc004">decision_</a>-&gt;Refute(s);
<a name="l02029"></a>02029   }
<a name="l02030"></a>02030 
<a name="l02031"></a>02031   <span class="keyword">virtual</span> <span class="keywordtype">void</span> Refute(<a class="code" href="classoperations__research_1_1Solver.html#5b0165d313b9e2bfba93da6aff65052f">Solver</a>* <span class="keyword">const</span> s) {
<a name="l02032"></a>02032     <a class="code" href="constraint__solver_8cc.html#1452e4944dcf272b8a473664908dc004">decision_</a>-&gt;Apply(s);
<a name="l02033"></a>02033   }
<a name="l02034"></a>02034 
<a name="l02035"></a>02035   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Solver.html#88de4c7ed8872eaece9bd09b1a7c882f" title="Accepts the given model visitor.">Accept</a>(DecisionVisitor* <span class="keyword">const</span> visitor)<span class="keyword"> const </span>{
<a name="l02036"></a>02036     <a class="code" href="constraint__solver_8cc.html#1452e4944dcf272b8a473664908dc004">decision_</a>-&gt;Accept(visitor);
<a name="l02037"></a>02037   }
<a name="l02038"></a>02038 
<a name="l02039"></a>02039   <span class="keyword">virtual</span> <span class="keywordtype">string</span> <a class="code" href="classoperations__research_1_1Solver.html#a7a09bf2f27ccbdc1d1d386bd94e142a" title="misc debug string.">DebugString</a>()<span class="keyword"> const </span>{
<a name="l02040"></a>02040     <span class="keywordtype">string</span> str = <span class="stringliteral">"Reverse("</span>;
<a name="l02041"></a>02041     str += <a class="code" href="constraint__solver_8cc.html#1452e4944dcf272b8a473664908dc004">decision_</a>-&gt;DebugString();
<a name="l02042"></a>02042     str += <span class="stringliteral">")"</span>;
<a name="l02043"></a>02043     <span class="keywordflow">return</span> str;
<a name="l02044"></a>02044   }
<a name="l02045"></a>02045 
<a name="l02046"></a>02046  <span class="keyword">private</span>:
<a name="l02047"></a>02047   Decision* <span class="keyword">const</span> <a class="code" href="constraint__solver_8cc.html#1452e4944dcf272b8a473664908dc004">decision_</a>;
<a name="l02048"></a>02048 };
<a name="l02049"></a>02049 }  <span class="comment">// namespace</span>
<a name="l02050"></a>02050 
<a name="l02051"></a>02051 <span class="comment">// Search for the next solution in the search tree.</span>
<a name="l02052"></a>02052 <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1Solver.html#11ed2a5d7bb8fb1a8967fee572ab9c47" title="namespace">Solver::NextSolution</a>() {
<a name="l02053"></a>02053   Search* <span class="keyword">const</span> search = searches_.back();
<a name="l02054"></a>02054   Decision* fd = NULL;
<a name="l02055"></a>02055   <span class="keyword">const</span> <span class="keywordtype">bool</span> top_level = (searches_.size() == 1);
<a name="l02056"></a><a class="code" href="constraint__solver_8cc.html#1452e4944dcf272b8a473664908dc004">02056</a> 
<a name="l02057"></a>02057   <span class="keywordflow">if</span> (top_level &amp;&amp; state_ == <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a95c05654b6a7479316478744b3ce4a50df" title="Before search, after search.">OUTSIDE_SEARCH</a> &amp;&amp; !search-&gt;decision_builder()) {
<a name="l02058"></a>02058     LOG(WARNING) &lt;&lt; <span class="stringliteral">"NextSolution() called without a NewSearch before"</span>;
<a name="l02059"></a>02059     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02060"></a>02060   }
<a name="l02061"></a><a class="code" href="classoperations__research_1_1Solver.html#11ed2a5d7bb8fb1a8967fee572ab9c47">02061</a> 
<a name="l02062"></a>02062   <span class="keywordflow">if</span> (top_level) {  <span class="comment">// Manage top level state.</span>
<a name="l02063"></a>02063     <span class="keywordflow">switch</span> (state_) {
<a name="l02064"></a>02064       <span class="keywordflow">case</span> <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a9530b34e2664f9b1e2fb0d1347d7a87674" title="After search, the model is infeasible.">PROBLEM_INFEASIBLE</a>:
<a name="l02065"></a>02065         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02066"></a>02066       <span class="keywordflow">case</span> <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a95401b0c79d1fa9261524343fce4dd5439" title="After failed NextSolution and before EndSearch.">NO_MORE_SOLUTIONS</a>:
<a name="l02067"></a>02067         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02068"></a>02068       <span class="keywordflow">case</span> <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a95d487136b6f055fa3fadfd6a3c12aa3a3" title="After successful NextSolution and before EndSearch.">AT_SOLUTION</a>: {
<a name="l02069"></a>02069         <span class="keywordflow">if</span> (BacktrackOneLevel(&amp;fd)) {  <span class="comment">// No more solutions.</span>
<a name="l02070"></a>02070           state_ = <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a95401b0c79d1fa9261524343fce4dd5439" title="After failed NextSolution and before EndSearch.">NO_MORE_SOLUTIONS</a>;
<a name="l02071"></a>02071           <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02072"></a>02072         }
<a name="l02073"></a>02073         state_ = <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a95066908e143fd988a03767f05e682acaf" title="Executing the search code.">IN_SEARCH</a>;
<a name="l02074"></a>02074         <span class="keywordflow">break</span>;
<a name="l02075"></a>02075       }
<a name="l02076"></a>02076       <span class="keywordflow">case</span> <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a95c05654b6a7479316478744b3ce4a50df" title="Before search, after search.">OUTSIDE_SEARCH</a>: {
<a name="l02077"></a>02077         state_ = <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a950e9b4a7467a4d4f1a7da211e6c59251e" title="Executing the root node.">IN_ROOT_NODE</a>;
<a name="l02078"></a>02078         search-&gt;BeginInitialPropagation();
<a name="l02079"></a>02079         <a class="code" href="constraint__solver_8cc.html#458c844702d69839c667500d86ae49c8" title="We cannot use a method/function for this as we would lose the context in the setjmp...">CP_TRY</a>(search) {
<a name="l02080"></a>02080           ProcessConstraints();
<a name="l02081"></a>02081           search-&gt;EndInitialPropagation();
<a name="l02082"></a>02082           PushSentinel(<a class="code" href="namespaceoperations__research.html#750b3027192fb2ccc71c4b318aa4f850">ROOT_NODE_SENTINEL</a>);
<a name="l02083"></a>02083           state_ = <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a95066908e143fd988a03767f05e682acaf" title="Executing the search code.">IN_SEARCH</a>;
<a name="l02084"></a>02084           search-&gt;ClearBuffer();
<a name="l02085"></a>02085         } <a class="code" href="constraint__solver_8cc.html#40910cf9a9eb89daac6c929006a03416">CP_ON_FAIL</a> {
<a name="l02086"></a>02086           queue_-&gt;AfterFailure();
<a name="l02087"></a>02087           BacktrackToSentinel(<a class="code" href="namespaceoperations__research.html#f1ab36801da5984b89300bc340ca2570">INITIAL_SEARCH_SENTINEL</a>);
<a name="l02088"></a>02088           state_ = <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a9530b34e2664f9b1e2fb0d1347d7a87674" title="After search, the model is infeasible.">PROBLEM_INFEASIBLE</a>;
<a name="l02089"></a>02089           <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02090"></a>02090         }
<a name="l02091"></a>02091         <span class="keywordflow">break</span>;
<a name="l02092"></a>02092       }
<a name="l02093"></a>02093       <span class="keywordflow">case</span> <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a95066908e143fd988a03767f05e682acaf" title="Executing the search code.">IN_SEARCH</a>:  <span class="comment">// Usually after a RestartSearch</span>
<a name="l02094"></a>02094         <span class="keywordflow">break</span>;
<a name="l02095"></a>02095       <span class="keywordflow">case</span> <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a950e9b4a7467a4d4f1a7da211e6c59251e" title="Executing the root node.">IN_ROOT_NODE</a>:
<a name="l02096"></a>02096         LOG(FATAL) &lt;&lt; <span class="stringliteral">"Should not happen"</span>;
<a name="l02097"></a>02097         <span class="keywordflow">break</span>;
<a name="l02098"></a>02098     }
<a name="l02099"></a>02099   }
<a name="l02100"></a>02100 
<a name="l02101"></a>02101   <span class="keyword">volatile</span> <span class="keywordtype">bool</span> finish = <span class="keyword">false</span>;
<a name="l02102"></a>02102   <span class="keyword">volatile</span> <span class="keywordtype">bool</span> result = <span class="keyword">false</span>;
<a name="l02103"></a>02103   <a class="code" href="classoperations__research_1_1DecisionBuilder.html" title="A DecisionBuilder is responsible for creating the search tree.">DecisionBuilder</a>* <span class="keyword">const</span> db = search-&gt;decision_builder();
<a name="l02104"></a>02104 
<a name="l02105"></a>02105   <span class="keywordflow">while</span> (!finish) {
<a name="l02106"></a>02106     <a class="code" href="constraint__solver_8cc.html#458c844702d69839c667500d86ae49c8" title="We cannot use a method/function for this as we would lose the context in the setjmp...">CP_TRY</a>(search) {
<a name="l02107"></a>02107       <span class="keywordflow">if</span> (fd != NULL) {
<a name="l02108"></a>02108         <a class="code" href="structoperations__research_1_1StateInfo.html" title="StateMarker / StateInfo struct.">StateInfo</a> i1(fd,
<a name="l02109"></a>02109                      1,
<a name="l02110"></a>02110                      search-&gt;search_depth(),
<a name="l02111"></a>02111                      search-&gt;left_search_depth());  <span class="comment">// 1 for right branch</span>
<a name="l02112"></a>02112         <a class="code" href="classoperations__research_1_1Solver.html#6d2ae179cd6e66dc4cfd14307126b2cb" title="The PushState and PopState methods manipulates the states of the reversible objects...">PushState</a>(<a class="code" href="namespaceoperations__research.html#5881ca2f6350f69f63b48b872c1c7e5e1d3aaf5d04e4a502a2db3fa71a1061b7">CHOICE_POINT</a>, i1);
<a name="l02113"></a>02113         search-&gt;RefuteDecision(fd);
<a name="l02114"></a>02114         branches_++;
<a name="l02115"></a>02115         fd-&gt;Refute(<span class="keyword">this</span>);
<a name="l02116"></a>02116         search-&gt;AfterDecision(fd, <span class="keyword">false</span>);
<a name="l02117"></a>02117         search-&gt;RightMove();
<a name="l02118"></a>02118         fd = NULL;
<a name="l02119"></a>02119       }
<a name="l02120"></a>02120       Decision* d = NULL;
<a name="l02121"></a>02121       <span class="keywordflow">for</span> (;;) {
<a name="l02122"></a>02122         search-&gt;BeginNextDecision(db);
<a name="l02123"></a>02123         d = db-&gt;<a class="code" href="classoperations__research_1_1DecisionBuilder.html#3bcaa4dd991e8ddb4d0e48cfbca58592" title="This is the main method of the decision builder class.">Next</a>(<span class="keyword">this</span>);
<a name="l02124"></a>02124         search-&gt;EndNextDecision(db, d);
<a name="l02125"></a>02125         <span class="keywordflow">if</span> (d == fail_decision_) {
<a name="l02126"></a>02126           <a class="code" href="classoperations__research_1_1Solver.html#45534161a4dda7e1997bc0effd606648" title="Abandon the current branch in the search tree. A backtrack will follow.">Fail</a>();  <span class="comment">// fail now instead of after 2 branches.</span>
<a name="l02127"></a>02127         }
<a name="l02128"></a>02128         <span class="keywordflow">if</span> (d != NULL) {
<a name="l02129"></a>02129           <a class="code" href="classoperations__research_1_1Solver.html#5f87c832967334179f0f9c8d05380847">DecisionModification</a> modification = search-&gt;ModifyDecision();
<a name="l02130"></a>02130           <span class="keywordflow">switch</span> (modification) {
<a name="l02131"></a>02131             <span class="keywordflow">case</span> <a class="code" href="classoperations__research_1_1Solver.html#5f87c832967334179f0f9c8d053808479bbb245ecd3725f5a67fd4c8466ee678">SWITCH_BRANCHES</a>: {
<a name="l02132"></a>02132               d = <a class="code" href="classoperations__research_1_1Solver.html#83ceb54f811483fd1c0444cddba8a600" title="The RevAlloc method stores the corresponding object in a stack.">RevAlloc</a>(<span class="keyword">new</span> ReverseDecision(d));
<a name="l02133"></a>02133             }  <span class="comment">// We reverse the decision and fall through the normal code.</span>
<a name="l02134"></a>02134             <span class="keywordflow">case</span> <a class="code" href="classoperations__research_1_1Solver.html#5f87c832967334179f0f9c8d05380847a8dfadb94521ac7979525ae94f618d57">NO_CHANGE</a>: {
<a name="l02135"></a>02135               decisions_++;
<a name="l02136"></a>02136               StateInfo i2(d,
<a name="l02137"></a>02137                            0,
<a name="l02138"></a>02138                            search-&gt;search_depth(),
<a name="l02139"></a>02139                            search-&gt;left_search_depth());  <span class="comment">// 0 for left branch</span>
<a name="l02140"></a>02140               <a class="code" href="classoperations__research_1_1Solver.html#6d2ae179cd6e66dc4cfd14307126b2cb" title="The PushState and PopState methods manipulates the states of the reversible objects...">PushState</a>(<a class="code" href="namespaceoperations__research.html#5881ca2f6350f69f63b48b872c1c7e5e1d3aaf5d04e4a502a2db3fa71a1061b7">CHOICE_POINT</a>, i2);
<a name="l02141"></a>02141               search-&gt;ApplyDecision(d);
<a name="l02142"></a>02142               branches_++;
<a name="l02143"></a>02143               d-&gt;Apply(<span class="keyword">this</span>);
<a name="l02144"></a>02144               search-&gt;AfterDecision(d, <span class="keyword">true</span>);
<a name="l02145"></a>02145               search-&gt;LeftMove();
<a name="l02146"></a>02146               <span class="keywordflow">break</span>;
<a name="l02147"></a>02147             }
<a name="l02148"></a>02148             <span class="keywordflow">case</span> <a class="code" href="classoperations__research_1_1Solver.html#5f87c832967334179f0f9c8d053808477a7d1379ff946fd786c118c3358ce438">KEEP_LEFT</a>: {
<a name="l02149"></a>02149               search-&gt;ApplyDecision(d);
<a name="l02150"></a>02150               d-&gt;Apply(<span class="keyword">this</span>);
<a name="l02151"></a>02151               search-&gt;AfterDecision(d, <span class="keyword">true</span>);
<a name="l02152"></a>02152               <span class="keywordflow">break</span>;
<a name="l02153"></a>02153             }
<a name="l02154"></a>02154             <span class="keywordflow">case</span> <a class="code" href="classoperations__research_1_1Solver.html#5f87c832967334179f0f9c8d053808471322e52b2ac49d3b2975acb1f4603cae">KEEP_RIGHT</a>: {
<a name="l02155"></a>02155               search-&gt;RefuteDecision(d);
<a name="l02156"></a>02156               d-&gt;Refute(<span class="keyword">this</span>);
<a name="l02157"></a>02157               search-&gt;AfterDecision(d, <span class="keyword">false</span>);
<a name="l02158"></a>02158               <span class="keywordflow">break</span>;
<a name="l02159"></a>02159             }
<a name="l02160"></a>02160             <span class="keywordflow">case</span> <a class="code" href="classoperations__research_1_1Solver.html#5f87c832967334179f0f9c8d05380847f16daaa1fec927c823d4d0441f4c742b">KILL_BOTH</a>: {
<a name="l02161"></a>02161               <a class="code" href="classoperations__research_1_1Solver.html#45534161a4dda7e1997bc0effd606648" title="Abandon the current branch in the search tree. A backtrack will follow.">Fail</a>();
<a name="l02162"></a>02162             }
<a name="l02163"></a>02163           }
<a name="l02164"></a>02164         } <span class="keywordflow">else</span> {
<a name="l02165"></a>02165           <span class="keywordflow">break</span>;
<a name="l02166"></a>02166         }
<a name="l02167"></a>02167       }
<a name="l02168"></a>02168       <span class="keywordflow">if</span> (search-&gt;AcceptSolution()) {
<a name="l02169"></a>02169         search-&gt;IncrementSolutionCounter();
<a name="l02170"></a>02170         <span class="keywordflow">if</span> (!search-&gt;AtSolution() || !<a class="code" href="classoperations__research_1_1Solver.html#6d31c124181afb65d1441712e5f392d2" title="Returns true wether the current search has been created using a Solve() call instead...">CurrentlyInSolve</a>()) {
<a name="l02171"></a>02171           result = <span class="keyword">true</span>;
<a name="l02172"></a>02172           finish = <span class="keyword">true</span>;
<a name="l02173"></a>02173         } <span class="keywordflow">else</span> {
<a name="l02174"></a>02174           <a class="code" href="classoperations__research_1_1Solver.html#45534161a4dda7e1997bc0effd606648" title="Abandon the current branch in the search tree. A backtrack will follow.">Fail</a>();
<a name="l02175"></a>02175         }
<a name="l02176"></a>02176       } <span class="keywordflow">else</span> {
<a name="l02177"></a>02177         <a class="code" href="classoperations__research_1_1Solver.html#45534161a4dda7e1997bc0effd606648" title="Abandon the current branch in the search tree. A backtrack will follow.">Fail</a>();
<a name="l02178"></a>02178       }
<a name="l02179"></a>02179     } <a class="code" href="constraint__solver_8cc.html#40910cf9a9eb89daac6c929006a03416">CP_ON_FAIL</a> {
<a name="l02180"></a>02180       queue_-&gt;AfterFailure();
<a name="l02181"></a>02181       <span class="keywordflow">if</span> (search-&gt;should_finish()) {
<a name="l02182"></a>02182         fd = NULL;
<a name="l02183"></a>02183         BacktrackToSentinel(top_level ?
<a name="l02184"></a>02184                             <a class="code" href="namespaceoperations__research.html#750b3027192fb2ccc71c4b318aa4f850">ROOT_NODE_SENTINEL</a> :
<a name="l02185"></a>02185                             <a class="code" href="namespaceoperations__research.html#f1ab36801da5984b89300bc340ca2570">INITIAL_SEARCH_SENTINEL</a>);
<a name="l02186"></a>02186         result = <span class="keyword">false</span>;
<a name="l02187"></a>02187         finish = <span class="keyword">true</span>;
<a name="l02188"></a>02188         search-&gt;set_should_finish(<span class="keyword">false</span>);
<a name="l02189"></a>02189         search-&gt;set_should_restart(<span class="keyword">false</span>);
<a name="l02190"></a>02190         <span class="comment">// We do not need to push back the sentinel as we are exiting anyway.</span>
<a name="l02191"></a>02191       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (search-&gt;should_restart()) {
<a name="l02192"></a>02192         fd = NULL;
<a name="l02193"></a>02193         BacktrackToSentinel(top_level ?
<a name="l02194"></a>02194                             <a class="code" href="namespaceoperations__research.html#750b3027192fb2ccc71c4b318aa4f850">ROOT_NODE_SENTINEL</a> :
<a name="l02195"></a>02195                             <a class="code" href="namespaceoperations__research.html#f1ab36801da5984b89300bc340ca2570">INITIAL_SEARCH_SENTINEL</a>);
<a name="l02196"></a>02196         search-&gt;set_should_finish(<span class="keyword">false</span>);
<a name="l02197"></a>02197         search-&gt;set_should_restart(<span class="keyword">false</span>);
<a name="l02198"></a>02198         PushSentinel(top_level ? <a class="code" href="namespaceoperations__research.html#750b3027192fb2ccc71c4b318aa4f850">ROOT_NODE_SENTINEL</a> : <a class="code" href="namespaceoperations__research.html#f1ab36801da5984b89300bc340ca2570">INITIAL_SEARCH_SENTINEL</a>);
<a name="l02199"></a>02199         search-&gt;RestartSearch();
<a name="l02200"></a>02200       } <span class="keywordflow">else</span> {
<a name="l02201"></a>02201         <span class="keywordflow">if</span> (BacktrackOneLevel(&amp;fd)) {  <span class="comment">// no more solutions.</span>
<a name="l02202"></a>02202           result = <span class="keyword">false</span>;
<a name="l02203"></a>02203           finish = <span class="keyword">true</span>;
<a name="l02204"></a>02204         }
<a name="l02205"></a>02205       }
<a name="l02206"></a>02206     }
<a name="l02207"></a>02207   }
<a name="l02208"></a>02208   <span class="keywordflow">if</span> (result) {
<a name="l02209"></a>02209     search-&gt;ClearBuffer();
<a name="l02210"></a>02210   }
<a name="l02211"></a>02211   <span class="keywordflow">if</span> (top_level) {  <span class="comment">// Manage state after NextSolution().</span>
<a name="l02212"></a>02212     state_ = (result ? <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a95d487136b6f055fa3fadfd6a3c12aa3a3" title="After successful NextSolution and before EndSearch.">AT_SOLUTION</a> : <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a95401b0c79d1fa9261524343fce4dd5439" title="After failed NextSolution and before EndSearch.">NO_MORE_SOLUTIONS</a>);
<a name="l02213"></a>02213   }
<a name="l02214"></a>02214   <span class="keywordflow">return</span> result;
<a name="l02215"></a>02215 }
<a name="l02216"></a>02216 
<a name="l02217"></a>02217 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Solver.html#b95c7f997dbe36deb51e7c0213bdf445">Solver::EndSearch</a>() {
<a name="l02218"></a>02218   CHECK_EQ(1, searches_.size());
<a name="l02219"></a>02219   Search* <span class="keyword">const</span> search = searches_.back();
<a name="l02220"></a>02220   BacktrackToSentinel(<a class="code" href="namespaceoperations__research.html#f1ab36801da5984b89300bc340ca2570">INITIAL_SEARCH_SENTINEL</a>);
<a name="l02221"></a>02221   search-&gt;ExitSearch();
<a name="l02222"></a>02222   search-&gt;Clear();
<a name="l02223"></a>02223   state_ = <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a95c05654b6a7479316478744b3ce4a50df" title="Before search, after search.">OUTSIDE_SEARCH</a>;
<a name="l02224"></a>02224   <span class="keywordflow">if</span> (!FLAGS_cp_profile_file.empty()) {
<a name="l02225"></a>02225     LOG(INFO) &lt;&lt; <span class="stringliteral">"Exporting profile to "</span> &lt;&lt; FLAGS_cp_profile_file;
<a name="l02226"></a><a class="code" href="classoperations__research_1_1Solver.html#b95c7f997dbe36deb51e7c0213bdf445">02226</a>     <a class="code" href="classoperations__research_1_1Solver.html#acb810c77f38bf40bd88aae49dc02598" title="Exports the profiling information in a human readable overview.">ExportProfilingOverview</a>(FLAGS_cp_profile_file);
<a name="l02227"></a>02227   }
<a name="l02228"></a>02228 }
<a name="l02229"></a>02229 
<a name="l02230"></a>02230 <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1Solver.html#09eee3e49a13e6bb086712d171b2aef8" title="This method returns the validity of the given assignment against the current model...">Solver::CheckAssignment</a>(Assignment* <span class="keyword">const</span> solution) {
<a name="l02231"></a>02231   CHECK(solution);
<a name="l02232"></a>02232   <span class="keywordflow">if</span> (state_ == <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a95066908e143fd988a03767f05e682acaf" title="Executing the search code.">IN_SEARCH</a> || state_ == <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a950e9b4a7467a4d4f1a7da211e6c59251e" title="Executing the root node.">IN_ROOT_NODE</a>) {
<a name="l02233"></a>02233     LOG(FATAL) &lt;&lt; <span class="stringliteral">"Use NestedSolve() inside search"</span>;
<a name="l02234"></a>02234   }
<a name="l02235"></a>02235   <span class="comment">// Check state and go to OUTSIDE_SEARCH.</span>
<a name="l02236"></a>02236   Search* <span class="keyword">const</span> search = searches_.back();
<a name="l02237"></a>02237   search-&gt;set_created_by_solve(<span class="keyword">false</span>);  <span class="comment">// default behavior.</span>
<a name="l02238"></a>02238 
<a name="l02239"></a><a class="code" href="classoperations__research_1_1Solver.html#09eee3e49a13e6bb086712d171b2aef8">02239</a>   BacktrackToSentinel(<a class="code" href="namespaceoperations__research.html#f1ab36801da5984b89300bc340ca2570">INITIAL_SEARCH_SENTINEL</a>);
<a name="l02240"></a>02240   state_ = <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a95c05654b6a7479316478744b3ce4a50df" title="Before search, after search.">OUTSIDE_SEARCH</a>;
<a name="l02241"></a>02241 
<a name="l02242"></a>02242   <span class="comment">// Push monitors and enter search.</span>
<a name="l02243"></a>02243   search-&gt;EnterSearch();
<a name="l02244"></a>02244 
<a name="l02245"></a>02245   <span class="comment">// Push sentinel and set decision builder.</span>
<a name="l02246"></a>02246   DCHECK_EQ(1, searches_.size());
<a name="l02247"></a>02247   PushSentinel(<a class="code" href="namespaceoperations__research.html#f1ab36801da5984b89300bc340ca2570">INITIAL_SEARCH_SENTINEL</a>);
<a name="l02248"></a>02248   search-&gt;BeginInitialPropagation();
<a name="l02249"></a>02249   <a class="code" href="constraint__solver_8cc.html#458c844702d69839c667500d86ae49c8" title="We cannot use a method/function for this as we would lose the context in the setjmp...">CP_TRY</a>(search) {
<a name="l02250"></a>02250     state_ = <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a950e9b4a7467a4d4f1a7da211e6c59251e" title="Executing the root node.">IN_ROOT_NODE</a>;
<a name="l02251"></a>02251     <a class="code" href="classoperations__research_1_1DecisionBuilder.html" title="A DecisionBuilder is responsible for creating the search tree.">DecisionBuilder</a> * <span class="keyword">const</span> restore = <a class="code" href="classoperations__research_1_1Solver.html#19dfeb751bdd2c5f2d1900c05a3c31a2" title="Returns a DecisionBuilder which restores an Assignment (calls void Assignment::Restore())...">MakeRestoreAssignment</a>(solution);
<a name="l02252"></a>02252     restore-&gt;<a class="code" href="classoperations__research_1_1DecisionBuilder.html#3bcaa4dd991e8ddb4d0e48cfbca58592" title="This is the main method of the decision builder class.">Next</a>(<span class="keyword">this</span>);
<a name="l02253"></a>02253     ProcessConstraints();
<a name="l02254"></a>02254     search-&gt;EndInitialPropagation();
<a name="l02255"></a>02255     BacktrackToSentinel(<a class="code" href="namespaceoperations__research.html#f1ab36801da5984b89300bc340ca2570">INITIAL_SEARCH_SENTINEL</a>);
<a name="l02256"></a>02256     search-&gt;ClearBuffer();
<a name="l02257"></a>02257     state_ = <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a95c05654b6a7479316478744b3ce4a50df" title="Before search, after search.">OUTSIDE_SEARCH</a>;
<a name="l02258"></a>02258     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l02259"></a>02259   } <a class="code" href="constraint__solver_8cc.html#40910cf9a9eb89daac6c929006a03416">CP_ON_FAIL</a> {
<a name="l02260"></a>02260     <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="pack_8cc.html#750b5d744c39a06bfb13e6eb010e35d0">index</a> = constraint_index_ &lt; constraints_list_.size() ?
<a name="l02261"></a>02261         constraint_index_ :
<a name="l02262"></a>02262         additional_constraints_parent_list_[additional_constraint_index_];
<a name="l02263"></a>02263     <a class="code" href="classoperations__research_1_1Constraint.html" title="A constraint is the main modeling object.">Constraint</a>* <span class="keyword">const</span> ct = constraints_list_[index];
<a name="l02264"></a>02264     <span class="keywordflow">if</span> (ct-&gt;<a class="code" href="classoperations__research_1_1PropagationBaseObject.html#89b827a71613c6c120d5ac326202df7e" title="Naming.">name</a>().empty()) {
<a name="l02265"></a>02265       LOG(INFO) &lt;&lt; <span class="stringliteral">"Failing constraint = "</span> &lt;&lt; ct-&gt;<a class="code" href="classoperations__research_1_1Constraint.html#f870afb5d6c1fba1d70b38eb581f8cca" title="Constraint class.">DebugString</a>();
<a name="l02266"></a>02266     } <span class="keywordflow">else</span> {
<a name="l02267"></a>02267       LOG(INFO) &lt;&lt; <span class="stringliteral">"Failing constraint = "</span> &lt;&lt; ct-&gt;<a class="code" href="classoperations__research_1_1PropagationBaseObject.html#89b827a71613c6c120d5ac326202df7e" title="Naming.">name</a>() &lt;&lt; <span class="stringliteral">":"</span>
<a name="l02268"></a>02268                 &lt;&lt; ct-&gt;<a class="code" href="classoperations__research_1_1Constraint.html#f870afb5d6c1fba1d70b38eb581f8cca" title="Constraint class.">DebugString</a>();
<a name="l02269"></a>02269     }
<a name="l02270"></a>02270     queue_-&gt;AfterFailure();
<a name="l02271"></a>02271     BacktrackToSentinel(<a class="code" href="namespaceoperations__research.html#f1ab36801da5984b89300bc340ca2570">INITIAL_SEARCH_SENTINEL</a>);
<a name="l02272"></a>02272     state_ = <a class="code" href="classoperations__research_1_1Solver.html#5b5712802e63dcd3ee5abfd37e0f2a9530b34e2664f9b1e2fb0d1347d7a87674" title="After search, the model is infeasible.">PROBLEM_INFEASIBLE</a>;
<a name="l02273"></a>02273     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02274"></a>02274   }
<a name="l02275"></a>02275 }
<a name="l02276"></a>02276 
<a name="l02277"></a>02277 <span class="keyword">namespace </span>{
<a name="l02278"></a>02278 <span class="keyword">class </span>AddConstraintDecisionBuilder : <span class="keyword">public</span> DecisionBuilder {
<a name="l02279"></a>02279  <span class="keyword">public</span>:
<a name="l02280"></a>02280   <span class="keyword">explicit</span> AddConstraintDecisionBuilder(<a class="code" href="classoperations__research_1_1Solver.html#697ed9eaa8955d595a023663ab1e8418">Constraint</a>* <span class="keyword">const</span> ct)
<a name="l02281"></a>02281       : <a class="code" href="constraint__solver_8cc.html#ebf1a2cc48de2bc261b73d521c1196c0">constraint_</a>(ct) {
<a name="l02282"></a>02282     CHECK_NOTNULL(ct);
<a name="l02283"></a>02283   }
<a name="l02284"></a>02284 
<a name="l02285"></a>02285   <span class="keyword">virtual</span> ~AddConstraintDecisionBuilder() {}
<a name="l02286"></a>02286 
<a name="l02287"></a>02287   <span class="keyword">virtual</span> Decision* Next(<a class="code" href="classoperations__research_1_1Solver.html#5b0165d313b9e2bfba93da6aff65052f">Solver</a>* <span class="keyword">const</span> solver) {
<a name="l02288"></a>02288     solver-&gt;AddConstraint(<a class="code" href="constraint__solver_8cc.html#ebf1a2cc48de2bc261b73d521c1196c0">constraint_</a>);
<a name="l02289"></a>02289     <span class="keywordflow">return</span> NULL;
<a name="l02290"></a>02290   }
<a name="l02291"></a>02291 
<a name="l02292"></a>02292   <span class="keyword">virtual</span> <span class="keywordtype">string</span> <a class="code" href="classoperations__research_1_1Solver.html#a7a09bf2f27ccbdc1d1d386bd94e142a" title="misc debug string.">DebugString</a>()<span class="keyword"> const </span>{
<a name="l02293"></a>02293     <span class="keywordflow">return</span> StringPrintf(<span class="stringliteral">"AddConstraintDecisionBuilder(%s)"</span>,
<a name="l02294"></a>02294                         <a class="code" href="constraint__solver_8cc.html#ebf1a2cc48de2bc261b73d521c1196c0">constraint_</a>-&gt;DebugString().c_str());
<a name="l02295"></a>02295   }
<a name="l02296"></a>02296  <span class="keyword">private</span>:
<a name="l02297"></a>02297   <a class="code" href="classoperations__research_1_1Solver.html#697ed9eaa8955d595a023663ab1e8418">Constraint</a>* <span class="keyword">const</span> <a class="code" href="constraint__solver_8cc.html#ebf1a2cc48de2bc261b73d521c1196c0">constraint_</a>;
<a name="l02298"></a>02298 };
<a name="l02299"></a>02299 }  <span class="comment">// namespace</span>
<a name="l02300"></a>02300 
<a name="l02301"></a>02301 DecisionBuilder* <a class="code" href="classoperations__research_1_1Solver.html#cdda06352e878920cf0b82c4bd033ae9" title="Returns a decision builder that will add the given constraint to the model.">Solver::MakeConstraintAdder</a>(<a class="code" href="classoperations__research_1_1Solver.html#697ed9eaa8955d595a023663ab1e8418">Constraint</a>* <span class="keyword">const</span> ct) {
<a name="l02302"></a>02302   <span class="keywordflow">return</span> <a class="code" href="classoperations__research_1_1Solver.html#83ceb54f811483fd1c0444cddba8a600" title="The RevAlloc method stores the corresponding object in a stack.">RevAlloc</a>(<span class="keyword">new</span> AddConstraintDecisionBuilder(ct));
<a name="l02303"></a>02303 }
<a name="l02304"></a>02304 
<a name="l02305"></a>02305 <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1Solver.html#4ca185d2cb8bccaa1a7571aac84bb8dd" title="Checks if adding this constraint will lead to an immediate failure.">Solver::CheckConstraint</a>(<a class="code" href="classoperations__research_1_1Solver.html#697ed9eaa8955d595a023663ab1e8418">Constraint</a>* <span class="keyword">const</span> ct) {
<a name="l02306"></a><a class="code" href="constraint__solver_8cc.html#ebf1a2cc48de2bc261b73d521c1196c0">02306</a>   <span class="keywordflow">return</span> <a class="code" href="classoperations__research_1_1Solver.html#3ce9d85b90e2416f59ee89b13579c725" title="search">Solve</a>(<a class="code" href="classoperations__research_1_1Solver.html#cdda06352e878920cf0b82c4bd033ae9" title="Returns a decision builder that will add the given constraint to the model.">MakeConstraintAdder</a>(ct));
<a name="l02307"></a>02307 }
<a name="l02308"></a>02308 
<a name="l02309"></a>02309 <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1Solver.html#b296b15e2d05e6f1f49618ed35d97d75" title="Nested solve using a decision builder and up to three search monitors, usually one...">Solver::NestedSolve</a>(DecisionBuilder* <span class="keyword">const</span> db,
<a name="l02310"></a><a class="code" href="classoperations__research_1_1Solver.html#cdda06352e878920cf0b82c4bd033ae9">02310</a>                          <span class="keywordtype">bool</span> restore,
<a name="l02311"></a>02311                          <span class="keyword">const</span> std::vector&lt;SearchMonitor*&gt;&amp; monitors) {
<a name="l02312"></a>02312   <span class="keywordflow">return</span> <a class="code" href="classoperations__research_1_1Solver.html#b296b15e2d05e6f1f49618ed35d97d75" title="Nested solve using a decision builder and up to three search monitors, usually one...">NestedSolve</a>(db, restore,  monitors.data(), monitors.size());
<a name="l02313"></a>02313 }
<a name="l02314"></a><a class="code" href="classoperations__research_1_1Solver.html#4ca185d2cb8bccaa1a7571aac84bb8dd">02314</a> 
<a name="l02315"></a>02315 <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1Solver.html#b296b15e2d05e6f1f49618ed35d97d75" title="Nested solve using a decision builder and up to three search monitors, usually one...">Solver::NestedSolve</a>(<a class="code" href="classoperations__research_1_1DecisionBuilder.html" title="A DecisionBuilder is responsible for creating the search tree.">DecisionBuilder</a>* <span class="keyword">const</span> db,
<a name="l02316"></a>02316                          <span class="keywordtype">bool</span> restore,
<a name="l02317"></a>02317                          <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <span class="keyword">const</span> m1) {
<a name="l02318"></a><a class="code" href="classoperations__research_1_1Solver.html#b296b15e2d05e6f1f49618ed35d97d75">02318</a>   std::vector&lt;SearchMonitor*&gt; monitors;
<a name="l02319"></a>02319   monitors.push_back(m1);
<a name="l02320"></a>02320   <span class="keywordflow">return</span> <a class="code" href="classoperations__research_1_1Solver.html#b296b15e2d05e6f1f49618ed35d97d75" title="Nested solve using a decision builder and up to three search monitors, usually one...">NestedSolve</a>(db, restore, monitors.data(), monitors.size());
<a name="l02321"></a>02321 }
<a name="l02322"></a>02322 
<a name="l02323"></a>02323 <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1Solver.html#b296b15e2d05e6f1f49618ed35d97d75" title="Nested solve using a decision builder and up to three search monitors, usually one...">Solver::NestedSolve</a>(<a class="code" href="classoperations__research_1_1DecisionBuilder.html" title="A DecisionBuilder is responsible for creating the search tree.">DecisionBuilder</a>* <span class="keyword">const</span> db, <span class="keywordtype">bool</span> restore) {
<a name="l02324"></a><a class="code" href="classoperations__research_1_1Solver.html#ffaa97e6662b96e402537a7f760cc653">02324</a>   <span class="keywordflow">return</span> <a class="code" href="classoperations__research_1_1Solver.html#b296b15e2d05e6f1f49618ed35d97d75" title="Nested solve using a decision builder and up to three search monitors, usually one...">NestedSolve</a>(db, restore, NULL, <a class="code" href="namespaceoperations__research.html#009f247167f32509baf749083e4bc984" title="Misc.">Zero</a>());
<a name="l02325"></a>02325 }
<a name="l02326"></a>02326 
<a name="l02327"></a>02327 <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1Solver.html#b296b15e2d05e6f1f49618ed35d97d75" title="Nested solve using a decision builder and up to three search monitors, usually one...">Solver::NestedSolve</a>(<a class="code" href="classoperations__research_1_1DecisionBuilder.html" title="A DecisionBuilder is responsible for creating the search tree.">DecisionBuilder</a>* <span class="keyword">const</span> db,
<a name="l02328"></a>02328                          <span class="keywordtype">bool</span> restore,
<a name="l02329"></a>02329                          <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <span class="keyword">const</span> m1,
<a name="l02330"></a>02330                          <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <span class="keyword">const</span> m2) {
<a name="l02331"></a>02331   std::vector&lt;SearchMonitor*&gt; monitors;
<a name="l02332"></a><a class="code" href="classoperations__research_1_1Solver.html#8d60480cba95558bab8440c6fc2f145c">02332</a>   monitors.push_back(m1);
<a name="l02333"></a>02333   monitors.push_back(m2);
<a name="l02334"></a>02334   <span class="keywordflow">return</span> <a class="code" href="classoperations__research_1_1Solver.html#b296b15e2d05e6f1f49618ed35d97d75" title="Nested solve using a decision builder and up to three search monitors, usually one...">NestedSolve</a>(db, restore, monitors.data(), monitors.size());
<a name="l02335"></a>02335 }
<a name="l02336"></a><a class="code" href="classoperations__research_1_1Solver.html#baadaabd895ab535528f7f66d3dd7a22">02336</a> 
<a name="l02337"></a>02337 <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1Solver.html#b296b15e2d05e6f1f49618ed35d97d75" title="Nested solve using a decision builder and up to three search monitors, usually one...">Solver::NestedSolve</a>(<a class="code" href="classoperations__research_1_1DecisionBuilder.html" title="A DecisionBuilder is responsible for creating the search tree.">DecisionBuilder</a>* <span class="keyword">const</span> db,
<a name="l02338"></a>02338                          <span class="keywordtype">bool</span> restore,
<a name="l02339"></a>02339                          <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <span class="keyword">const</span> m1,
<a name="l02340"></a>02340                          <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <span class="keyword">const</span> m2,
<a name="l02341"></a>02341                          <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <span class="keyword">const</span> m3) {
<a name="l02342"></a>02342   std::vector&lt;SearchMonitor*&gt; monitors;
<a name="l02343"></a>02343   monitors.push_back(m1);
<a name="l02344"></a>02344   monitors.push_back(m2);
<a name="l02345"></a>02345   monitors.push_back(m3);
<a name="l02346"></a><a class="code" href="classoperations__research_1_1Solver.html#7b887e3debc8aa94dd0a55572158d4f5">02346</a>   <span class="keywordflow">return</span> <a class="code" href="classoperations__research_1_1Solver.html#b296b15e2d05e6f1f49618ed35d97d75" title="Nested solve using a decision builder and up to three search monitors, usually one...">NestedSolve</a>(db, restore, monitors.data(), monitors.size());
<a name="l02347"></a>02347 }
<a name="l02348"></a>02348 
<a name="l02349"></a>02349 <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1Solver.html#b296b15e2d05e6f1f49618ed35d97d75" title="Nested solve using a decision builder and up to three search monitors, usually one...">Solver::NestedSolve</a>(<a class="code" href="classoperations__research_1_1DecisionBuilder.html" title="A DecisionBuilder is responsible for creating the search tree.">DecisionBuilder</a>* <span class="keyword">const</span> db,
<a name="l02350"></a>02350                          <span class="keywordtype">bool</span> restore,
<a name="l02351"></a>02351                          <a class="code" href="classoperations__research_1_1SearchMonitor.html" title="A search monitor is a simple set of callbacks to monitor all search events.">SearchMonitor</a>* <span class="keyword">const</span> * monitors,
<a name="l02352"></a>02352                          <span class="keywordtype">int</span> size) {
<a name="l02353"></a>02353   <a class="code" href="classoperations__research_1_1Search.html" title="Search class.">Search</a> new_search(<span class="keyword">this</span>);
<a name="l02354"></a>02354   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; size; ++i) {
<a name="l02355"></a>02355     new_search.<a class="code" href="classoperations__research_1_1Search.html#b75f27d7740f8a0d5428878f589c0b49">push_monitor</a>(monitors[i]);
<a name="l02356"></a>02356   }
<a name="l02357"></a>02357   std::vector&lt;SearchMonitor*&gt; extras;
<a name="l02358"></a><a class="code" href="classoperations__research_1_1Solver.html#55255b046523d366cacfb877bb673625">02358</a>   db-&gt;<a class="code" href="classoperations__research_1_1DecisionBuilder.html#61ba3c6d0da12541495cfea7e892ec99" title="This method will be called at the start of the search.">AppendMonitors</a>(<span class="keyword">this</span>, &amp;extras);
<a name="l02359"></a>02359   <span class="keywordflow">for</span> (ConstIter&lt;std::vector&lt;SearchMonitor*&gt; &gt; it(extras); !it.at_end(); ++it) {
<a name="l02360"></a>02360     new_search.<a class="code" href="classoperations__research_1_1Search.html#b75f27d7740f8a0d5428878f589c0b49">push_monitor</a>(*it);
<a name="l02361"></a>02361   }
<a name="l02362"></a>02362   searches_.push_back(&amp;new_search);
<a name="l02363"></a>02363   searches_.back()-&gt;set_created_by_solve(<span class="keyword">true</span>);  <span class="comment">// Overwrites default.</span>
<a name="l02364"></a>02364   new_search.<a class="code" href="classoperations__research_1_1Search.html#b3a81afa65291b9bdd3f3a168ce55aa4">EnterSearch</a>();
<a name="l02365"></a>02365   PushSentinel(<a class="code" href="namespaceoperations__research.html#f1ab36801da5984b89300bc340ca2570">INITIAL_SEARCH_SENTINEL</a>);
<a name="l02366"></a>02366   new_search.<a class="code" href="classoperations__research_1_1Search.html#4b37a519f7faebaeb4b6be5c62757c2b">set_decision_builder</a>(db);
<a name="l02367"></a>02367   <span class="keywordtype">bool</span> res = <a class="code" href="classoperations__research_1_1Solver.html#11ed2a5d7bb8fb1a8967fee572ab9c47" title="namespace">NextSolution</a>();
<a name="l02368"></a>02368   <span class="keywordflow">if</span> (res) {
<a name="l02369"></a>02369     <span class="keywordflow">if</span> (restore) {
<a name="l02370"></a>02370       BacktrackToSentinel(<a class="code" href="namespaceoperations__research.html#f1ab36801da5984b89300bc340ca2570">INITIAL_SEARCH_SENTINEL</a>);
<a name="l02371"></a>02371     } <span class="keywordflow">else</span> {
<a name="l02372"></a>02372       JumpToSentinelWhenNested();
<a name="l02373"></a>02373     }
<a name="l02374"></a>02374   }
<a name="l02375"></a>02375   new_search.<a class="code" href="classoperations__research_1_1Search.html#b6c851370a6efe0318b8d4b9c71a85ed">ExitSearch</a>();
<a name="l02376"></a>02376   new_search.<a class="code" href="classoperations__research_1_1Search.html#7768604c0fbc85bc05b12d8d0da745b0">Clear</a>();
<a name="l02377"></a>02377   searches_.pop_back();
<a name="l02378"></a>02378   <span class="keywordflow">return</span> res;
<a name="l02379"></a>02379 }
<a name="l02380"></a>02380 
<a name="l02381"></a>02381 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Solver.html#45534161a4dda7e1997bc0effd606648" title="Abandon the current branch in the search tree. A backtrack will follow.">Solver::Fail</a>() {
<a name="l02382"></a>02382   <span class="keywordflow">if</span> (fail_intercept_) {
<a name="l02383"></a>02383     fail_intercept_-&gt;Run();
<a name="l02384"></a>02384     <span class="keywordflow">return</span>;
<a name="l02385"></a>02385   }
<a name="l02386"></a>02386   <a class="code" href="constraint__solver_8cc.html#c13a1be8287ff935b4a93be3cc716e79">ConstraintSolverFailsHere</a>();
<a name="l02387"></a>02387   fails_++;
<a name="l02388"></a>02388   NotifyFailureToDemonMonitor();
<a name="l02389"></a>02389   searches_.back()-&gt;BeginFail();
<a name="l02390"></a><a class="code" href="classoperations__research_1_1Solver.html#45534161a4dda7e1997bc0effd606648">02390</a>   <span class="keywordflow">if</span> (FLAGS_cp_trace_demons || FLAGS_cp_verbose_fail) {
<a name="l02391"></a>02391     LOG(INFO) &lt;&lt; <span class="stringliteral">"### Failure ###"</span>;
<a name="l02392"></a>02392   }
<a name="l02393"></a>02393   searches_.back()-&gt;JumpBack();
<a name="l02394"></a>02394 }
<a name="l02395"></a>02395 
<a name="l02396"></a>02396 <span class="comment">// --- Propagation object names ---</span>
<a name="l02397"></a>02397 
<a name="l02398"></a>02398 <span class="keywordtype">string</span> Solver::GetName(<span class="keyword">const</span> <a class="code" href="classoperations__research_1_1Solver.html#cd6c49bd62ce1a1777a1c0e644f1186e">PropagationBaseObject</a>* <span class="keywordtype">object</span>)<span class="keyword"> const </span>{
<a name="l02399"></a>02399   <span class="keyword">const</span> <span class="keywordtype">string</span>* <a class="code" href="default__search_8cc.html#1848ae81740c68c2502b2f176cfadcef" title="A name for logging purposes.">name</a> = FindOrNull(propagation_object_names_, <span class="keywordtype">object</span>);
<a name="l02400"></a>02400   <span class="keywordflow">if</span> (name != NULL) {
<a name="l02401"></a>02401     <span class="keywordflow">return</span> *name;
<a name="l02402"></a>02402   }
<a name="l02403"></a>02403   <span class="keyword">const</span> std::pair&lt;string, const PropagationBaseObject*&gt;* delegate_object =
<a name="l02404"></a>02404       FindOrNull(delegate_objects_, <span class="keywordtype">object</span>);
<a name="l02405"></a>02405   <span class="keywordflow">if</span> (delegate_object != NULL) {
<a name="l02406"></a>02406     <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; prefix = delegate_object-&gt;first;
<a name="l02407"></a>02407     <span class="keyword">const</span> <a class="code" href="classoperations__research_1_1Solver.html#cd6c49bd62ce1a1777a1c0e644f1186e">PropagationBaseObject</a>* delegate = delegate_object-&gt;second;
<a name="l02408"></a>02408     <span class="keywordflow">return</span> prefix + <span class="stringliteral">"&lt;"</span> + delegate-&gt;name() + <span class="stringliteral">"&gt;"</span>;
<a name="l02409"></a>02409   }
<a name="l02410"></a>02410   <span class="keywordflow">return</span> empty_name_;
<a name="l02411"></a>02411 }
<a name="l02412"></a>02412 
<a name="l02413"></a>02413 <span class="keywordtype">void</span> Solver::SetName(<span class="keyword">const</span> <a class="code" href="classoperations__research_1_1Solver.html#cd6c49bd62ce1a1777a1c0e644f1186e">PropagationBaseObject</a>* <span class="keywordtype">object</span>, <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; name) {
<a name="l02414"></a>02414   <span class="keywordflow">if</span> (parameters_.store_names
<a name="l02415"></a>02415       &amp;&amp; GetName(<span class="keywordtype">object</span>).compare(name) != 0) {  <span class="comment">// in particular if name.empty()</span>
<a name="l02416"></a>02416     propagation_object_names_[object] = name;
<a name="l02417"></a>02417   }
<a name="l02418"></a>02418 }
<a name="l02419"></a>02419 
<a name="l02420"></a>02420 <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1Solver.html#0066847d31e9271e0cbb445781f5d409" title="Returns wether the object has been named or not.">Solver::HasName</a>(<span class="keyword">const</span> <a class="code" href="classoperations__research_1_1Solver.html#cd6c49bd62ce1a1777a1c0e644f1186e">PropagationBaseObject</a>* <span class="keyword">const</span> <span class="keywordtype">object</span>)<span class="keyword"> const </span>{
<a name="l02421"></a>02421   <span class="keywordflow">return</span> ContainsKey(propagation_object_names_, <span class="keywordtype">object</span>);
<a name="l02422"></a>02422 }
<a name="l02423"></a>02423 
<a name="l02424"></a>02424 <span class="comment">// ------------------ Useful Operators ------------------</span>
<a name="l02425"></a>02425 
<a name="l02426"></a>02426 std::ostream&amp; <a class="code" href="namespaceoperations__research.html#82d722796fae06c7fb9d1d8a37c91c99" title="NOLINT.">operator &lt;&lt; </a>(std::ostream&amp; out, <span class="keyword">const</span> <a class="code" href="classoperations__research_1_1Solver.html#5b0165d313b9e2bfba93da6aff65052f">Solver</a>* <span class="keyword">const</span> s) {  <span class="comment">// NOLINT</span>
<a name="l02427"></a>02427   out &lt;&lt; s-&gt;DebugString();
<a name="l02428"></a>02428   <span class="keywordflow">return</span> out;
<a name="l02429"></a><a class="code" href="classoperations__research_1_1Solver.html#0066847d31e9271e0cbb445781f5d409">02429</a> }
<a name="l02430"></a>02430 
<a name="l02431"></a>02431 std::ostream&amp; <a class="code" href="namespaceoperations__research.html#82d722796fae06c7fb9d1d8a37c91c99" title="NOLINT.">operator &lt;&lt;</a>(std::ostream&amp; out, <span class="keyword">const</span> <a class="code" href="classoperations__research_1_1BaseObject.html" title="Useful Search and Modeling Objects.">BaseObject</a>* o) {  <span class="comment">// NOLINT</span>
<a name="l02432"></a>02432   out &lt;&lt; o-&gt;<a class="code" href="classoperations__research_1_1BaseObject.html#f3317b4111dc4a7b6939cb9c52592e93">DebugString</a>();
<a name="l02433"></a>02433   <span class="keywordflow">return</span> out;
<a name="l02434"></a>02434 }
<a name="l02435"></a><a class="code" href="namespaceoperations__research.html#87fdc0126f6fc98ffb86ba1aa618f322">02435</a> 
<a name="l02436"></a>02436 <span class="comment">// ---------- PropagationBaseObject ---------</span>
<a name="l02437"></a>02437 
<a name="l02438"></a>02438 <span class="keywordtype">string</span> <a class="code" href="default__search_8cc.html#1848ae81740c68c2502b2f176cfadcef" title="A name for logging purposes.">PropagationBaseObject::name</a>()<span class="keyword"> const </span>{
<a name="l02439"></a>02439   <span class="comment">// TODO(user) : merge with GetName() code to remove a string copy.</span>
<a name="l02440"></a><a class="code" href="namespaceoperations__research.html#b563b868509e5ca6c0db57a038d863e4">02440</a>   <span class="keywordflow">return</span> <a class="code" href="dependency__graph_8cc.html#bd6bfbf6753a5deb0ce273fad6408e1e">solver_</a>-&gt;<a class="code" href="classoperations__research_1_1Solver.html#afacbc4ce7d1cfc4883782b9fbcb9c3b" title="Naming.">GetName</a>(<span class="keyword">this</span>);
<a name="l02441"></a>02441 }
<a name="l02442"></a>02442 
<a name="l02443"></a>02443 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1PropagationBaseObject.html#8b98dbf206a52e5f327b3640f71193da">PropagationBaseObject::set_name</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; name) {
<a name="l02444"></a>02444   <a class="code" href="dependency__graph_8cc.html#bd6bfbf6753a5deb0ce273fad6408e1e">solver_</a>-&gt;<a class="code" href="classoperations__research_1_1Solver.html#5ae7fc1d889cf010c17b9a05ebff5004">SetName</a>(<span class="keyword">this</span>, name);
<a name="l02445"></a>02445 }
<a name="l02446"></a>02446 
<a name="l02447"></a><a class="code" href="classoperations__research_1_1PropagationBaseObject.html#89b827a71613c6c120d5ac326202df7e">02447</a> <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1PropagationBaseObject.html#0f2327dbde296e49312e18cce89606c7" title="Returns wether the object has been named or not.">PropagationBaseObject::HasName</a>()<span class="keyword"> const </span>{
<a name="l02448"></a>02448   <span class="keywordflow">return</span> solver_-&gt;<a class="code" href="classoperations__research_1_1Solver.html#0066847d31e9271e0cbb445781f5d409" title="Returns wether the object has been named or not.">HasName</a>(<span class="keyword">this</span>);
<a name="l02449"></a>02449 }
<a name="l02450"></a>02450 
<a name="l02451"></a>02451 <span class="comment">// ---------- Decision Builder ----------</span>
<a name="l02452"></a><a class="code" href="classoperations__research_1_1PropagationBaseObject.html#8b98dbf206a52e5f327b3640f71193da">02452</a> 
<a name="l02453"></a>02453 <span class="keywordtype">string</span> <a class="code" href="classoperations__research_1_1DecisionBuilder.html#b40ddf22d94afceffdf966b2e4a5e60d" title="Decision Builder.">DecisionBuilder::DebugString</a>()<span class="keyword"> const </span>{
<a name="l02454"></a>02454   <span class="keywordflow">return</span> <span class="stringliteral">"DecisionBuilder"</span>;
<a name="l02455"></a>02455 }
<a name="l02456"></a><a class="code" href="classoperations__research_1_1PropagationBaseObject.html#0f2327dbde296e49312e18cce89606c7">02456</a> 
<a name="l02457"></a>02457 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1DecisionBuilder.html#61ba3c6d0da12541495cfea7e892ec99" title="This method will be called at the start of the search.">DecisionBuilder::AppendMonitors</a>(<a class="code" href="classoperations__research_1_1Solver.html" title="Solver Class.">Solver</a>* <span class="keyword">const</span> solver,
<a name="l02458"></a>02458                                      std::vector&lt;SearchMonitor*&gt;* <span class="keyword">const</span> extras) {}
<a name="l02459"></a>02459 
<a name="l02460"></a>02460 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1DecisionBuilder.html#e7ca51f2177acc62d1a863694278ba20">DecisionBuilder::Accept</a>(<a class="code" href="classoperations__research_1_1ModelVisitor.html" title="Model visitor.">ModelVisitor</a>* <span class="keyword">const</span> visitor)<span class="keyword"> const </span>{}
<a name="l02461"></a>02461 
<a name="l02462"></a><a class="code" href="classoperations__research_1_1DecisionBuilder.html#b40ddf22d94afceffdf966b2e4a5e60d">02462</a> <span class="comment">// ---------- Decision and DecisionVisitor ----------</span>
<a name="l02463"></a>02463 
<a name="l02464"></a>02464 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Decision.html#33b0dbb456da08b13b087b39bf689a0a" title="Accepts the given visitor.">Decision::Accept</a>(<a class="code" href="classoperations__research_1_1DecisionVisitor.html" title="A DecisionVisitor is used to inspect a decision.">DecisionVisitor</a>* <span class="keyword">const</span> visitor)<span class="keyword"> const </span>{
<a name="l02465"></a>02465   visitor-&gt;<a class="code" href="classoperations__research_1_1DecisionVisitor.html#baff8996ecb74099352b015f418a2fbe">VisitUnknownDecision</a>();
<a name="l02466"></a><a class="code" href="classoperations__research_1_1DecisionBuilder.html#61ba3c6d0da12541495cfea7e892ec99">02466</a> }
<a name="l02467"></a>02467 
<a name="l02468"></a>02468 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1DecisionVisitor.html#e221fd58e12c43591bc2fbb6316246af">DecisionVisitor::VisitSetVariableValue</a>(<a class="code" href="classoperations__research_1_1IntVar.html" title="The class IntVar is a subset of IntExpr.">IntVar</a>* <span class="keyword">const</span> var, int64 <a class="code" href="search_8cc.html#21edc7ca4cc5802c8779d68556bc09cf">value</a>) {}
<a name="l02469"></a><a class="code" href="classoperations__research_1_1DecisionBuilder.html#e7ca51f2177acc62d1a863694278ba20">02469</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1DecisionVisitor.html#b33faf731850ebfc3574b741e072dae0">DecisionVisitor::VisitSplitVariableDomain</a>(<a class="code" href="classoperations__research_1_1IntVar.html" title="The class IntVar is a subset of IntExpr.">IntVar</a>* <span class="keyword">const</span> var,
<a name="l02470"></a>02470                                                int64 <a class="code" href="search_8cc.html#21edc7ca4cc5802c8779d68556bc09cf">value</a>,
<a name="l02471"></a>02471                                                <span class="keywordtype">bool</span> lower) {}
<a name="l02472"></a>02472 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1DecisionVisitor.html#baff8996ecb74099352b015f418a2fbe">DecisionVisitor::VisitUnknownDecision</a>() {}
<a name="l02473"></a><a class="code" href="classoperations__research_1_1Decision.html#33b0dbb456da08b13b087b39bf689a0a">02473</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1DecisionVisitor.html#852961fc968273745ab1cd207864089a">DecisionVisitor::VisitScheduleOrPostpone</a>(<a class="code" href="classoperations__research_1_1IntervalVar.html" title="Interval Var.">IntervalVar</a>* <span class="keyword">const</span> var,
<a name="l02474"></a>02474                                               int64 est) {}
<a name="l02475"></a>02475 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1DecisionVisitor.html#14f92ff529a685a68b0f60779140fba4">DecisionVisitor::VisitTryRankFirst</a>(<a class="code" href="classoperations__research_1_1SequenceVar.html" title="SequenceVar.">SequenceVar</a>* <span class="keyword">const</span> sequence,
<a name="l02476"></a>02476                                         <span class="keywordtype">int</span> index) {}
<a name="l02477"></a><a class="code" href="classoperations__research_1_1DecisionVisitor.html#e221fd58e12c43591bc2fbb6316246af">02477</a> 
<a name="l02478"></a><a class="code" href="classoperations__research_1_1DecisionVisitor.html#b33faf731850ebfc3574b741e072dae0">02478</a> <span class="comment">// ---------- ModelVisitor ----------</span>
<a name="l02479"></a>02479 
<a name="l02480"></a>02480 <span class="comment">// Tags for constraints, arguments, extensions.</span>
<a name="l02481"></a><a class="code" href="classoperations__research_1_1DecisionVisitor.html#baff8996ecb74099352b015f418a2fbe">02481</a> 
<a name="l02482"></a><a class="code" href="classoperations__research_1_1DecisionVisitor.html#852961fc968273745ab1cd207864089a">02482</a> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#f237b4297d5a32fad634e70e0f35881e" title="Constraint and Expression types.">ModelVisitor::kAbs</a>[] = <span class="stringliteral">"Abs"</span>;
<a name="l02483"></a>02483 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#9d53b5ab302c38ad2b48781ef7c09714">ModelVisitor::kAllDifferent</a>[] = <span class="stringliteral">"AllDifferent"</span>;
<a name="l02484"></a><a class="code" href="classoperations__research_1_1DecisionVisitor.html#14f92ff529a685a68b0f60779140fba4">02484</a> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#f6e81e895ddd806684b6481e17830e57">ModelVisitor::kAllowedAssignments</a>[] = <span class="stringliteral">"AllowedAssignments"</span>;
<a name="l02485"></a>02485 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#f4f2f6bf053fb598e924ef6c8395c9d6">ModelVisitor::kBetween</a>[] = <span class="stringliteral">"Between"</span>;
<a name="l02486"></a>02486 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#04149f75f6acc506c609260f80b9d6db">ModelVisitor::kConvexPiecewise</a>[] = <span class="stringliteral">"ConvexPiecewise"</span>;
<a name="l02487"></a>02487 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#c8cd1e9c2a4e7f6b0439612681e23fb9">ModelVisitor::kCountEqual</a>[] = <span class="stringliteral">"CountEqual"</span>;
<a name="l02488"></a>02488 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#901b5725b984b498fb302cf86592418e">ModelVisitor::kCumulative</a>[] = <span class="stringliteral">"Cumulative"</span>;
<a name="l02489"></a>02489 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#2075ef405e2f03aabc0420352e714c10">ModelVisitor::kDeviation</a>[] = <span class="stringliteral">"Deviation"</span>;
<a name="l02490"></a>02490 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#4f8fa646f05f32445266b6b495c05de4">ModelVisitor::kDifference</a>[] = <span class="stringliteral">"Difference"</span>;
<a name="l02491"></a>02491 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#c69c0d4cf1ead77c36da8acf18194676">ModelVisitor::kDisjunctive</a>[] = <span class="stringliteral">"Disjunctive"</span>;
<a name="l02492"></a>02492 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#49245843ccae49bc4676975060163f88">ModelVisitor::kDistribute</a>[] = <span class="stringliteral">"Distribute"</span>;
<a name="l02493"></a>02493 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#f53b38d07e9a888fa528a2e6cb8537cf">ModelVisitor::kDivide</a>[] = <span class="stringliteral">"Divide"</span>;
<a name="l02494"></a>02494 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#99e162d169d5fc96e8fd71a5efa04409">ModelVisitor::kDurationExpr</a>[] = <span class="stringliteral">"DurationExpression"</span>;
<a name="l02495"></a>02495 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#3ef4a8a187561b5182f7578ea2dfd210">ModelVisitor::kElement</a>[] = <span class="stringliteral">"Element"</span>;
<a name="l02496"></a>02496 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#ae8e23d29479cc50508f7edccefb3537">ModelVisitor::kElementEqual</a>[] = <span class="stringliteral">"ElementEqual"</span>;
<a name="l02497"></a>02497 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#7d8a4a7185089e79385835fa75d8de5a">ModelVisitor::kEndExpr</a>[] = <span class="stringliteral">"EndExpression"</span>;
<a name="l02498"></a>02498 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#cc630d2155a877f5dd7230c511b1349b">ModelVisitor::kEquality</a>[] = <span class="stringliteral">"Equal"</span>;
<a name="l02499"></a>02499 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#34a2dcbfe5b8659d6c243ff7d5e52e0a">ModelVisitor::kFalseConstraint</a>[] = <span class="stringliteral">"FalseConstraint"</span>;
<a name="l02500"></a>02500 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#c9deb5675c83c9622c16d5ea83348dae">ModelVisitor::kGreater</a>[] = <span class="stringliteral">"Greater"</span>;
<a name="l02501"></a>02501 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#0f8ad9f298e615c31b81f617d5c56238">ModelVisitor::kGreaterOrEqual</a>[] = <span class="stringliteral">"GreaterOrEqual"</span>;
<a name="l02502"></a>02502 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#2925569323bc7a01152e05d02c4bce09">ModelVisitor::kIntegerVariable</a>[] = <span class="stringliteral">"IntegerVariable"</span>;
<a name="l02503"></a>02503 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#259012e2900d5fb84e7ff92f0d44cf37">ModelVisitor::kIntervalBinaryRelation</a>[] = <span class="stringliteral">"IntervalBinaryRelation"</span>;
<a name="l02504"></a>02504 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#68258c9c17b19ca4ded994013ca75e01">ModelVisitor::kIntervalDisjunction</a>[] = <span class="stringliteral">"IntervalDisjunction"</span>;
<a name="l02505"></a>02505 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#71f43f95983162ce498dade8e06f5e1c">ModelVisitor::kIntervalUnaryRelation</a>[] = <span class="stringliteral">"IntervalUnaryRelation"</span>;
<a name="l02506"></a>02506 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#3afc77916ce1c8573c520dd029d62ee4">ModelVisitor::kIntervalVariable</a>[] = <span class="stringliteral">"IntervalVariable"</span>;
<a name="l02507"></a>02507 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#b2ab7dfbe08c84a2d1314d38c0482a37">ModelVisitor::kIsBetween</a>[] = <span class="stringliteral">"IsBetween;"</span>;
<a name="l02508"></a>02508 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#6d31cbb260939681010e0941313a4e0e">ModelVisitor::kIsDifferent</a>[] = <span class="stringliteral">"IsDifferent"</span>;
<a name="l02509"></a>02509 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#8feccfbc16c375ee83a94a4d8edad55c">ModelVisitor::kIsEqual</a>[] = <span class="stringliteral">"IsEqual"</span>;
<a name="l02510"></a>02510 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#883f273197f38719d051bf343bcf3782">ModelVisitor::kIsGreaterOrEqual</a>[] = <span class="stringliteral">"IsGreaterOrEqual"</span>;
<a name="l02511"></a>02511 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#fc7c4b24ee14135df5abd72ffdb674a2">ModelVisitor::kIsLessOrEqual</a>[] = <span class="stringliteral">"IsLessOrEqual"</span>;
<a name="l02512"></a>02512 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#3026ed97c97b223ac9655f44ef17c211">ModelVisitor::kIsMember</a>[] = <span class="stringliteral">"IsMember;"</span>;
<a name="l02513"></a>02513 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#ff3d0b871ad4b2bce8e1cc3c5544e0e6">ModelVisitor::kLess</a>[] = <span class="stringliteral">"Less"</span>;
<a name="l02514"></a>02514 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#7f423157942a9e13483cb47ea7eb0596">ModelVisitor::kLessOrEqual</a>[] = <span class="stringliteral">"LessOrEqual"</span>;
<a name="l02515"></a>02515 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#b7dfac8a95e08194a4c1f22bce571e2f">ModelVisitor::kLinkExprVar</a>[] = <span class="stringliteral">"CastExpressionIntoVariable"</span>;
<a name="l02516"></a>02516 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#662783708ea2228742e5376c1e0dcb13">ModelVisitor::kMapDomain</a>[] = <span class="stringliteral">"MapDomain"</span>;
<a name="l02517"></a>02517 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#4828f6c7561c772d860f5cef93eaa00d">ModelVisitor::kMax</a>[] = <span class="stringliteral">"Max"</span>;
<a name="l02518"></a>02518 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#81beb95062a8c9cea38ad1c30b2703ad">ModelVisitor::kMaxEqual</a>[] = <span class="stringliteral">"MaxEqual"</span>;
<a name="l02519"></a>02519 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#6f06624dec0cef88e369f20cc7626cc7">ModelVisitor::kMember</a>[] = <span class="stringliteral">"Member"</span>;
<a name="l02520"></a>02520 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#11527e1008e9035c77635f1b0bac9649">ModelVisitor::kMin</a>[] = <span class="stringliteral">"Min"</span>;
<a name="l02521"></a>02521 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#440e4514d9020272d4add11b95f2d419">ModelVisitor::kMinEqual</a>[] = <span class="stringliteral">"MinEqual"</span>;
<a name="l02522"></a>02522 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#3b69ad067003985cbb5d27426019c48f">ModelVisitor::kNoCycle</a>[] = <span class="stringliteral">"NoCycle"</span>;
<a name="l02523"></a>02523 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#c89808f8ad29c7685cee359604f81f1c">ModelVisitor::kNonEqual</a>[] = <span class="stringliteral">"NonEqual"</span>;
<a name="l02524"></a>02524 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#499497ff0c618be51b930ee2861b0282">ModelVisitor::kOpposite</a>[] = <span class="stringliteral">"Opposite"</span>;
<a name="l02525"></a>02525 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#a36752b1daacb1d0256429cd7f88fdca">ModelVisitor::kPack</a>[] = <span class="stringliteral">"Pack"</span>;
<a name="l02526"></a>02526 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#a520552506118ffdda400fc33759e080">ModelVisitor::kPathCumul</a>[] = <span class="stringliteral">"PathCumul"</span>;
<a name="l02527"></a>02527 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#75d76394543768bc3e195cfb9541f26e">ModelVisitor::kPerformedExpr</a>[] = <span class="stringliteral">"PerformedExpression"</span>;
<a name="l02528"></a>02528 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#53106d7bfbc4d68f3a15b268464866c2">ModelVisitor::kProduct</a>[] = <span class="stringliteral">"Product"</span>;
<a name="l02529"></a>02529 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#a583902252e49cdbbe0da8208d738a3a">ModelVisitor::kScalProd</a>[] = <span class="stringliteral">"ScalarProduct"</span>;
<a name="l02530"></a>02530 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#955991ba66a3ed3f48fee5c08c2cc107">ModelVisitor::kScalProdEqual</a>[] = <span class="stringliteral">"ScalarProductEqual"</span>;
<a name="l02531"></a>02531 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#0a4e79e6b1c43f85541caca7d384311d">ModelVisitor::kScalProdGreaterOrEqual</a>[] =
<a name="l02532"></a>02532     <span class="stringliteral">"ScalarProductGreaterOrEqual"</span>;
<a name="l02533"></a>02533 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#87b6ec3e7fa83b67e26ecdf89aa047d5">ModelVisitor::kScalProdLessOrEqual</a>[] = <span class="stringliteral">"ScalarProductLessOrEqual"</span>;
<a name="l02534"></a>02534 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#be5a471c67142fbb3a2337c23b2fce1a">ModelVisitor::kSemiContinuous</a>[] = <span class="stringliteral">"SemiContinuous"</span>;
<a name="l02535"></a>02535 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#3fdbfba4f5a46688763629983082bff7">ModelVisitor::kSequenceVariable</a>[] = <span class="stringliteral">"SequenceVariable"</span>;
<a name="l02536"></a>02536 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#b030b9586356bd410d3e944f2be7b3f7">ModelVisitor::kSquare</a>[] = <span class="stringliteral">"Square"</span>;
<a name="l02537"></a>02537 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#17fdff9cce2e850e6e24d1514447b5e7">ModelVisitor::kStartExpr</a>[]= <span class="stringliteral">"StartExpression"</span>;
<a name="l02538"></a>02538 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#82fa72cdeffb288a216a74107d13e279">ModelVisitor::kSum</a>[] = <span class="stringliteral">"Sum"</span>;
<a name="l02539"></a>02539 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#bba42d1775fe8a5d7e18dc034980377b">ModelVisitor::kSumEqual</a>[] = <span class="stringliteral">"SumEqual"</span>;
<a name="l02540"></a>02540 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#714cf066f84e3a56c0a8b261cb5b7ca6">ModelVisitor::kSumGreaterOrEqual</a>[] = <span class="stringliteral">"SumGreaterOrEqual"</span>;
<a name="l02541"></a>02541 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#8ac8fd8ddbe46a941a1689296baad984">ModelVisitor::kSumLessOrEqual</a>[] = <span class="stringliteral">"SumLessOrEqual"</span>;
<a name="l02542"></a>02542 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#4b2d45046ac9428afa60b34c760348b1">ModelVisitor::kTransition</a>[]= <span class="stringliteral">"Transition"</span>;
<a name="l02543"></a>02543 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#dd5629d92a6eab9043d3d96b25278d80">ModelVisitor::kTrueConstraint</a>[] = <span class="stringliteral">"TrueConstraint"</span>;
<a name="l02544"></a>02544 
<a name="l02545"></a>02545 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#d0d68c9da1a9674a1c60b8236e6aa8f4" title="Extension names:.">ModelVisitor::kCountAssignedItemsExtension</a>[] = <span class="stringliteral">"CountAssignedItems"</span>;
<a name="l02546"></a>02546 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#d1fed75e372d8f8a7c411e322b2128e0">ModelVisitor::kCountUsedBinsExtension</a>[] = <span class="stringliteral">"CountUsedBins"</span>;
<a name="l02547"></a>02547 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#e4e71fbb68d896433470427eb34bba49">ModelVisitor::kInt64ToBoolExtension</a>[] = <span class="stringliteral">"Int64ToBoolFunction"</span>;
<a name="l02548"></a>02548 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#46015e0c5630a4aea9c68c91efbe7e87">ModelVisitor::kInt64ToInt64Extension</a>[] = <span class="stringliteral">"Int64ToInt64Function"</span>;
<a name="l02549"></a>02549 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#4cc5527e9cd79248c6c340a6a3219ad8">ModelVisitor::kObjectiveExtension</a>[] = <span class="stringliteral">"Objective"</span>;
<a name="l02550"></a>02550 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#31c783db2f49c971d9e5fd04b2f44afd">ModelVisitor::kSearchLimitExtension</a>[] = <span class="stringliteral">"SearchLimit"</span>;
<a name="l02551"></a>02551 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#bcbd28e3c23fb65eb82e94736969fb22">ModelVisitor::kUsageEqualVariableExtension</a>[] = <span class="stringliteral">"UsageEqualVariable"</span>;
<a name="l02552"></a>02552 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#a76042caf36172237c8f504a6498844c">ModelVisitor::kUsageLessConstantExtension</a>[] = <span class="stringliteral">"UsageLessConstant"</span>;
<a name="l02553"></a>02553 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#9b7bd80d7e781b8217abbaa9b983ba76">ModelVisitor::kVariableGroupExtension</a>[] = <span class="stringliteral">"VariableGroup"</span>;
<a name="l02554"></a>02554 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#207090253b5462feb778f1e2296225d3">ModelVisitor::kVariableUsageLessConstantExtension</a>[] =
<a name="l02555"></a>02555     <span class="stringliteral">"VariableUsageLessConstant"</span>;
<a name="l02556"></a>02556 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#e3e0223c51780ba07af39b5664c60f08">ModelVisitor::kWeightedSumOfAssignedEqualVariableExtension</a>[] =
<a name="l02557"></a>02557     <span class="stringliteral">"WeightedSumOfAssignedEqualVariable"</span>;
<a name="l02558"></a>02558 
<a name="l02559"></a>02559 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#4c53308d038be7910b43e68319342888" title="argument names:">ModelVisitor::kActiveArgument</a>[] = <span class="stringliteral">"active"</span>;
<a name="l02560"></a>02560 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#246551c143afeca38e54ee391221f794">ModelVisitor::kAssumePathsArgument</a>[] = <span class="stringliteral">"assume_paths"</span>;
<a name="l02561"></a>02561 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#bb5b0c6b461e53b5e469dec368524afa">ModelVisitor::kBranchesLimitArgument</a>[] = <span class="stringliteral">"branches_limit"</span>;
<a name="l02562"></a>02562 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#8a28f6a283b36f33e5c2dbf78fd469d1">ModelVisitor::kCapacityArgument</a>[] = <span class="stringliteral">"capacity"</span>;
<a name="l02563"></a>02563 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#f28bc6ea6c93475b07de4dba3bebe82c">ModelVisitor::kCardsArgument</a>[] = <span class="stringliteral">"cardinalities"</span>;
<a name="l02564"></a>02564 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#60faa007b3ec2b3498e87a85f8bb7dcd">ModelVisitor::kCoefficientsArgument</a>[] = <span class="stringliteral">"coefficients"</span>;
<a name="l02565"></a>02565 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#d7d22759d6e79c236d2048b98c6ed68d">ModelVisitor::kCountArgument</a>[] = <span class="stringliteral">"count"</span>;
<a name="l02566"></a>02566 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#aec7de2b7686703a04a4d4f7685a1a63">ModelVisitor::kCumulativeArgument</a>[] = <span class="stringliteral">"cumulative"</span>;
<a name="l02567"></a>02567 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#025dc5d4e2e6dc292e2a560267d35155">ModelVisitor::kCumulsArgument</a>[] = <span class="stringliteral">"cumuls"</span>;
<a name="l02568"></a>02568 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#bff9361235ca0ca8bbc14a794063912c">ModelVisitor::kDemandsArgument</a>[] = <span class="stringliteral">"demands"</span>;
<a name="l02569"></a>02569 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#520c279d7b58467967214b4cb21d2461">ModelVisitor::kDurationMinArgument</a>[] = <span class="stringliteral">"duration_min"</span>;
<a name="l02570"></a>02570 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#3661aa4d73fd410ddaf99d6b458bd259">ModelVisitor::kDurationMaxArgument</a>[] = <span class="stringliteral">"duration_max"</span>;
<a name="l02571"></a>02571 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#444e1ca24ca8beec7e4a3ce5dd15af2d">ModelVisitor::kEarlyCostArgument</a>[] = <span class="stringliteral">"early_cost"</span>;
<a name="l02572"></a>02572 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#87503235aa0fb7144f57d631b9231bb1">ModelVisitor::kEarlyDateArgument</a>[] = <span class="stringliteral">"early_date"</span>;
<a name="l02573"></a>02573 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#5e0edf9658d3039a51091660153d979a">ModelVisitor::kEndMinArgument</a>[] = <span class="stringliteral">"end_min"</span>;
<a name="l02574"></a>02574 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#98e416c6c7ff5aa71a24996a4b3c087e">ModelVisitor::kEndMaxArgument</a>[] = <span class="stringliteral">"end_max"</span>;
<a name="l02575"></a>02575 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#61afd1001ead67043c4e0f085189eaea">ModelVisitor::kExpressionArgument</a>[] = <span class="stringliteral">"expression"</span>;
<a name="l02576"></a>02576 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#41e6a88c68dab9ef9b464e2e7449b0af">ModelVisitor::kFailuresLimitArgument</a>[] = <span class="stringliteral">"failures_limit"</span>;
<a name="l02577"></a>02577 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#3b254aa01a5c2a2d06c899ca76bd7297">ModelVisitor::kFinalStatesArgument</a>[] = <span class="stringliteral">"final_states"</span>;
<a name="l02578"></a>02578 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#3564bba1b8dab3ae42e46b5ff47e2f30">ModelVisitor::kFixedChargeArgument</a>[] = <span class="stringliteral">"fixed_charge"</span>;
<a name="l02579"></a>02579 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#bb758de7b8748842781922b4283ce95f">ModelVisitor::kIndex2Argument</a>[] = <span class="stringliteral">"index2"</span>;
<a name="l02580"></a>02580 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#a1e297c6fb5caf00d9232b13b1802882">ModelVisitor::kIndexArgument</a>[] = <span class="stringliteral">"index"</span>;
<a name="l02581"></a>02581 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#2ce107313ce7196e785f2959020b74f2">ModelVisitor::kInitialState</a>[] = <span class="stringliteral">"initial_state"</span>;
<a name="l02582"></a>02582 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#b0c83054666cc242b5069d6a6a433b68">ModelVisitor::kIntervalArgument</a>[] = <span class="stringliteral">"interval"</span>;
<a name="l02583"></a>02583 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#ff5a82a9b1a253d046302f2616a9383c">ModelVisitor::kIntervalsArgument</a>[] = <span class="stringliteral">"intervals"</span>;
<a name="l02584"></a>02584 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#5b9dea6c0cc2a0ca1b79430a9b3a211a">ModelVisitor::kLateCostArgument</a>[] = <span class="stringliteral">"late_cost"</span>;
<a name="l02585"></a>02585 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#83205c64f88e9941d8767cc459e6c5ce">ModelVisitor::kLateDateArgument</a>[] = <span class="stringliteral">"late_date"</span>;
<a name="l02586"></a>02586 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#cd0feb9d9d925a318c3fa123784d52a0">ModelVisitor::kLeftArgument</a>[] = <span class="stringliteral">"left"</span>;
<a name="l02587"></a>02587 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#7213cf091575f0010732d47135e778e4">ModelVisitor::kMaxArgument</a>[] = <span class="stringliteral">"max_value"</span>;
<a name="l02588"></a>02588 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#a83a5b44afcd8f9ad11414355ea5869a">ModelVisitor::kMaximizeArgument</a>[] = <span class="stringliteral">"maximize"</span>;
<a name="l02589"></a>02589 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#5e5f836d61d9769129cc130e0b9093d5">ModelVisitor::kMinArgument</a>[] = <span class="stringliteral">"min_value"</span>;
<a name="l02590"></a>02590 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#52b7b98ec0bb4a98031aa25b69205d74">ModelVisitor::kNextsArgument</a>[] = <span class="stringliteral">"nexts"</span>;
<a name="l02591"></a>02591 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#d67dcce0ab471e17b90a4809891a6b10">ModelVisitor::kOptionalArgument</a>[] = <span class="stringliteral">"optional"</span>;
<a name="l02592"></a>02592 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#5860a3bea485a559d264b9981fff957b">ModelVisitor::kRangeArgument</a>[] = <span class="stringliteral">"range"</span>;
<a name="l02593"></a>02593 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#6c47313b9ec17de71b7890ce2b1428b8">ModelVisitor::kRelationArgument</a>[] = <span class="stringliteral">"relation"</span>;
<a name="l02594"></a>02594 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#852120192da92a3ca6fbbcb09bcb8b7e">ModelVisitor::kRightArgument</a>[] = <span class="stringliteral">"right"</span>;
<a name="l02595"></a>02595 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#2400305da392fec27dd268dd01ae5e76">ModelVisitor::kSequenceArgument</a>[] = <span class="stringliteral">"sequence"</span>;
<a name="l02596"></a>02596 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#96f367518be03a50369fbe0681d68bdf">ModelVisitor::kSequencesArgument</a>[] = <span class="stringliteral">"sequences"</span>;
<a name="l02597"></a>02597 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#f2556fbcf3669f7167b56e7a8c96ee5b">ModelVisitor::kSmartTimeCheckArgument</a>[] = <span class="stringliteral">"smart_time_check"</span>;
<a name="l02598"></a>02598 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#6e4650bdd2c49b50c446668331a95f7c">ModelVisitor::kSizeArgument</a>[] = <span class="stringliteral">"size"</span>;
<a name="l02599"></a>02599 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#12716d6c10e1b670cd9ee24eb839c9af">ModelVisitor::kSolutionLimitArgument</a>[] = <span class="stringliteral">"solutions_limit"</span>;
<a name="l02600"></a>02600 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#d4f65ed60edb2e405c9662d11c2558e1">ModelVisitor::kStartMinArgument</a>[] = <span class="stringliteral">"start_min"</span>;
<a name="l02601"></a>02601 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#0375054ffd52562c496a1404f505cdea">ModelVisitor::kStartMaxArgument</a>[] = <span class="stringliteral">"start_max"</span>;
<a name="l02602"></a>02602 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#0bc61bbf510f981d1b6f64fb383ae24c">ModelVisitor::kStepArgument</a>[] = <span class="stringliteral">"step"</span>;
<a name="l02603"></a>02603 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#64578e607ee4cd1e14208a78f5a7fb36">ModelVisitor::kTargetArgument</a>[] = <span class="stringliteral">"target_variable"</span>;
<a name="l02604"></a>02604 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#f90ec67001f655db6fc643c8746b38b6">ModelVisitor::kTimeLimitArgument</a>[] = <span class="stringliteral">"time_limit"</span>;
<a name="l02605"></a>02605 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#759d8a7331e1924cddfb493b3b585fff">ModelVisitor::kTransitsArgument</a>[] = <span class="stringliteral">"transits"</span>;
<a name="l02606"></a>02606 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#419f3b98090d93d516a8b91014e92e84">ModelVisitor::kTuplesArgument</a>[] = <span class="stringliteral">"tuples"</span>;
<a name="l02607"></a>02607 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#7d375108c569631374e3248701fa1c4e">ModelVisitor::kValueArgument</a>[] = <span class="stringliteral">"value"</span>;
<a name="l02608"></a>02608 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#9e63103e84b2e61255935c1dd2d48130">ModelVisitor::kValuesArgument</a>[] = <span class="stringliteral">"values"</span>;
<a name="l02609"></a>02609 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#b2d79708656faa6ca3381c630a5eeff7">ModelVisitor::kVarsArgument</a>[] = <span class="stringliteral">"variables"</span>;
<a name="l02610"></a>02610 
<a name="l02611"></a>02611 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#424ecb795cdbf034e7df929f850e4c4b" title="Operations.">ModelVisitor::kMirrorOperation</a>[] = <span class="stringliteral">"mirror"</span>;
<a name="l02612"></a>02612 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#a54ab84e6f6e700d1a9dee049a9e5ddf">ModelVisitor::kRelaxedMaxOperation</a>[] = <span class="stringliteral">"relaxed_max"</span>;
<a name="l02613"></a>02613 <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#326f130b7811c91a37198e63fd580ecc">ModelVisitor::kRelaxedMinOperation</a>[] = <span class="stringliteral">"relaxed_min"</span>;
<a name="l02614"></a>02614 
<a name="l02615"></a>02615 <span class="comment">// Methods</span>
<a name="l02616"></a>02616 
<a name="l02617"></a>02617 <a class="code" href="classoperations__research_1_1ModelVisitor.html#2ce0e07fea8345b36a2b8bb0b18a0366" title="Methods.">ModelVisitor::~ModelVisitor</a>() {}
<a name="l02618"></a>02618 
<a name="l02619"></a>02619 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#effe687b21079d1d50b407ebb43d9c02" title="Virtual methods for visitors.">ModelVisitor::BeginVisitModel</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; type_name) {}
<a name="l02620"></a>02620 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#2675aad9af880079211e264d04a23d48">ModelVisitor::EndVisitModel</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; type_name) {}
<a name="l02621"></a>02621 
<a name="l02622"></a>02622 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#2ee7b13da9c480a6dc87b12e1915b84c">ModelVisitor::BeginVisitConstraint</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; type_name,
<a name="l02623"></a>02623                                         <span class="keyword">const</span> Constraint* <span class="keyword">const</span> constraint) {}
<a name="l02624"></a>02624 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#59a147d5cabdf4a7d8ac032552e544df">ModelVisitor::EndVisitConstraint</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; type_name,
<a name="l02625"></a>02625                                       <span class="keyword">const</span> Constraint* <span class="keyword">const</span> constraint) {}
<a name="l02626"></a><a class="code" href="classoperations__research_1_1ModelVisitor.html#2ce0e07fea8345b36a2b8bb0b18a0366">02626</a> 
<a name="l02627"></a>02627 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#fcc7401ed9bf51e99225f02d0b03f214">ModelVisitor::BeginVisitExtension</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; type) {
<a name="l02628"></a><a class="code" href="classoperations__research_1_1ModelVisitor.html#effe687b21079d1d50b407ebb43d9c02">02628</a> }
<a name="l02629"></a><a class="code" href="classoperations__research_1_1ModelVisitor.html#2675aad9af880079211e264d04a23d48">02629</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#426dbfd4590f57a63ab12cde22c101fc">ModelVisitor::EndVisitExtension</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; type) {}
<a name="l02630"></a>02630 
<a name="l02631"></a><a class="code" href="classoperations__research_1_1ModelVisitor.html#2ee7b13da9c480a6dc87b12e1915b84c">02631</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#34fb5875ef83539724a754727ae32416">ModelVisitor::BeginVisitIntegerExpression</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; type_name,
<a name="l02632"></a>02632                                                <span class="keyword">const</span> <a class="code" href="classoperations__research_1_1IntExpr.html" title="The class IntExpr is the base of all integer expressions in constraint programming...">IntExpr</a>* <span class="keyword">const</span> expr) {}
<a name="l02633"></a><a class="code" href="classoperations__research_1_1ModelVisitor.html#59a147d5cabdf4a7d8ac032552e544df">02633</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#34fce60f6a3e2d0dac622ae6aed65078">ModelVisitor::EndVisitIntegerExpression</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; type_name,
<a name="l02634"></a>02634                                              <span class="keyword">const</span> <a class="code" href="classoperations__research_1_1IntExpr.html" title="The class IntExpr is the base of all integer expressions in constraint programming...">IntExpr</a>* <span class="keyword">const</span> expr) {}
<a name="l02635"></a>02635 
<a name="l02636"></a><a class="code" href="classoperations__research_1_1ModelVisitor.html#fcc7401ed9bf51e99225f02d0b03f214">02636</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#0fbf828553c55a9d78a1d4862258cfc8">ModelVisitor::VisitIntegerVariable</a>(<span class="keyword">const</span> <a class="code" href="classoperations__research_1_1IntVar.html" title="The class IntVar is a subset of IntExpr.">IntVar</a>* <span class="keyword">const</span> variable,
<a name="l02637"></a>02637                                         <span class="keyword">const</span> <a class="code" href="classoperations__research_1_1IntExpr.html" title="The class IntExpr is the base of all integer expressions in constraint programming...">IntExpr</a>* <span class="keyword">const</span> delegate) {
<a name="l02638"></a><a class="code" href="classoperations__research_1_1ModelVisitor.html#426dbfd4590f57a63ab12cde22c101fc">02638</a>   <span class="keywordflow">if</span> (delegate != NULL) {
<a name="l02639"></a>02639     delegate-&gt;<a class="code" href="classoperations__research_1_1IntExpr.html#3a82999dc986a540904daf053ddb9269" title="Accepts the given visitor.">Accept</a>(<span class="keyword">this</span>);
<a name="l02640"></a><a class="code" href="classoperations__research_1_1ModelVisitor.html#34fb5875ef83539724a754727ae32416">02640</a>   }
<a name="l02641"></a>02641 }
<a name="l02642"></a><a class="code" href="classoperations__research_1_1ModelVisitor.html#34fce60f6a3e2d0dac622ae6aed65078">02642</a> 
<a name="l02643"></a>02643 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#9f592fb3abba5acfe71504a0d98af34e">ModelVisitor::VisitIntervalVariable</a>(<span class="keyword">const</span> <a class="code" href="classoperations__research_1_1IntervalVar.html" title="Interval Var.">IntervalVar</a>* <span class="keyword">const</span> variable,
<a name="l02644"></a>02644                                          <span class="keyword">const</span> <span class="keywordtype">string</span> operation,
<a name="l02645"></a><a class="code" href="classoperations__research_1_1ModelVisitor.html#0fbf828553c55a9d78a1d4862258cfc8">02645</a>                                          <span class="keyword">const</span> <a class="code" href="classoperations__research_1_1IntervalVar.html" title="Interval Var.">IntervalVar</a>* <span class="keyword">const</span> delegate) {
<a name="l02646"></a>02646   <span class="keywordflow">if</span> (delegate != NULL) {
<a name="l02647"></a>02647     delegate-&gt;<a class="code" href="classoperations__research_1_1IntervalVar.html#4a625f0d15b94c92546d05bee7c8b554" title="Accepts the given visitor.">Accept</a>(<span class="keyword">this</span>);
<a name="l02648"></a>02648   }
<a name="l02649"></a>02649 }
<a name="l02650"></a>02650 
<a name="l02651"></a>02651 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#9f592fb3abba5acfe71504a0d98af34e">ModelVisitor::VisitIntervalVariable</a>(<span class="keyword">const</span> <a class="code" href="classoperations__research_1_1IntervalVar.html" title="Interval Var.">IntervalVar</a>* <span class="keyword">const</span> variable,
<a name="l02652"></a><a class="code" href="classoperations__research_1_1ModelVisitor.html#9f592fb3abba5acfe71504a0d98af34e">02652</a>                                          <span class="keyword">const</span> <span class="keywordtype">string</span> operation,
<a name="l02653"></a>02653                                          <span class="keyword">const</span> <a class="code" href="classoperations__research_1_1IntervalVar.html" title="Interval Var.">IntervalVar</a>* <span class="keyword">const</span> * delegates,
<a name="l02654"></a>02654                                          <span class="keywordtype">int</span> size) {
<a name="l02655"></a>02655   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; size; ++i) {
<a name="l02656"></a>02656     delegates[i]-&gt;<a class="code" href="classoperations__research_1_1IntervalVar.html#4a625f0d15b94c92546d05bee7c8b554" title="Accepts the given visitor.">Accept</a>(<span class="keyword">this</span>);
<a name="l02657"></a>02657   }
<a name="l02658"></a>02658 }
<a name="l02659"></a>02659 
<a name="l02660"></a><a class="code" href="classoperations__research_1_1ModelVisitor.html#15d5020f7c3dcd4924603989d638c294">02660</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#9ffd84a47b9d4705e7db2d62dc2e0676">ModelVisitor::VisitSequenceVariable</a>(<span class="keyword">const</span> <a class="code" href="classoperations__research_1_1SequenceVar.html" title="SequenceVar.">SequenceVar</a>* <span class="keyword">const</span> variable) {
<a name="l02661"></a>02661   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; variable-&gt;<a class="code" href="classoperations__research_1_1SequenceVar.html#377be35bc09d3725de4c7515ea60e55e" title="Returns the number of interval vars in the sequence.">size</a>(); ++i) {
<a name="l02662"></a>02662     variable-&gt;<a class="code" href="classoperations__research_1_1SequenceVar.html#17f7db24d131c87dbe7f76b23480adfc" title="Returns the index_th interval of the sequence.">Interval</a>(i)-&gt;<a class="code" href="classoperations__research_1_1IntervalVar.html#4a625f0d15b94c92546d05bee7c8b554" title="Accepts the given visitor.">Accept</a>(<span class="keyword">this</span>);
<a name="l02663"></a>02663   }
<a name="l02664"></a>02664 }
<a name="l02665"></a>02665 
<a name="l02666"></a>02666 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#0da215ee18e654bbc21952227ac2fe86" title="Visit integer arguments.">ModelVisitor::VisitIntegerArgument</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; arg_name, int64 <a class="code" href="search_8cc.html#21edc7ca4cc5802c8779d68556bc09cf">value</a>) {}
<a name="l02667"></a>02667 
<a name="l02668"></a>02668 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#773af5f276229883afb22a5ce65e719e">ModelVisitor::VisitIntegerArrayArgument</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; arg_name,
<a name="l02669"></a><a class="code" href="classoperations__research_1_1ModelVisitor.html#9ffd84a47b9d4705e7db2d62dc2e0676">02669</a>                                              <span class="keyword">const</span> int64* <span class="keyword">const</span> values,
<a name="l02670"></a>02670                                              <span class="keywordtype">int</span> size) {}
<a name="l02671"></a>02671 
<a name="l02672"></a>02672 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#77456b79a2f0619d22345d2413c254fa">ModelVisitor::VisitIntegerMatrixArgument</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; arg_name,
<a name="l02673"></a>02673                                               <span class="keyword">const</span> int64* <span class="keyword">const</span> * <span class="keyword">const</span> values,
<a name="l02674"></a>02674                                               <span class="keywordtype">int</span> rows,
<a name="l02675"></a><a class="code" href="classoperations__research_1_1ModelVisitor.html#0da215ee18e654bbc21952227ac2fe86">02675</a>                                               <span class="keywordtype">int</span> columns) {}
<a name="l02676"></a>02676 
<a name="l02677"></a><a class="code" href="classoperations__research_1_1ModelVisitor.html#773af5f276229883afb22a5ce65e719e">02677</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#013cebeb820b3428b4ac076f65f0efd8" title="Visit integer expression argument.">ModelVisitor::VisitIntegerExpressionArgument</a>(
<a name="l02678"></a>02678     <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; arg_name,
<a name="l02679"></a>02679     <span class="keyword">const</span> <a class="code" href="classoperations__research_1_1IntExpr.html" title="The class IntExpr is the base of all integer expressions in constraint programming...">IntExpr</a>* <span class="keyword">const</span> argument) {
<a name="l02680"></a>02680   argument-&gt;<a class="code" href="classoperations__research_1_1IntExpr.html#3a82999dc986a540904daf053ddb9269" title="Accepts the given visitor.">Accept</a>(<span class="keyword">this</span>);
<a name="l02681"></a><a class="code" href="classoperations__research_1_1ModelVisitor.html#77456b79a2f0619d22345d2413c254fa">02681</a> }
<a name="l02682"></a>02682 
<a name="l02683"></a>02683 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#85a2a6a7d07b014f8f249ead5ff14e55">ModelVisitor::VisitIntegerVariableArrayArgument</a>(
<a name="l02684"></a>02684     <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; arg_name,
<a name="l02685"></a>02685     <span class="keyword">const</span> <a class="code" href="classoperations__research_1_1IntVar.html" title="The class IntVar is a subset of IntExpr.">IntVar</a>* <span class="keyword">const</span> * arguments,
<a name="l02686"></a><a class="code" href="classoperations__research_1_1ModelVisitor.html#013cebeb820b3428b4ac076f65f0efd8">02686</a>     <span class="keywordtype">int</span> size) {
<a name="l02687"></a>02687   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; size; ++i) {
<a name="l02688"></a>02688     arguments[i]-&gt;<a class="code" href="classoperations__research_1_1IntVar.html#13a1f9a3f350e785eecc80ad9f1ece65" title="Accepts the given visitor.">Accept</a>(<span class="keyword">this</span>);
<a name="l02689"></a>02689   }
<a name="l02690"></a>02690 }
<a name="l02691"></a>02691 
<a name="l02692"></a><a class="code" href="classoperations__research_1_1ModelVisitor.html#85a2a6a7d07b014f8f249ead5ff14e55">02692</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#32db054f59851fddaa05cdba6a8d51ce" title="Visit interval argument.">ModelVisitor::VisitIntervalArgument</a>(
<a name="l02693"></a>02693     <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; arg_name,
<a name="l02694"></a>02694     <span class="keyword">const</span> <a class="code" href="classoperations__research_1_1IntervalVar.html" title="Interval Var.">IntervalVar</a>* <span class="keyword">const</span> argument) {
<a name="l02695"></a>02695   argument-&gt;<a class="code" href="classoperations__research_1_1IntervalVar.html#4a625f0d15b94c92546d05bee7c8b554" title="Accepts the given visitor.">Accept</a>(<span class="keyword">this</span>);
<a name="l02696"></a>02696 }
<a name="l02697"></a>02697 
<a name="l02698"></a>02698 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#ac69138e5f9a14f83c2058fb008d0efe">ModelVisitor::VisitIntervalArrayArgument</a>(
<a name="l02699"></a>02699     <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; arg_name,
<a name="l02700"></a>02700     <span class="keyword">const</span> <a class="code" href="classoperations__research_1_1IntervalVar.html" title="Interval Var.">IntervalVar</a>* <span class="keyword">const</span> * arguments,
<a name="l02701"></a><a class="code" href="classoperations__research_1_1ModelVisitor.html#32db054f59851fddaa05cdba6a8d51ce">02701</a>     <span class="keywordtype">int</span> size) {
<a name="l02702"></a>02702   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; size; ++i) {
<a name="l02703"></a>02703     arguments[i]-&gt;<a class="code" href="classoperations__research_1_1IntervalVar.html#4a625f0d15b94c92546d05bee7c8b554" title="Accepts the given visitor.">Accept</a>(<span class="keyword">this</span>);
<a name="l02704"></a>02704   }
<a name="l02705"></a>02705 }
<a name="l02706"></a>02706 
<a name="l02707"></a><a class="code" href="classoperations__research_1_1ModelVisitor.html#ac69138e5f9a14f83c2058fb008d0efe">02707</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#c8aaad5d68760ee6b4fc33d14a325c11" title="Visit sequence argument.">ModelVisitor::VisitSequenceArgument</a>(
<a name="l02708"></a>02708     <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; arg_name,
<a name="l02709"></a>02709     <span class="keyword">const</span> <a class="code" href="classoperations__research_1_1SequenceVar.html" title="SequenceVar.">SequenceVar</a>* <span class="keyword">const</span> argument) {
<a name="l02710"></a>02710   argument-&gt;<a class="code" href="classoperations__research_1_1SequenceVar.html#fe2bed7193798e1b25410709c3a01723" title="Accepts the given visitor.">Accept</a>(<span class="keyword">this</span>);
<a name="l02711"></a>02711 }
<a name="l02712"></a>02712 
<a name="l02713"></a>02713 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#e887cbd16425ea5d3fa94ae00a8419ed">ModelVisitor::VisitSequenceArrayArgument</a>(
<a name="l02714"></a>02714     <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; arg_name,
<a name="l02715"></a>02715     <span class="keyword">const</span> <a class="code" href="classoperations__research_1_1SequenceVar.html" title="SequenceVar.">SequenceVar</a>* <span class="keyword">const</span> * arguments,
<a name="l02716"></a><a class="code" href="classoperations__research_1_1ModelVisitor.html#c8aaad5d68760ee6b4fc33d14a325c11">02716</a>     <span class="keywordtype">int</span> size) {
<a name="l02717"></a>02717   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; size; ++i) {
<a name="l02718"></a>02718     arguments[i]-&gt;<a class="code" href="classoperations__research_1_1SequenceVar.html#fe2bed7193798e1b25410709c3a01723" title="Accepts the given visitor.">Accept</a>(<span class="keyword">this</span>);
<a name="l02719"></a>02719   }
<a name="l02720"></a>02720 }
<a name="l02721"></a>02721 
<a name="l02722"></a><a class="code" href="classoperations__research_1_1ModelVisitor.html#e887cbd16425ea5d3fa94ae00a8419ed">02722</a> <span class="comment">// ----- Helpers -----</span>
<a name="l02723"></a>02723 
<a name="l02724"></a>02724 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#719a2da5db2552a65efa489b095069bf" title="Helpers.">ModelVisitor::VisitConstIntArrayArgument</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; arg_name,
<a name="l02725"></a>02725                                               <span class="keyword">const</span> ConstIntArray&amp;  values) {
<a name="l02726"></a>02726   <a class="code" href="classoperations__research_1_1ModelVisitor.html#773af5f276229883afb22a5ce65e719e">VisitIntegerArrayArgument</a>(arg_name, values.RawData(), values.size());
<a name="l02727"></a>02727 }
<a name="l02728"></a>02728 
<a name="l02729"></a>02729 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#90a8322dced3cbb7d3f665e2ff7d1c76">ModelVisitor::VisitInt64ToBoolExtension</a>(
<a name="l02730"></a>02730     ResultCallback1&lt;bool, int64&gt;* <span class="keyword">const</span> callback,
<a name="l02731"></a>02731     int64 index_min,
<a name="l02732"></a>02732     int64 index_max) {
<a name="l02733"></a><a class="code" href="classoperations__research_1_1ModelVisitor.html#719a2da5db2552a65efa489b095069bf">02733</a>   <span class="keywordflow">if</span> (callback == NULL) {
<a name="l02734"></a>02734     <span class="keywordflow">return</span>;
<a name="l02735"></a>02735   }
<a name="l02736"></a>02736   std::vector&lt;int64&gt; cached_results;
<a name="l02737"></a>02737   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = index_min; i &lt;= index_max; ++i) {
<a name="l02738"></a><a class="code" href="classoperations__research_1_1ModelVisitor.html#90a8322dced3cbb7d3f665e2ff7d1c76">02738</a>     cached_results.push_back(callback-&gt;Run(i));
<a name="l02739"></a>02739   }
<a name="l02740"></a>02740   <span class="comment">// TODO(user): VisitBoolArrayArgument?</span>
<a name="l02741"></a>02741   <a class="code" href="classoperations__research_1_1ModelVisitor.html#fcc7401ed9bf51e99225f02d0b03f214">BeginVisitExtension</a>(<a class="code" href="classoperations__research_1_1ModelVisitor.html#e4e71fbb68d896433470427eb34bba49">kInt64ToBoolExtension</a>);
<a name="l02742"></a>02742   <a class="code" href="classoperations__research_1_1ModelVisitor.html#0da215ee18e654bbc21952227ac2fe86" title="Visit integer arguments.">VisitIntegerArgument</a>(<a class="code" href="classoperations__research_1_1ModelVisitor.html#5e5f836d61d9769129cc130e0b9093d5">kMinArgument</a>, index_min);
<a name="l02743"></a>02743   <a class="code" href="classoperations__research_1_1ModelVisitor.html#0da215ee18e654bbc21952227ac2fe86" title="Visit integer arguments.">VisitIntegerArgument</a>(<a class="code" href="classoperations__research_1_1ModelVisitor.html#7213cf091575f0010732d47135e778e4">kMaxArgument</a>, index_max);
<a name="l02744"></a>02744   <a class="code" href="classoperations__research_1_1ModelVisitor.html#773af5f276229883afb22a5ce65e719e">VisitIntegerArrayArgument</a>(<a class="code" href="classoperations__research_1_1ModelVisitor.html#9e63103e84b2e61255935c1dd2d48130">kValuesArgument</a>,
<a name="l02745"></a>02745                             cached_results.data(),
<a name="l02746"></a>02746                             cached_results.size());
<a name="l02747"></a>02747   <a class="code" href="classoperations__research_1_1ModelVisitor.html#426dbfd4590f57a63ab12cde22c101fc">EndVisitExtension</a>(<a class="code" href="classoperations__research_1_1ModelVisitor.html#e4e71fbb68d896433470427eb34bba49">kInt64ToBoolExtension</a>);
<a name="l02748"></a>02748 }
<a name="l02749"></a>02749 
<a name="l02750"></a>02750 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#d7d97c154192477ed5cb89662af6a864">ModelVisitor::VisitInt64ToInt64Extension</a>(
<a name="l02751"></a>02751     <a class="code" href="classoperations__research_1_1Solver.html#fcf373cf1c769a34b1b89a5ba56fb473" title="Callback typedefs.">Solver::IndexEvaluator1</a>* <span class="keyword">const</span> callback,
<a name="l02752"></a>02752     int64 index_min,
<a name="l02753"></a>02753     int64 index_max) {
<a name="l02754"></a>02754   <span class="keywordflow">if</span> (callback == NULL) {
<a name="l02755"></a>02755     <span class="keywordflow">return</span>;
<a name="l02756"></a>02756   }
<a name="l02757"></a>02757   std::vector&lt;int64&gt; cached_results;
<a name="l02758"></a>02758   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = index_min; i &lt;= index_max; ++i) {
<a name="l02759"></a><a class="code" href="classoperations__research_1_1ModelVisitor.html#d7d97c154192477ed5cb89662af6a864">02759</a>     cached_results.push_back(callback-&gt;Run(i));
<a name="l02760"></a>02760   }
<a name="l02761"></a>02761   <a class="code" href="classoperations__research_1_1ModelVisitor.html#fcc7401ed9bf51e99225f02d0b03f214">BeginVisitExtension</a>(<a class="code" href="classoperations__research_1_1ModelVisitor.html#46015e0c5630a4aea9c68c91efbe7e87">kInt64ToInt64Extension</a>);
<a name="l02762"></a>02762   <a class="code" href="classoperations__research_1_1ModelVisitor.html#0da215ee18e654bbc21952227ac2fe86" title="Visit integer arguments.">VisitIntegerArgument</a>(<a class="code" href="classoperations__research_1_1ModelVisitor.html#5e5f836d61d9769129cc130e0b9093d5">kMinArgument</a>, index_min);
<a name="l02763"></a>02763   <a class="code" href="classoperations__research_1_1ModelVisitor.html#0da215ee18e654bbc21952227ac2fe86" title="Visit integer arguments.">VisitIntegerArgument</a>(<a class="code" href="classoperations__research_1_1ModelVisitor.html#7213cf091575f0010732d47135e778e4">kMaxArgument</a>, index_max);
<a name="l02764"></a>02764   <a class="code" href="classoperations__research_1_1ModelVisitor.html#773af5f276229883afb22a5ce65e719e">VisitIntegerArrayArgument</a>(<a class="code" href="classoperations__research_1_1ModelVisitor.html#9e63103e84b2e61255935c1dd2d48130">kValuesArgument</a>,
<a name="l02765"></a>02765                             cached_results.data(),
<a name="l02766"></a>02766                             cached_results.size());
<a name="l02767"></a>02767   <a class="code" href="classoperations__research_1_1ModelVisitor.html#426dbfd4590f57a63ab12cde22c101fc">EndVisitExtension</a>(<a class="code" href="classoperations__research_1_1ModelVisitor.html#46015e0c5630a4aea9c68c91efbe7e87">kInt64ToInt64Extension</a>);
<a name="l02768"></a>02768 }
<a name="l02769"></a>02769 
<a name="l02770"></a>02770 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1ModelVisitor.html#95f1ebbd66ebfd9e6f2d8961486af6a3" title="Expands function as array when index min is 0.">ModelVisitor::VisitInt64ToInt64AsArray</a>(
<a name="l02771"></a>02771     <a class="code" href="classoperations__research_1_1Solver.html#fcf373cf1c769a34b1b89a5ba56fb473" title="Callback typedefs.">Solver::IndexEvaluator1</a>* <span class="keyword">const</span> callback,
<a name="l02772"></a>02772     <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; arg_name,
<a name="l02773"></a>02773     int64 index_max) {
<a name="l02774"></a>02774   <span class="keywordflow">if</span> (callback == NULL) {
<a name="l02775"></a>02775     <span class="keywordflow">return</span>;
<a name="l02776"></a>02776   }
<a name="l02777"></a>02777   std::vector&lt;int64&gt; cached_results;
<a name="l02778"></a>02778   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= index_max; ++i) {
<a name="l02779"></a><a class="code" href="classoperations__research_1_1ModelVisitor.html#95f1ebbd66ebfd9e6f2d8961486af6a3">02779</a>     cached_results.push_back(callback-&gt;Run(i));
<a name="l02780"></a>02780   }
<a name="l02781"></a>02781   <a class="code" href="classoperations__research_1_1ModelVisitor.html#773af5f276229883afb22a5ce65e719e">VisitIntegerArrayArgument</a>(arg_name,
<a name="l02782"></a>02782                             cached_results.data(),
<a name="l02783"></a>02783                             cached_results.size());
<a name="l02784"></a>02784 }
<a name="l02785"></a>02785 
<a name="l02786"></a>02786 <span class="comment">// ---------- Search Monitor ----------</span>
<a name="l02787"></a>02787 
<a name="l02788"></a>02788 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1SearchMonitor.html#eb9c7b1f2ebe7f24cf33cdf958bbdd14" title="Beginning of the search.">SearchMonitor::EnterSearch</a>() {}
<a name="l02789"></a>02789 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1SearchMonitor.html#1fed6f3ad3f1b44746297f19df0a85cf" title="Restart the search.">SearchMonitor::RestartSearch</a>() {}
<a name="l02790"></a>02790 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1SearchMonitor.html#9a0fa1566b29e82604731222ba27810e" title="End of the search.">SearchMonitor::ExitSearch</a>() {}
<a name="l02791"></a>02791 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1SearchMonitor.html#a36576cd72df52185b939bee5ee52a72" title="Before calling DecisionBuilder::Next.">SearchMonitor::BeginNextDecision</a>(DecisionBuilder* <span class="keyword">const</span> b) {}
<a name="l02792"></a>02792 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1SearchMonitor.html#5e4c3bd36278ce32d488227ec365ce6e" title="After calling DecisionBuilder::Next, along with the returned decision.">SearchMonitor::EndNextDecision</a>(DecisionBuilder* <span class="keyword">const</span> b,
<a name="l02793"></a>02793                                     Decision* <span class="keyword">const</span> d) {}
<a name="l02794"></a>02794 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1SearchMonitor.html#f2df1e3ba015e09eec6969862704ba6a" title="Before applying the decision.">SearchMonitor::ApplyDecision</a>(Decision* <span class="keyword">const</span> d) {}
<a name="l02795"></a>02795 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1SearchMonitor.html#d8ac928f96207b054a3fd82fba7cbf54" title="Before refuting the Decision.">SearchMonitor::RefuteDecision</a>(Decision* <span class="keyword">const</span> d) {}
<a name="l02796"></a>02796 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1SearchMonitor.html#ae0b2453238067c8f3ebe203a3f4940d" title="Just after refuting or applying the decision, apply is true after Apply.">SearchMonitor::AfterDecision</a>(Decision* <span class="keyword">const</span> d, <span class="keywordtype">bool</span> apply) {}
<a name="l02797"></a><a class="code" href="classoperations__research_1_1SearchMonitor.html#eb9c7b1f2ebe7f24cf33cdf958bbdd14">02797</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1SearchMonitor.html#cc4cc0b62205946e9c5606fac920198c" title="Just when the failure occurs.">SearchMonitor::BeginFail</a>() {}
<a name="l02798"></a><a class="code" href="classoperations__research_1_1SearchMonitor.html#1fed6f3ad3f1b44746297f19df0a85cf">02798</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1SearchMonitor.html#1ea992fcfd1bfa3dc3cb49e32af495fe" title="After completing the backtrack.">SearchMonitor::EndFail</a>() {}
<a name="l02799"></a><a class="code" href="classoperations__research_1_1SearchMonitor.html#9a0fa1566b29e82604731222ba27810e">02799</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1SearchMonitor.html#193e8f9e10fb216be18489b78fe880fe" title="Before the initial propagation.">SearchMonitor::BeginInitialPropagation</a>() {}
<a name="l02800"></a><a class="code" href="classoperations__research_1_1SearchMonitor.html#a36576cd72df52185b939bee5ee52a72">02800</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1SearchMonitor.html#2527278a6808ed107f11563ea53ca175" title="After the initial propagation.">SearchMonitor::EndInitialPropagation</a>() {}
<a name="l02801"></a><a class="code" href="classoperations__research_1_1SearchMonitor.html#5e4c3bd36278ce32d488227ec365ce6e">02801</a> <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1SearchMonitor.html#e78fd7a60e09bb2c08fa04ba8b35f87c" title="This method is called when a solution is found.">SearchMonitor::AcceptSolution</a>() { <span class="keywordflow">return</span> <span class="keyword">true</span>; }
<a name="l02802"></a>02802 <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1SearchMonitor.html#146c9540ccd639a9bbc6cefbb6756978" title="This method is called when a valid solution is found.">SearchMonitor::AtSolution</a>() { <span class="keywordflow">return</span> <span class="keyword">false</span>; }
<a name="l02803"></a><a class="code" href="classoperations__research_1_1SearchMonitor.html#f2df1e3ba015e09eec6969862704ba6a">02803</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1SearchMonitor.html#a7bb4e8f2ebab4cc34d5e6d7812664c1" title="When the search tree is finished.">SearchMonitor::NoMoreSolutions</a>() {}
<a name="l02804"></a><a class="code" href="classoperations__research_1_1SearchMonitor.html#d8ac928f96207b054a3fd82fba7cbf54">02804</a> <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1SearchMonitor.html#9bc1249bb77ce92f7f899a4adbc7a415" title="When a local optimum is reached.">SearchMonitor::LocalOptimum</a>() { <span class="keywordflow">return</span> <span class="keyword">false</span>; }
<a name="l02805"></a><a class="code" href="classoperations__research_1_1SearchMonitor.html#ae0b2453238067c8f3ebe203a3f4940d">02805</a> <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1SearchMonitor.html#329bbd7c909dbbf7fcffc5bd6b86ab9d">SearchMonitor::AcceptDelta</a>(<a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* delta,
<a name="l02806"></a><a class="code" href="classoperations__research_1_1SearchMonitor.html#cc4cc0b62205946e9c5606fac920198c">02806</a>                                 <a class="code" href="classoperations__research_1_1Assignment.html" title="Assignment.">Assignment</a>* deltadelta) { <span class="keywordflow">return</span> <span class="keyword">true</span>; }
<a name="l02807"></a><a class="code" href="classoperations__research_1_1SearchMonitor.html#1ea992fcfd1bfa3dc3cb49e32af495fe">02807</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1SearchMonitor.html#f3136c9db38e07f98e4180931a1e223f" title="After accepting a neighbor during local search.">SearchMonitor::AcceptNeighbor</a>() {}
<a name="l02808"></a><a class="code" href="classoperations__research_1_1SearchMonitor.html#193e8f9e10fb216be18489b78fe880fe">02808</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1SearchMonitor.html#46bba755961234b929a8dd2f440f1cfd" title="Tells the solver to kill the current search.">SearchMonitor::FinishCurrentSearch</a>() {
<a name="l02809"></a><a class="code" href="classoperations__research_1_1SearchMonitor.html#2527278a6808ed107f11563ea53ca175">02809</a>   <a class="code" href="classoperations__research_1_1SearchMonitor.html#b7032463a55bd7d196d1fefde47f0238">solver</a>()-&gt;<a class="code" href="classoperations__research_1_1Solver.html#6bcbc05024a15fd895048fbdc64a3764">searches_</a>.back()-&gt;set_should_finish(<span class="keyword">true</span>);
<a name="l02810"></a><a class="code" href="classoperations__research_1_1SearchMonitor.html#e78fd7a60e09bb2c08fa04ba8b35f87c">02810</a> }
<a name="l02811"></a><a class="code" href="classoperations__research_1_1SearchMonitor.html#146c9540ccd639a9bbc6cefbb6756978">02811</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1SearchMonitor.html#9ca3cc572200fdc9b57d1638565cb7ac" title="Tells the solver to restart the current search.">SearchMonitor::RestartCurrentSearch</a>() {
<a name="l02812"></a><a class="code" href="classoperations__research_1_1SearchMonitor.html#a7bb4e8f2ebab4cc34d5e6d7812664c1">02812</a>   <a class="code" href="classoperations__research_1_1SearchMonitor.html#b7032463a55bd7d196d1fefde47f0238">solver</a>()-&gt;<a class="code" href="classoperations__research_1_1Solver.html#6bcbc05024a15fd895048fbdc64a3764">searches_</a>.back()-&gt;set_should_restart(<span class="keyword">true</span>);
<a name="l02813"></a><a class="code" href="classoperations__research_1_1SearchMonitor.html#9bc1249bb77ce92f7f899a4adbc7a415">02813</a> }
<a name="l02814"></a><a class="code" href="classoperations__research_1_1SearchMonitor.html#329bbd7c909dbbf7fcffc5bd6b86ab9d">02814</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1SearchMonitor.html#a54fd83d1bcceecccd7d0a3106b6fc74" title="Periodic call to check limits in long running methods.">SearchMonitor::PeriodicCheck</a>() {}
<a name="l02815"></a>02815 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1SearchMonitor.html#029e116116d8e034bf2144d79738d6dd" title="Accepts the given model visitor.">SearchMonitor::Accept</a>(<a class="code" href="classoperations__research_1_1ModelVisitor.html" title="Model visitor.">ModelVisitor</a>* <span class="keyword">const</span> visitor)<span class="keyword"> const </span>{}
<a name="l02816"></a><a class="code" href="classoperations__research_1_1SearchMonitor.html#f3136c9db38e07f98e4180931a1e223f">02816</a> 
<a name="l02817"></a><a class="code" href="classoperations__research_1_1SearchMonitor.html#46bba755961234b929a8dd2f440f1cfd">02817</a> <span class="comment">// ----------------- Constraint class -------------------</span>
<a name="l02818"></a>02818 
<a name="l02819"></a>02819 <span class="keywordtype">string</span> <a class="code" href="classoperations__research_1_1Constraint.html#f870afb5d6c1fba1d70b38eb581f8cca" title="Constraint class.">Constraint::DebugString</a>()<span class="keyword"> const </span>{
<a name="l02820"></a><a class="code" href="classoperations__research_1_1SearchMonitor.html#9ca3cc572200fdc9b57d1638565cb7ac">02820</a>   <span class="keywordflow">return</span> <span class="stringliteral">"Constraint"</span>;
<a name="l02821"></a>02821 }
<a name="l02822"></a>02822 
<a name="l02823"></a><a class="code" href="classoperations__research_1_1SearchMonitor.html#a54fd83d1bcceecccd7d0a3106b6fc74">02823</a> <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Constraint.html#92c3bfe86238b5c95448d4a0384a327f" title="Calls Post and then Propagate to initialize the constraints.">Constraint::PostAndPropagate</a>() {
<a name="l02824"></a><a class="code" href="classoperations__research_1_1SearchMonitor.html#029e116116d8e034bf2144d79738d6dd">02824</a>   FreezeQueue();
<a name="l02825"></a>02825   Post();
<a name="l02826"></a>02826   InitialPropagate();
<a name="l02827"></a>02827   UnfreezeQueue();
<a name="l02828"></a><a class="code" href="classoperations__research_1_1Constraint.html#f870afb5d6c1fba1d70b38eb581f8cca">02828</a> }
<a name="l02829"></a>02829 
<a name="l02830"></a>02830 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1Constraint.html#816c36feb4ec4ffce6a8d3490029301c" title="Accepts the given visitor.">Constraint::Accept</a>(<a class="code" href="classoperations__research_1_1ModelVisitor.html" title="Model visitor.">ModelVisitor</a>* <span class="keyword">const</span> visitor)<span class="keyword"> const </span>{
<a name="l02831"></a>02831   visitor-&gt;<a class="code" href="classoperations__research_1_1ModelVisitor.html#2ee7b13da9c480a6dc87b12e1915b84c">BeginVisitConstraint</a>(<span class="stringliteral">"unknown"</span>, <span class="keyword">this</span>);
<a name="l02832"></a><a class="code" href="classoperations__research_1_1Constraint.html#92c3bfe86238b5c95448d4a0384a327f">02832</a>   visitor-&gt;<a class="code" href="classoperations__research_1_1ModelVisitor.html#59a147d5cabdf4a7d8ac032552e544df">EndVisitConstraint</a>(<span class="stringliteral">"unknown"</span>, <span class="keyword">this</span>);
<a name="l02833"></a>02833 }
<a name="l02834"></a>02834 
<a name="l02835"></a>02835 <span class="keywordtype">bool</span> <a class="code" href="classoperations__research_1_1Constraint.html#1fa4790ccae8a27c5f8a2535784e7850" title="Is the constraint created by a cast from expression to integer variable?">Constraint::IsDelegate</a>()<span class="keyword"> const </span>{
<a name="l02836"></a>02836   <span class="keywordflow">return</span> ContainsKey(<a class="code" href="classoperations__research_1_1PropagationBaseObject.html#2851ada2b74b1f107fb50d84043471dc">solver</a>()-&gt;delegate_constraints_, <span class="keyword">this</span>);
<a name="l02837"></a>02837 }
<a name="l02838"></a>02838 
<a name="l02839"></a><a class="code" href="classoperations__research_1_1Constraint.html#816c36feb4ec4ffce6a8d3490029301c">02839</a> <span class="comment">// ----- Class IntExpr -----</span>
<a name="l02840"></a>02840 
<a name="l02841"></a>02841 <span class="keywordtype">void</span> <a class="code" href="classoperations__research_1_1IntExpr.html#3a82999dc986a540904daf053ddb9269" title="Accepts the given visitor.">IntExpr::Accept</a>(<a class="code" href="classoperations__research_1_1ModelVisitor.html" title="Model visitor.">ModelVisitor</a>* <span class="keyword">const</span> visitor)<span class="keyword"> const </span>{
<a name="l02842"></a>02842   visitor-&gt;<a class="code" href="classoperations__research_1_1ModelVisitor.html#34fb5875ef83539724a754727ae32416">BeginVisitIntegerExpression</a>(<span class="stringliteral">"unknown"</span>, <span class="keyword">this</span>);
<a name="l02843"></a>02843   visitor-&gt;<a class="code" href="classoperations__research_1_1ModelVisitor.html#34fce60f6a3e2d0dac622ae6aed65078">EndVisitIntegerExpression</a>(<span class="stringliteral">"unknown"</span>, <span class="keyword">this</span>);
<a name="l02844"></a><a class="code" href="classoperations__research_1_1Constraint.html#1fa4790ccae8a27c5f8a2535784e7850">02844</a> }
<a name="l02845"></a>02845 
<a name="l02846"></a>02846 <span class="preprocessor">#undef CP_TRY  // We no longer need those.</span>
<a name="l02847"></a>02847 <span class="preprocessor"></span><span class="preprocessor">#undef CP_ON_FAIL</span>
<a name="l02848"></a>02848 <span class="preprocessor"></span><span class="preprocessor">#undef CP_DO_FAIL</span>
<a name="l02849"></a>02849 <span class="preprocessor"></span>
<a name="l02850"></a><a class="code" href="classoperations__research_1_1IntExpr.html#3a82999dc986a540904daf053ddb9269">02850</a> }  <span class="comment">// namespace operations_research</span>
</pre></div></div>

  <!-- Start of footer. -->
  <table width=100% cellpadding=0 cellspacing=0 border=0>
    <tr valign=top>
      <td colspan=2 height=10></td>
    </tr>
    <tr valign=top>
      <td colspan=2 bgcolor=#785251 height=3></td>
    </tr>
  </table>

  <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
  <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
  <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
  <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
  <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
  <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
  <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
  <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
  <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
  <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
  <br /><br />

  
  </body>
</html>
