%!PS-Adobe-3.0 EPSF-3.0
%%Creator: Thomas B. Preu\ss er
%%BoundingBox: 0 0 520 520
%%EndComments

realtime srand
gsave 10 dict begin
/p/index load def
/bs/bitshift load def
% Args: N
/qrnd{			% N
  [ -1 3 2 roll		% [ -1 N
  bs 0 0 2 p not	% [ BH BU BD SL
  {			% ... BH BU BD SL		% Loop
    dup 0 eq            % ... BH BU BD SL (SL==0)
    {                   % ... BH BU BD SL		% No more Placement
      pop pop pop	% ... BH
      -1 eq		% ... (BH == -1)
      {exit}if          % [ (BH BU BD SL PS)^N          % Done
      not and           % ... BH BU BD SL'              % Backtracking
    }{                  % ... BH BU BD SL		% Placement
      {1 rand 31 and bs 2 copy and 0 ne{exit}if pop}loop
		        % ... BH BU BD SL PS		% Random Placement
      dup 5 p or		% ... BH'	
      4 p 2 p or  1 bs	% ... BH' BU'
      4 p 3 p or -1 bs  % ... BH' BU' BD'
      3 copy or or not	% ... BH' BU' BD' SL'
    }ifelse
  }loop			% [ (BH BU BD SL PS)^N

  counttomark -5 5
  {                          % [ ... BH BU BD SL PS 5n
    0 3 2 roll               %   ... BH BU BD SL 5n 0 PS
    {				% CNT PS
      -1 bs dup 0 eq		% CNT PS' (PS' == 0)
      {exit}if			% CNT PS'
      exch 1 add exch
    }loop
    pop                      %  ... BH BU BD SL 5n CNT
    exch 1 roll pop pop pop pop
  }for
  ]
}bind def

% Args: N
/qfld{
    gsave
    currentpoint translate
    10 10 scale
    .02 setlinewidth

    0 1 2 p 1 sub	% N  0 1 (N-1)
    {             	% N i
      0 1 3 p 1 sub	% N i 0 1 (N-1)
      {                 % N i j
	  2 copy add 1 and 0 eq
	  { % N i j
	      2 copy 1 1 4 copy .85 setgray rectfill 0 setgray rectstroke
	  }if
	  pop
      }for% N i
      pop
    }for%N

    .15 setlinewidth
    0 setgray
    dup 0 0 3 2 roll dup rectstroke %N
    .75 setgray
    /Helvetica-Bold findfont 1 p 8 div scalefont setfont
    2 div dup moveto
    .25 setlinewidth
    (Queens@TUD)dup stringwidth pop -2 div 0 rmoveto dup
    gsave false charpath stroke grestore .1 setlinewidth .65 setgray false charpath stroke
    grestore
}bind def

% Args: [ Positions ]
/qput{
    gsave
    10 10 scale
    .1 setlinewidth

    0 1 2 p          % arr 0 1 arr
    length 1 sub     % arr 0 1 (N-1)
    {                % arr i
	2 copy get   % arr i y
	gsave
	0 setgray
	rmoveto .5 .5 rmoveto currentpoint 2 copy .42 0 360 arc fill moveto
	1 setgray .69 .73 scale
	0 .1 rmoveto currentpoint .2 -.2 rlineto .2 .2 rlineto -.2 -.4 rlineto -.4 0 rlineto -.2 .4 rlineto .2 -.2 rlineto closepath stroke
	.15 -45 225 arc fill
	grestore
    }for %arr
    pop
    grestore
}bind def

2 2 scale
0 0 moveto
26 dup qfld qrnd qput
end
showpage
